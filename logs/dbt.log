[0m11:01:45.418879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C903E7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C8A46900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C8A44530>]}


============================== 11:01:45.427879 | ae6032bf-d5ef-4612-b0ba-f861201fe7aa ==============================
[0m11:01:45.427879 [info ] [MainThread]: Running with dbt=1.9.6
[0m11:01:45.428881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:01:45.463146 [info ] [MainThread]: dbt version: 1.9.6
[0m11:01:45.464147 [info ] [MainThread]: python version: 3.12.10
[0m11:01:45.465145 [info ] [MainThread]: python path: C:\Users\KBHATIA\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\python.exe
[0m11:01:45.465145 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m11:01:45.576346 [info ] [MainThread]: Using profiles dir at C:\Users\KBHATIA\.dbt
[0m11:01:45.577349 [info ] [MainThread]: Using profiles.yml file at C:\Users\KBHATIA\.dbt\profiles.yml
[0m11:01:45.578345 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\KBHATIA\jaffle_shop\dbt_project.yml
[0m11:01:45.585347 [info ] [MainThread]: adapter type: duckdb
[0m11:01:45.586347 [info ] [MainThread]: adapter version: 1.9.3
[0m11:01:45.587348 [info ] [MainThread]: Configuration:
[0m11:01:45.588347 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:01:45.588347 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m11:01:45.589345 [info ] [MainThread]: Required dependencies:
[0m11:01:45.589345 [debug] [MainThread]: Executing "git --help"
[0m11:01:45.813239 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:01:45.814259 [debug] [MainThread]: STDERR: "b''"
[0m11:01:45.814259 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:01:45.815264 [info ] [MainThread]: Connection:
[0m11:01:45.815264 [info ] [MainThread]:   database: jaffle_shop
[0m11:01:45.816240 [info ] [MainThread]:   schema: main
[0m11:01:45.816240 [info ] [MainThread]:   path: jaffle_shop.duckdb
[0m11:01:45.817238 [info ] [MainThread]:   config_options: None
[0m11:01:45.817238 [info ] [MainThread]:   extensions: None
[0m11:01:45.818244 [info ] [MainThread]:   settings: {}
[0m11:01:45.818244 [info ] [MainThread]:   external_root: .
[0m11:01:45.819241 [info ] [MainThread]:   use_credential_provider: None
[0m11:01:45.820239 [info ] [MainThread]:   attach: None
[0m11:01:45.820239 [info ] [MainThread]:   filesystems: None
[0m11:01:45.821242 [info ] [MainThread]:   remote: None
[0m11:01:45.822241 [info ] [MainThread]:   plugins: None
[0m11:01:45.823242 [info ] [MainThread]:   disable_transactions: False
[0m11:01:45.824242 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m11:01:46.311849 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m11:01:46.576232 [debug] [MainThread]: Using duckdb connection "debug"
[0m11:01:46.576232 [debug] [MainThread]: On debug: select 1 as id
[0m11:01:46.577232 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:01:46.602227 [debug] [MainThread]: SQL status: OK in 0.025 seconds
[0m11:01:46.603228 [debug] [MainThread]: On debug: Close
[0m11:01:46.603228 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:01:46.604228 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:01:46.604228 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\KBHATIA\jaffle_shop\dbt_project.yml> not found

[0m11:01:46.606609 [debug] [MainThread]: Command `python -m dbt.cli.main debug` failed at 11:01:46.606609 after 1.34 seconds
[0m11:01:46.607619 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:01:46.607619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C5F30590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C9E4BF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C9E4BEC0>]}
[0m11:01:46.607619 [debug] [MainThread]: Flushing usage events
[0m11:01:47.617612 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:22:30.681737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001764BC4F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001764F24B8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001764F248D40>]}


============================== 12:22:30.687737 | c9c0ff9d-897b-4f1e-bc71-2abe734057c1 ==============================
[0m12:22:30.687737 [info ] [MainThread]: Running with dbt=1.9.6
[0m12:22:30.688732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:22:30.725772 [info ] [MainThread]: dbt version: 1.9.6
[0m12:22:30.725772 [info ] [MainThread]: python version: 3.12.10
[0m12:22:30.726767 [info ] [MainThread]: python path: C:\Users\KBHATIA\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\python.exe
[0m12:22:30.727823 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m12:22:30.842971 [info ] [MainThread]: Using profiles dir at C:\Users\KBHATIA\.dbt
[0m12:22:30.843949 [info ] [MainThread]: Using profiles.yml file at C:\Users\KBHATIA\.dbt\profiles.yml
[0m12:22:30.843949 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\KBHATIA\jaffle_shop\dbt_project.yml
[0m12:22:30.849968 [info ] [MainThread]: adapter type: duckdb
[0m12:22:30.851107 [info ] [MainThread]: adapter version: 1.9.3
[0m12:22:30.852088 [info ] [MainThread]: Configuration:
[0m12:22:30.853091 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:22:30.854389 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m12:22:30.855288 [info ] [MainThread]: Required dependencies:
[0m12:22:30.856303 [debug] [MainThread]: Executing "git --help"
[0m12:22:31.168080 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:22:31.169015 [debug] [MainThread]: STDERR: "b''"
[0m12:22:31.169015 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:22:31.170013 [info ] [MainThread]: Connection:
[0m12:22:31.171013 [info ] [MainThread]:   database: jaffle_shop
[0m12:22:31.172019 [info ] [MainThread]:   schema: main
[0m12:22:31.173013 [info ] [MainThread]:   path: jaffle_shop.duckdb
[0m12:22:31.174025 [info ] [MainThread]:   config_options: None
[0m12:22:31.174025 [info ] [MainThread]:   extensions: None
[0m12:22:31.175015 [info ] [MainThread]:   settings: {}
[0m12:22:31.176018 [info ] [MainThread]:   external_root: .
[0m12:22:31.176018 [info ] [MainThread]:   use_credential_provider: None
[0m12:22:31.177018 [info ] [MainThread]:   attach: None
[0m12:22:31.177018 [info ] [MainThread]:   filesystems: None
[0m12:22:31.178020 [info ] [MainThread]:   remote: None
[0m12:22:31.179014 [info ] [MainThread]:   plugins: None
[0m12:22:31.180029 [info ] [MainThread]:   disable_transactions: False
[0m12:22:31.183012 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:22:31.686225 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m12:22:31.917708 [debug] [MainThread]: Using duckdb connection "debug"
[0m12:22:31.918706 [debug] [MainThread]: On debug: select 1 as id
[0m12:22:31.919238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:22:31.944305 [debug] [MainThread]: SQL status: OK in 0.026 seconds
[0m12:22:31.946306 [debug] [MainThread]: On debug: Close
[0m12:22:31.947307 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:22:31.947307 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:22:31.948294 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\KBHATIA\jaffle_shop\dbt_project.yml> not found

[0m12:22:31.950813 [debug] [MainThread]: Command `python -m dbt.cli.main debug` failed at 12:22:31.950813 after 1.46 seconds
[0m12:22:31.951814 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:22:31.951814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001764BC4F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017650228860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001764F9B4290>]}
[0m12:22:31.952813 [debug] [MainThread]: Flushing usage events
[0m12:22:33.733263 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:24:19.223413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181B874EF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181BC1240B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181BC125250>]}


============================== 12:24:19.233930 | 3c208e9d-a3f5-4511-9992-dc364f4a4347 ==============================
[0m12:24:19.233930 [info ] [MainThread]: Running with dbt=1.9.6
[0m12:24:19.233930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m12:24:19.233930 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\KBHATIA\jaffle_shop\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m12:24:19.233930 [debug] [MainThread]: Command `python -m dbt.cli.main seed` failed at 12:24:19.233930 after 0.22 seconds
[0m12:24:19.233930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181BB1EE360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181BBD46810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181BC585FD0>]}
[0m12:24:19.233930 [debug] [MainThread]: Flushing usage events
[0m12:24:19.558496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:33.176782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263814EE3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263814EE480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002637EA539E0>]}


============================== 12:50:33.182787 | 22ab7380-b3ce-4267-9312-43a9c7012539 ==============================
[0m12:50:33.182787 [info ] [MainThread]: Running with dbt=1.9.6
[0m12:50:33.183828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:50:33.231890 [info ] [MainThread]: dbt version: 1.9.6
[0m12:50:33.233118 [info ] [MainThread]: python version: 3.12.10
[0m12:50:33.234129 [info ] [MainThread]: python path: C:\Users\KBHATIA\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\python.exe
[0m12:50:33.234129 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m12:50:33.369644 [info ] [MainThread]: Using profiles dir at C:\Users\KBHATIA\.dbt
[0m12:50:33.370560 [info ] [MainThread]: Using profiles.yml file at C:\Users\KBHATIA\.dbt\profiles.yml
[0m12:50:33.371350 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\KBHATIA\jaffle_shop\dbt_project.yml
[0m12:50:33.377027 [info ] [MainThread]: adapter type: duckdb
[0m12:50:33.377027 [info ] [MainThread]: adapter version: 1.9.3
[0m12:50:33.378025 [info ] [MainThread]: Configuration:
[0m12:50:33.379024 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:50:33.380028 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m12:50:33.381026 [info ] [MainThread]: Required dependencies:
[0m12:50:33.382034 [debug] [MainThread]: Executing "git --help"
[0m12:50:33.693452 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:50:33.694448 [debug] [MainThread]: STDERR: "b''"
[0m12:50:33.694448 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:50:33.695450 [info ] [MainThread]: Connection:
[0m12:50:33.696450 [info ] [MainThread]:   database: jaffle_shop
[0m12:50:33.697451 [info ] [MainThread]:   schema: main
[0m12:50:33.697451 [info ] [MainThread]:   path: jaffle_shop.duckdb
[0m12:50:33.697451 [info ] [MainThread]:   config_options: None
[0m12:50:33.698952 [info ] [MainThread]:   extensions: None
[0m12:50:33.699949 [info ] [MainThread]:   settings: {}
[0m12:50:33.699949 [info ] [MainThread]:   external_root: .
[0m12:50:33.700949 [info ] [MainThread]:   use_credential_provider: None
[0m12:50:33.701944 [info ] [MainThread]:   attach: None
[0m12:50:33.701944 [info ] [MainThread]:   filesystems: None
[0m12:50:33.702943 [info ] [MainThread]:   remote: None
[0m12:50:33.703944 [info ] [MainThread]:   plugins: None
[0m12:50:33.703944 [info ] [MainThread]:   disable_transactions: False
[0m12:50:33.705955 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:50:34.121741 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m12:50:34.319086 [debug] [MainThread]: Using duckdb connection "debug"
[0m12:50:34.320085 [debug] [MainThread]: On debug: select 1 as id
[0m12:50:34.320085 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:34.340104 [debug] [MainThread]: SQL status: OK in 0.020 seconds
[0m12:50:34.342104 [debug] [MainThread]: On debug: Close
[0m12:50:34.342104 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:50:34.343109 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:50:34.344107 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\KBHATIA\jaffle_shop\dbt_project.yml> not found

[0m12:50:34.346091 [debug] [MainThread]: Command `python -m dbt.cli.main debug` failed at 12:50:34.346091 after 1.36 seconds
[0m12:50:34.347090 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:50:34.347090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263829B0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026381A02270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638321C8F0>]}
[0m12:50:34.348089 [debug] [MainThread]: Flushing usage events
[0m12:50:35.505592 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:29.079394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5AFD011F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5AFD01220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5AFD01190>]}


============================== 12:53:29.079394 | eac0bea7-6e9d-4a53-b93d-f11008fd25cb ==============================
[0m12:53:29.079394 [info ] [MainThread]: Running with dbt=1.9.6
[0m12:53:29.079394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m12:53:29.079394 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\KBHATIA\jaffle_shop\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m12:53:29.079394 [debug] [MainThread]: Command `python -m dbt.cli.main seed` failed at 12:53:29.079394 after 0.19 seconds
[0m12:53:29.079394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5AFCA5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5B12D2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5B12D2E40>]}
[0m12:53:29.079394 [debug] [MainThread]: Flushing usage events
[0m12:53:30.483853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:55:12.272675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019763AEAA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019764618800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019763FF2DE0>]}


============================== 12:55:12.279204 | 1e17e107-cbda-488c-a57c-c68d3447a744 ==============================
[0m12:55:12.279204 [info ] [MainThread]: Running with dbt=1.9.6
[0m12:55:12.280204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:55:12.308852 [info ] [MainThread]: dbt version: 1.9.6
[0m12:55:12.309852 [info ] [MainThread]: python version: 3.12.10
[0m12:55:12.310851 [info ] [MainThread]: python path: C:\Users\KBHATIA\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\python.exe
[0m12:55:12.310851 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m12:55:12.432777 [info ] [MainThread]: Using profiles dir at C:\Users\KBHATIA\.dbt
[0m12:55:12.433754 [info ] [MainThread]: Using profiles.yml file at C:\Users\KBHATIA\.dbt\profiles.yml
[0m12:55:12.434752 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\KBHATIA\jaffle_shop\dbt_project.yml
[0m12:55:12.443235 [info ] [MainThread]: adapter type: duckdb
[0m12:55:12.444234 [info ] [MainThread]: adapter version: 1.9.3
[0m12:55:12.547904 [info ] [MainThread]: Configuration:
[0m12:55:12.549904 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:55:12.551375 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:55:12.552389 [info ] [MainThread]: Required dependencies:
[0m12:55:12.552389 [debug] [MainThread]: Executing "git --help"
[0m12:55:12.854301 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:55:12.854301 [debug] [MainThread]: STDERR: "b''"
[0m12:55:12.855381 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:55:12.856301 [info ] [MainThread]: Connection:
[0m12:55:12.857306 [info ] [MainThread]:   database: jaffle_shop
[0m12:55:12.857306 [info ] [MainThread]:   schema: main
[0m12:55:12.858302 [info ] [MainThread]:   path: jaffle_shop.duckdb
[0m12:55:12.858934 [info ] [MainThread]:   config_options: None
[0m12:55:12.859946 [info ] [MainThread]:   extensions: None
[0m12:55:12.860369 [info ] [MainThread]:   settings: {}
[0m12:55:12.860369 [info ] [MainThread]:   external_root: .
[0m12:55:12.861425 [info ] [MainThread]:   use_credential_provider: None
[0m12:55:12.862385 [info ] [MainThread]:   attach: None
[0m12:55:12.863377 [info ] [MainThread]:   filesystems: None
[0m12:55:12.863377 [info ] [MainThread]:   remote: None
[0m12:55:12.864380 [info ] [MainThread]:   plugins: None
[0m12:55:12.865378 [info ] [MainThread]:   disable_transactions: False
[0m12:55:12.868379 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m12:55:13.283778 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m12:55:13.492639 [debug] [MainThread]: Using duckdb connection "debug"
[0m12:55:13.492639 [debug] [MainThread]: On debug: select 1 as id
[0m12:55:13.493638 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:55:13.515186 [debug] [MainThread]: SQL status: OK in 0.022 seconds
[0m12:55:13.517149 [debug] [MainThread]: On debug: Close
[0m12:55:13.518148 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:55:13.518148 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:55:13.520414 [debug] [MainThread]: Command `python -m dbt.cli.main debug` succeeded at 12:55:13.520414 after 1.42 seconds
[0m12:55:13.520414 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:55:13.521413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197646F6CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001976504A2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001976327AEA0>]}
[0m12:55:13.521413 [debug] [MainThread]: Flushing usage events
[0m12:55:13.814736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:27.984326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE0D52CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE38EECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE38EE2A0>]}


============================== 13:20:27.984326 | b79c4808-3bbb-499a-8e66-cc34021ae95b ==============================
[0m13:20:27.984326 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:20:27.984326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m13:20:28.314400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b79c4808-3bbb-499a-8e66-cc34021ae95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE56A3830>]}
[0m13:20:28.361262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b79c4808-3bbb-499a-8e66-cc34021ae95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE46EC170>]}
[0m13:20:28.376903 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:20:28.836776 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:20:28.836776 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:20:28.852464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b79c4808-3bbb-499a-8e66-cc34021ae95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE5646240>]}
[0m13:20:30.106875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b79c4808-3bbb-499a-8e66-cc34021ae95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE5EE4C50>]}
[0m13:20:30.179138 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:20:30.183233 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:20:30.224859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b79c4808-3bbb-499a-8e66-cc34021ae95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE5DA5550>]}
[0m13:20:30.224859 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:20:30.224859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b79c4808-3bbb-499a-8e66-cc34021ae95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE5729B20>]}
[0m13:20:30.224859 [info ] [MainThread]: 
[0m13:20:30.224859 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:20:30.224859 [info ] [MainThread]: 
[0m13:20:30.230368 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:20:30.236460 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m13:20:30.509018 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m13:20:30.509018 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_shop"'
    
  
  
[0m13:20:30.509018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:30.524043 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m13:20:30.524043 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m13:20:30.524043 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m13:20:30.524043 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m13:20:30.539764 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:20:30.539764 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_shop'
        and type='sqlite'
    
  
[0m13:20:30.539764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:30.539764 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:20:30.539764 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:20:30.539764 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m13:20:30.539764 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:20:30.539764 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:20:30.539764 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m13:20:30.539764 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:20:30.539764 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:20:30.539764 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:20:30.539764 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:20:30.539764 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:20:30.539764 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m13:20:30.556165 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m13:20:30.556165 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:20:30.556165 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m13:20:30.556165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:30.556165 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:20:30.556165 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:20:30.556165 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m13:20:30.574418 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:20:30.574418 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m13:20:30.574418 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m13:20:30.574418 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m13:20:30.574418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b79c4808-3bbb-499a-8e66-cc34021ae95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE51A1D60>]}
[0m13:20:30.582935 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:30.582935 [debug] [MainThread]: On master: BEGIN
[0m13:20:30.582935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:30.582935 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:20:30.582935 [debug] [MainThread]: On master: COMMIT
[0m13:20:30.582935 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:30.582935 [debug] [MainThread]: On master: COMMIT
[0m13:20:30.582935 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:20:30.582935 [debug] [MainThread]: On master: Close
[0m13:20:30.582935 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m13:20:30.582935 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m13:20:30.582935 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m13:20:30.582935 [info ] [Thread-1 (]: 1 of 3 START seed file main.raw_customers ...................................... [RUN]
[0m13:20:30.582935 [info ] [Thread-2 (]: 2 of 3 START seed file main.raw_orders ......................................... [RUN]
[0m13:20:30.582935 [info ] [Thread-3 (]: 3 of 3 START seed file main.raw_payments ....................................... [RUN]
[0m13:20:30.598442 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_customers'
[0m13:20:30.598442 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_orders'
[0m13:20:30.598442 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_payments'
[0m13:20:30.599951 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m13:20:30.599951 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m13:20:30.599951 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m13:20:30.599951 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m13:20:30.599951 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m13:20:30.599951 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m13:20:30.630884 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m13:20:30.630884 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: BEGIN
[0m13:20:30.630884 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:20:30.639061 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:20:30.639061 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_payments"
[0m13:20:30.639061 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m13:20:30.639061 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m13:20:30.639061 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: BEGIN
[0m13:20:30.639061 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: BEGIN
[0m13:20:30.639061 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */

    create table "jaffle_shop"."main"."raw_customers" ("id" integer,"first_name" text,"last_name" text,"email" text,"created_at" timestamp without time zone,"updated_at" timestamp without time zone)
  
[0m13:20:30.639061 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:20:30.639061 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:20:30.650274 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:20:30.650274 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:20:30.650274 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:20:30.650274 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_payments"
[0m13:20:30.666729 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m13:20:30.666729 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m13:20:30.666729 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */

    create table "jaffle_shop"."main"."raw_payments" ("id" integer,"order_id" integer,"payment_method" text,"status" text,"amount" integer,"created_at" timestamp without time zone,"updated_at" timestamp without time zone)
  
[0m13:20:30.666729 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: 
          COPY "jaffle_shop"."main"."raw_customers" FROM 'C:\Users\KBHATIA\jaffle_shop\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:20:30.666729 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */

    create table "jaffle_shop"."main"."raw_orders" ("id" integer,"user_id" integer,"order_date" date,"status" text,"created_at" timestamp without time zone,"updated_at" timestamp without time zone)
  
[0m13:20:30.666729 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:20:30.666729 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:20:30.666729 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_payments"
[0m13:20:30.666729 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m13:20:30.666729 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: 
          COPY "jaffle_shop"."main"."raw_payments" FROM 'C:\Users\KBHATIA\jaffle_shop\seeds\raw_payments.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:20:30.666729 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: 
          COPY "jaffle_shop"."main"."raw_orders" FROM 'C:\Users\KBHATIA\jaffle_shop\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:20:30.666729 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m13:20:30.682828 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m13:20:30.689854 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m13:20:30.689854 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m13:20:30.689854 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m13:20:30.689854 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m13:20:30.722901 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: COMMIT
[0m13:20:30.716889 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m13:20:30.723994 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_payments"
[0m13:20:30.723994 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m13:20:30.723994 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m13:20:30.728519 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: COMMIT
[0m13:20:30.729106 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m13:20:30.729106 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m13:20:30.729106 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m13:20:30.733292 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m13:20:30.737741 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m13:20:30.737741 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m13:20:30.741749 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m13:20:30.741749 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b79c4808-3bbb-499a-8e66-cc34021ae95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE6761550>]}
[0m13:20:30.741749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b79c4808-3bbb-499a-8e66-cc34021ae95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE6760EF0>]}
[0m13:20:30.741749 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file main.raw_payments ................................... [[32mINSERT 7[0m in 0.14s]
[0m13:20:30.741749 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m13:20:30.741749 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m13:20:30.741749 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m13:20:30.741749 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file main.raw_customers .................................. [[32mINSERT 7[0m in 0.16s]
[0m13:20:30.749521 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b79c4808-3bbb-499a-8e66-cc34021ae95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE6778500>]}
[0m13:20:30.750725 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m13:20:30.750725 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file main.raw_orders ..................................... [[32mINSERT 7[0m in 0.15s]
[0m13:20:30.750725 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m13:20:30.750725 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:30.750725 [debug] [MainThread]: On master: BEGIN
[0m13:20:30.750725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:20:30.750725 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:20:30.750725 [debug] [MainThread]: On master: COMMIT
[0m13:20:30.750725 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:30.750725 [debug] [MainThread]: On master: COMMIT
[0m13:20:30.750725 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:20:30.750725 [debug] [MainThread]: On master: Close
[0m13:20:30.750725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:30.750725 [debug] [MainThread]: Connection 'create_jaffle_shop_main' was properly closed.
[0m13:20:30.750725 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m13:20:30.750725 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m13:20:30.750725 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m13:20:30.750725 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m13:20:30.750725 [info ] [MainThread]: 
[0m13:20:30.750725 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m13:20:30.750725 [debug] [MainThread]: Command end result
[0m13:20:30.787261 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:20:30.797278 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:20:30.806816 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:20:30.806816 [info ] [MainThread]: 
[0m13:20:30.806816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:20:30.806816 [info ] [MainThread]: 
[0m13:20:30.806816 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:20:30.813168 [debug] [MainThread]: Command `python -m dbt.cli.main seed` succeeded at 13:20:30.813168 after 3.04 seconds
[0m13:20:30.813168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE4D6CEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE1F6F3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDF8415E0>]}
[0m13:20:30.816079 [debug] [MainThread]: Flushing usage events
[0m13:20:31.738332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:01.741605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF57626D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF53C4FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF57625490>]}


============================== 13:21:01.741605 | 805ebfd4-a3d5-49e2-8333-77f2648c5ee8 ==============================
[0m13:21:01.741605 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:21:01.741605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models tag:staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:02.067758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '805ebfd4-a3d5-49e2-8333-77f2648c5ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF5846CE60>]}
[0m13:21:02.131519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '805ebfd4-a3d5-49e2-8333-77f2648c5ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF56745550>]}
[0m13:21:02.131519 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:21:02.573923 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:21:02.748266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:02.763887 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:02.795563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '805ebfd4-a3d5-49e2-8333-77f2648c5ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF584BF0E0>]}
[0m13:21:02.860729 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:21:02.874724 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:21:02.907088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '805ebfd4-a3d5-49e2-8333-77f2648c5ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF58E86CC0>]}
[0m13:21:02.907088 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:21:02.907088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '805ebfd4-a3d5-49e2-8333-77f2648c5ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF5704F020>]}
[0m13:21:02.907088 [info ] [MainThread]: 
[0m13:21:02.907088 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:02.907088 [info ] [MainThread]: 
[0m13:21:02.907088 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:21:02.907088 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m13:21:03.115106 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m13:21:03.115106 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_shop"'
    
  
  
[0m13:21:03.115106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:03.138007 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m13:21:03.138007 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m13:21:03.138007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m13:21:03.138007 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m13:21:03.153643 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:21:03.153643 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_shop'
        and type='sqlite'
    
  
[0m13:21:03.153643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:03.153643 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:21:03.153643 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:21:03.153643 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m13:21:03.153643 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:21:03.153643 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:21:03.153643 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m13:21:03.153643 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:21:03.153643 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:21:03.153643 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:21:03.153643 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:21:03.153643 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:21:03.153643 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m13:21:03.153643 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m13:21:03.169267 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:21:03.169267 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m13:21:03.169267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:03.169267 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:21:03.169267 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:21:03.169267 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m13:21:03.185283 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:21:03.185283 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m13:21:03.185283 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m13:21:03.185283 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m13:21:03.185283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '805ebfd4-a3d5-49e2-8333-77f2648c5ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF57F97590>]}
[0m13:21:03.185283 [debug] [MainThread]: Using duckdb connection "master"
[0m13:21:03.185283 [debug] [MainThread]: On master: BEGIN
[0m13:21:03.185283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:03.185283 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:21:03.185283 [debug] [MainThread]: On master: COMMIT
[0m13:21:03.185283 [debug] [MainThread]: Using duckdb connection "master"
[0m13:21:03.185283 [debug] [MainThread]: On master: COMMIT
[0m13:21:03.185283 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:21:03.185283 [debug] [MainThread]: On master: Close
[0m13:21:03.200939 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m13:21:03.200939 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m13:21:03.200939 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m13:21:03.200939 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m13:21:03.200939 [info ] [Thread-2 (]: 2 of 3 START sql view model main.stg_orders .................................... [RUN]
[0m13:21:03.206791 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_customers'
[0m13:21:03.200939 [info ] [Thread-3 (]: 3 of 3 START sql view model main.stg_payments .................................. [RUN]
[0m13:21:03.206791 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m13:21:03.206791 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m13:21:03.206791 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_payments'
[0m13:21:03.206791 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m13:21:03.206791 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:21:03.206791 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m13:21:03.219663 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:21:03.223447 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m13:21:03.232455 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m13:21:03.232455 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m13:21:03.256884 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m13:21:03.256884 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m13:21:03.256884 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m13:21:03.274649 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:21:03.274649 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:21:03.274649 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:21:03.274649 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m13:21:03.274649 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m13:21:03.274649 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:21:03.274649 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:21:03.274649 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:21:03.274649 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m13:21:03.274649 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:21:03.274649 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:21:03.274649 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:21:03.274649 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:21:03.274649 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:21:03.287656 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:21:03.287656 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  
  create view "jaffle_shop"."main"."stg_payments__dbt_tmp" as (
    

with payments as (
    select
        id as payment_id,
        order_id,
        payment_method,
        amount / 100.0 as amount_usd,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_payments"
    where status = 'success'
)

select * from payments
  );

[0m13:21:03.287656 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:21:03.289395 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    

with orders as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status as order_status,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_orders"
)

select * from orders
  );

[0m13:21:03.289395 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    

with customers as (
    select
        id as customer_id,
        first_name,
        last_name,
        email,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_customers"
)

select * from customers
  );

[0m13:21:03.289395 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:21:03.296016 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:21:03.296016 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m13:21:03.296016 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m13:21:03.296016 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter view "jaffle_shop"."main"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m13:21:03.296016 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:21:03.304129 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:21:03.306449 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:21:03.306449 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:21:03.306449 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:21:03.312596 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m13:21:03.312596 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m13:21:03.312596 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:21:03.312596 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:21:03.321349 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m13:21:03.321349 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m13:21:03.321349 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m13:21:03.321349 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:21:03.321349 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:21:03.321349 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m13:21:03.321349 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m13:21:03.329015 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:21:03.329015 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:21:03.329015 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "jaffle_shop"."main"."stg_payments__dbt_backup" cascade
[0m13:21:03.329015 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m13:21:03.329015 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:21:03.329015 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:21:03.329015 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m13:21:03.329015 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m13:21:03.344629 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m13:21:03.345385 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:21:03.345385 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."main"."stg_customers__dbt_backup" cascade
[0m13:21:03.345385 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:21:03.345385 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m13:21:03.345385 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:21:03.345385 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m13:21:03.345385 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '805ebfd4-a3d5-49e2-8333-77f2648c5ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF567CC860>]}
[0m13:21:03.345385 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '805ebfd4-a3d5-49e2-8333-77f2648c5ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF592EDCD0>]}
[0m13:21:03.360487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '805ebfd4-a3d5-49e2-8333-77f2648c5ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF592F5010>]}
[0m13:21:03.360487 [info ] [Thread-3 (]: 3 of 3 OK created sql view model main.stg_payments ............................. [[32mOK[0m in 0.14s]
[0m13:21:03.360487 [info ] [Thread-2 (]: 2 of 3 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.14s]
[0m13:21:03.360487 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m13:21:03.360487 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.14s]
[0m13:21:03.360487 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m13:21:03.360487 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m13:21:03.360487 [debug] [MainThread]: Using duckdb connection "master"
[0m13:21:03.360487 [debug] [MainThread]: On master: BEGIN
[0m13:21:03.360487 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:03.360487 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:21:03.360487 [debug] [MainThread]: On master: COMMIT
[0m13:21:03.360487 [debug] [MainThread]: Using duckdb connection "master"
[0m13:21:03.360487 [debug] [MainThread]: On master: COMMIT
[0m13:21:03.360487 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:21:03.360487 [debug] [MainThread]: On master: Close
[0m13:21:03.360487 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:03.360487 [debug] [MainThread]: Connection 'create_jaffle_shop_main' was properly closed.
[0m13:21:03.360487 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m13:21:03.360487 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m13:21:03.360487 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m13:21:03.360487 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m13:21:03.360487 [info ] [MainThread]: 
[0m13:21:03.360487 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m13:21:03.373890 [debug] [MainThread]: Command end result
[0m13:21:03.391373 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:21:03.399943 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:21:03.408767 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:21:03.408767 [info ] [MainThread]: 
[0m13:21:03.408767 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:03.408767 [info ] [MainThread]: 
[0m13:21:03.408767 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:21:03.408767 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 13:21:03.408767 after 1.86 seconds
[0m13:21:03.408767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF57B463F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF57B46090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF56259C70>]}
[0m13:21:03.408767 [debug] [MainThread]: Flushing usage events
[0m13:21:03.707010 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:40.830238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024761592F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024762CECBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024762CEFB30>]}


============================== 13:21:40.830238 | c4dc0d94-bed6-454b-a090-b8a5f915a750 ==============================
[0m13:21:40.830238 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:21:40.830238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models tag:core', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:41.145318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4dc0d94-bed6-454b-a090-b8a5f915a750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002476366CD10>]}
[0m13:21:41.206540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4dc0d94-bed6-454b-a090-b8a5f915a750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024761E2C6B0>]}
[0m13:21:41.215077 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:21:41.622266 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:21:41.827211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:41.827211 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:41.858877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4dc0d94-bed6-454b-a090-b8a5f915a750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024763AC4AD0>]}
[0m13:21:41.922854 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:21:41.939097 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:21:41.970236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4dc0d94-bed6-454b-a090-b8a5f915a750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024763B1CCE0>]}
[0m13:21:41.970236 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:21:41.970236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4dc0d94-bed6-454b-a090-b8a5f915a750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024763AC4140>]}
[0m13:21:41.970236 [info ] [MainThread]: 
[0m13:21:41.970236 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:41.970236 [info ] [MainThread]: 
[0m13:21:41.970236 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:21:41.970236 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m13:21:42.152804 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m13:21:42.152804 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_shop"'
    
  
  
[0m13:21:42.152804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:42.184898 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m13:21:42.184898 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m13:21:42.184898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m13:21:42.184898 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m13:21:42.199913 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:21:42.199913 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_shop'
        and type='sqlite'
    
  
[0m13:21:42.199913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:42.206423 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:21:42.206423 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:21:42.206423 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m13:21:42.206423 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:21:42.206423 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:21:42.206423 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m13:21:42.206423 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:21:42.206423 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:21:42.206423 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:21:42.206423 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:21:42.206423 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:21:42.206423 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m13:21:42.206423 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m13:21:42.217447 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:21:42.217447 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m13:21:42.217447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:42.217447 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:21:42.217447 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:21:42.217447 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m13:21:42.236133 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m13:21:42.246146 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m13:21:42.247659 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m13:21:42.247659 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m13:21:42.247659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4dc0d94-bed6-454b-a090-b8a5f915a750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024763E84470>]}
[0m13:21:42.247659 [debug] [MainThread]: Using duckdb connection "master"
[0m13:21:42.247659 [debug] [MainThread]: On master: BEGIN
[0m13:21:42.247659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:42.247659 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:21:42.247659 [debug] [MainThread]: On master: COMMIT
[0m13:21:42.247659 [debug] [MainThread]: Using duckdb connection "master"
[0m13:21:42.247659 [debug] [MainThread]: On master: COMMIT
[0m13:21:42.247659 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:21:42.247659 [debug] [MainThread]: On master: Close
[0m13:21:42.247659 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m13:21:42.247659 [debug] [Thread-2 (]: Began running node model.jaffle_shop.fct_orders
[0m13:21:42.247659 [info ] [Thread-1 (]: 1 of 2 START sql table model main.dim_customers ................................ [RUN]
[0m13:21:42.263293 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_shop.dim_customers'
[0m13:21:42.263293 [info ] [Thread-2 (]: 2 of 2 START sql table model main.fct_orders ................................... [RUN]
[0m13:21:42.263293 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m13:21:42.263293 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.fct_orders'
[0m13:21:42.263293 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m13:21:42.263293 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.fct_orders
[0m13:21:42.263293 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m13:21:42.281584 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m13:21:42.290597 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.fct_orders
[0m13:21:42.324449 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m13:21:42.324449 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m13:21:42.331456 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:21:42.331456 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:21:42.331456 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m13:21:42.331456 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m13:21:42.331456 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:21:42.331456 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:21:42.331456 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:21:42.331456 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:21:42.331456 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    
    

    create  table
      "jaffle_shop"."main"."fct_orders__dbt_tmp"
  
    as (
      

with orders as (
    select * from "jaffle_shop"."main"."stg_orders"
),

payments as (
    select
        order_id,
        sum(amount_usd) as total_amount
    from "jaffle_shop"."main"."stg_payments"
    group by order_id
),

final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.order_status,
        coalesce(payments.total_amount, 0) as amount,
        orders.created_at,
        orders.updated_at
    from orders
    left join payments on orders.order_id = payments.order_id
)

select * from final
    );
  
  
[0m13:21:42.331456 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:21:42.331456 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:21:42.339465 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_customers__dbt_tmp"
  
    as (
      

with customers as (
    select * from "jaffle_shop"."main"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders
    from "jaffle_shop"."main"."stg_orders"
    group by customer_id
),

customer_payments as (
    select
        orders.customer_id,
        sum(payments.amount_usd) as lifetime_value
    from "jaffle_shop"."main"."stg_orders" orders
    left join "jaffle_shop"."main"."stg_payments" payments
        on orders.order_id = payments.order_id
    group by orders.customer_id
),

final as (
    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customers.email,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_payments.lifetime_value, 0) as lifetime_value,
        customers.created_at,
        customers.updated_at
    from customers
    left join customer_orders on customers.customer_id = customer_orders.customer_id
    left join customer_payments on customers.customer_id = customer_payments.customer_id
)

select * from final
    );
  
  
[0m13:21:42.339465 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:21:42.346586 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:21:42.346586 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m13:21:42.346586 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "jaffle_shop"."main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:21:42.346586 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:21:42.355602 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:21:42.355602 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:21:42.355602 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m13:21:42.355602 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:21:42.355602 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m13:21:42.355602 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m13:21:42.355602 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m13:21:42.371315 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:21:42.371315 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m13:21:42.371315 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:21:42.371315 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:21:42.371315 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "jaffle_shop"."main"."fct_orders__dbt_backup" cascade
[0m13:21:42.371315 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m13:21:42.371315 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:21:42.371315 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."main"."dim_customers__dbt_backup" cascade
[0m13:21:42.371315 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:21:42.386860 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: Close
[0m13:21:42.371315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:21:42.386860 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m13:21:42.386860 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4dc0d94-bed6-454b-a090-b8a5f915a750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024764205040>]}
[0m13:21:42.386860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4dc0d94-bed6-454b-a090-b8a5f915a750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247642A4950>]}
[0m13:21:42.386860 [info ] [Thread-2 (]: 2 of 2 OK created sql table model main.fct_orders .............................. [[32mOK[0m in 0.12s]
[0m13:21:42.386860 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.fct_orders
[0m13:21:42.386860 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.dim_customers ........................... [[32mOK[0m in 0.12s]
[0m13:21:42.386860 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m13:21:42.386860 [debug] [MainThread]: Using duckdb connection "master"
[0m13:21:42.386860 [debug] [MainThread]: On master: BEGIN
[0m13:21:42.386860 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:42.386860 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:21:42.402579 [debug] [MainThread]: On master: COMMIT
[0m13:21:42.402579 [debug] [MainThread]: Using duckdb connection "master"
[0m13:21:42.403823 [debug] [MainThread]: On master: COMMIT
[0m13:21:42.403823 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:21:42.405323 [debug] [MainThread]: On master: Close
[0m13:21:42.405323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:42.406430 [debug] [MainThread]: Connection 'create_jaffle_shop_main' was properly closed.
[0m13:21:42.407327 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m13:21:42.407474 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m13:21:42.407474 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m13:21:42.407474 [info ] [MainThread]: 
[0m13:21:42.409323 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m13:21:42.409323 [debug] [MainThread]: Command end result
[0m13:21:42.434524 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:21:42.434524 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:21:42.446785 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:21:42.450297 [info ] [MainThread]: 
[0m13:21:42.450297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:42.450297 [info ] [MainThread]: 
[0m13:21:42.450297 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:21:42.450297 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 13:21:42.450297 after 1.82 seconds
[0m13:21:42.450297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002476142AF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475F5FEF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024763123FE0>]}
[0m13:21:42.450297 [debug] [MainThread]: Flushing usage events
[0m13:21:42.627951 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:22:17.641749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017723A19EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177237A25A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177243805C0>]}


============================== 13:22:17.648779 | 63bee934-589c-4609-bdba-f0683b0cb17d ==============================
[0m13:22:17.648779 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:22:17.649749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models tag:finance', 'send_anonymous_usage_stats': 'True'}
[0m13:22:17.948248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63bee934-589c-4609-bdba-f0683b0cb17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017724D6FCE0>]}
[0m13:22:18.019782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63bee934-589c-4609-bdba-f0683b0cb17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017722928170>]}
[0m13:22:18.026883 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:22:18.445583 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:22:18.629631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:18.630625 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:18.659628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63bee934-589c-4609-bdba-f0683b0cb17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017724C963F0>]}
[0m13:22:18.723871 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:22:18.730869 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:22:18.764864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63bee934-589c-4609-bdba-f0683b0cb17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001772504AED0>]}
[0m13:22:18.765858 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:22:18.766858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63bee934-589c-4609-bdba-f0683b0cb17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001772541E6F0>]}
[0m13:22:18.767863 [info ] [MainThread]: 
[0m13:22:18.768857 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:22:18.768857 [info ] [MainThread]: 
[0m13:22:18.769858 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:22:18.770857 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m13:22:18.961207 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m13:22:18.961207 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_shop"'
    
  
  
[0m13:22:18.962205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:18.982200 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m13:22:18.984199 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m13:22:18.984999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m13:22:18.984999 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m13:22:18.991087 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:22:18.991087 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_shop'
        and type='sqlite'
    
  
[0m13:22:18.992094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:22:18.993031 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:22:18.994085 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:22:18.994085 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m13:22:18.994085 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:22:18.995007 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:22:18.995007 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m13:22:18.996006 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:22:18.996594 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:22:18.996594 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:22:18.996594 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:22:18.997682 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:22:18.997682 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m13:22:19.004366 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m13:22:19.009373 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:22:19.009373 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m13:22:19.009373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:19.010372 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:22:19.010372 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:22:19.010372 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m13:22:19.029774 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m13:22:19.031784 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m13:22:19.033784 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m13:22:19.033784 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m13:22:19.035871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63bee934-589c-4609-bdba-f0683b0cb17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017725586900>]}
[0m13:22:19.035871 [debug] [MainThread]: Using duckdb connection "master"
[0m13:22:19.036872 [debug] [MainThread]: On master: BEGIN
[0m13:22:19.036872 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:22:19.037856 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:22:19.037856 [debug] [MainThread]: On master: COMMIT
[0m13:22:19.038871 [debug] [MainThread]: Using duckdb connection "master"
[0m13:22:19.038871 [debug] [MainThread]: On master: COMMIT
[0m13:22:19.038871 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:22:19.039873 [debug] [MainThread]: On master: Close
[0m13:22:19.045820 [debug] [Thread-1 (]: Began running node model.jaffle_shop.revenue_by_month
[0m13:22:19.046868 [info ] [Thread-1 (]: 1 of 1 START sql table model main.revenue_by_month ............................. [RUN]
[0m13:22:19.047780 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_shop.revenue_by_month'
[0m13:22:19.047780 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.revenue_by_month
[0m13:22:19.056775 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.revenue_by_month"
[0m13:22:19.058959 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.revenue_by_month
[0m13:22:19.099861 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.revenue_by_month"
[0m13:22:19.102841 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:22:19.103842 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: BEGIN
[0m13:22:19.104843 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:22:19.106839 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:22:19.106839 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:22:19.106839 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */

  
    
    

    create  table
      "jaffle_shop"."main"."revenue_by_month__dbt_tmp"
  
    as (
      

with monthly_revenue as (
    select
        date_trunc('month', order_date) as order_month,
        sum(amount) as monthly_revenue,
        count(distinct order_id) as monthly_orders,
        count(distinct customer_id) as monthly_customers,
        avg(amount) as avg_order_value
    from "jaffle_shop"."main"."fct_orders"
    where order_status not in ('returned', 'cancelled')
    group by date_trunc('month', order_date)
)

select 
    order_month,
    monthly_revenue,
    monthly_orders,
    monthly_customers,
    avg_order_value,
    lag(monthly_revenue) over (order by order_month) as prev_month_revenue,
    (monthly_revenue - lag(monthly_revenue) over (order by order_month)) / 
        lag(monthly_revenue) over (order by order_month) * 100 as revenue_growth_pct
from monthly_revenue
order by order_month
    );
  
  
[0m13:22:19.114838 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:22:19.120834 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:22:19.122366 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
alter table "jaffle_shop"."main"."revenue_by_month__dbt_tmp" rename to "revenue_by_month"
[0m13:22:19.123378 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:22:19.135456 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: COMMIT
[0m13:22:19.135456 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:22:19.136377 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: COMMIT
[0m13:22:19.142949 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:22:19.148957 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:22:19.148957 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
drop table if exists "jaffle_shop"."main"."revenue_by_month__dbt_backup" cascade
[0m13:22:19.149957 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:22:19.151957 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: Close
[0m13:22:19.153956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63bee934-589c-4609-bdba-f0683b0cb17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017725587CB0>]}
[0m13:22:19.153956 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.revenue_by_month ........................ [[32mOK[0m in 0.11s]
[0m13:22:19.155179 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.revenue_by_month
[0m13:22:19.157190 [debug] [MainThread]: Using duckdb connection "master"
[0m13:22:19.158189 [debug] [MainThread]: On master: BEGIN
[0m13:22:19.158189 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:22:19.159187 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:22:19.159187 [debug] [MainThread]: On master: COMMIT
[0m13:22:19.160186 [debug] [MainThread]: Using duckdb connection "master"
[0m13:22:19.160186 [debug] [MainThread]: On master: COMMIT
[0m13:22:19.161185 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:22:19.161185 [debug] [MainThread]: On master: Close
[0m13:22:19.161185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:19.162185 [debug] [MainThread]: Connection 'create_jaffle_shop_main' was properly closed.
[0m13:22:19.162185 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m13:22:19.162185 [debug] [MainThread]: Connection 'model.jaffle_shop.revenue_by_month' was properly closed.
[0m13:22:19.162185 [info ] [MainThread]: 
[0m13:22:19.163185 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m13:22:19.164187 [debug] [MainThread]: Command end result
[0m13:22:19.190182 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:22:19.195183 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:22:19.201215 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:22:19.201215 [info ] [MainThread]: 
[0m13:22:19.202217 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:22:19.205222 [info ] [MainThread]: 
[0m13:22:19.206222 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:22:19.209223 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 13:22:19.209223 after 1.75 seconds
[0m13:22:19.210215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177245CF0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177245CEE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177245CEA20>]}
[0m13:22:19.211240 [debug] [MainThread]: Flushing usage events
[0m13:22:20.179175 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:04.316878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131A96B2870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131A96B0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131A96B1A30>]}


============================== 13:23:04.323803 | 848e8e1a-29f7-4c9f-b782-678444b5dffe ==============================
[0m13:23:04.323803 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:23:04.324801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:23:04.630346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '848e8e1a-29f7-4c9f-b782-678444b5dffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131A626C200>]}
[0m13:23:04.679872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '848e8e1a-29f7-4c9f-b782-678444b5dffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131A9DF8EC0>]}
[0m13:23:04.686586 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:23:05.138030 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:23:05.331460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:23:05.331460 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:23:05.366660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '848e8e1a-29f7-4c9f-b782-678444b5dffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131AA9C8650>]}
[0m13:23:05.432832 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:23:05.437826 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:23:05.479057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '848e8e1a-29f7-4c9f-b782-678444b5dffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131AAE73920>]}
[0m13:23:05.480065 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:23:05.480065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '848e8e1a-29f7-4c9f-b782-678444b5dffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131AAD87F80>]}
[0m13:23:05.482064 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:23:05.484066 [debug] [MainThread]: Command end result
[0m13:23:05.508375 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:23:05.512367 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:23:05.519363 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:23:05.521366 [debug] [MainThread]: Command `python -m dbt.cli.main test` succeeded at 13:23:05.520372 after 1.40 seconds
[0m13:23:05.521366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131A8FC9C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131A9DF9E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131A9286CF0>]}
[0m13:23:05.522366 [debug] [MainThread]: Flushing usage events
[0m13:23:05.701980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:25.143590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD92CE900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD92CFC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD92CE8A0>]}


============================== 13:26:25.154587 | 2c7e5963-038f-497f-991a-63b426e85a37 ==============================
[0m13:26:25.154587 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:26:25.154587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m13:26:25.496166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c7e5963-038f-497f-991a-63b426e85a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD8FB01A0>]}
[0m13:26:25.557540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c7e5963-038f-497f-991a-63b426e85a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD98A2D20>]}
[0m13:26:25.564529 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:26:26.042492 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:26:26.289428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:26.290431 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:26.332877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c7e5963-038f-497f-991a-63b426e85a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD93A0560>]}
[0m13:26:26.402130 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:26:26.408130 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:26:26.448513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c7e5963-038f-497f-991a-63b426e85a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD99249B0>]}
[0m13:26:26.449514 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:26:26.450512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c7e5963-038f-497f-991a-63b426e85a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD93515B0>]}
[0m13:26:26.451618 [info ] [MainThread]: 
[0m13:26:26.452626 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:26:26.453516 [info ] [MainThread]: 
[0m13:26:26.454526 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:26:26.459559 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m13:26:26.679083 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m13:26:26.680081 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_shop"'
    
  
  
[0m13:26:26.680081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:26.717073 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m13:26:26.719079 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m13:26:26.720075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m13:26:26.720075 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m13:26:26.727638 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:26:26.727638 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_shop'
        and type='sqlite'
    
  
[0m13:26:26.727638 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:26:26.729616 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:26:26.730772 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:26:26.731623 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m13:26:26.731623 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:26:26.732616 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:26:26.732616 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m13:26:26.732616 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:26:26.733615 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:26:26.734616 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:26:26.734616 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:26:26.734616 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:26:26.734616 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m13:26:26.737288 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m13:26:26.742284 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:26:26.743285 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m13:26:26.743285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:26.744284 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:26:26.744284 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:26:26.744284 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m13:26:26.759283 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:26:26.760289 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m13:26:26.762284 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m13:26:26.762284 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m13:26:26.765227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c7e5963-038f-497f-991a-63b426e85a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD5621A00>]}
[0m13:26:26.765227 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:26.766359 [debug] [MainThread]: On master: BEGIN
[0m13:26:26.766359 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:26.767384 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:26:26.767384 [debug] [MainThread]: On master: COMMIT
[0m13:26:26.767384 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:26.768355 [debug] [MainThread]: On master: COMMIT
[0m13:26:26.769260 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:26:26.769260 [debug] [MainThread]: On master: Close
[0m13:26:26.781075 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m13:26:26.782132 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m13:26:26.783077 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m13:26:26.784074 [info ] [Thread-1 (]: 1 of 3 START seed file main.raw_customers ...................................... [RUN]
[0m13:26:26.785076 [info ] [Thread-2 (]: 2 of 3 START seed file main.raw_orders ......................................... [RUN]
[0m13:26:26.787078 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_customers'
[0m13:26:26.786073 [info ] [Thread-3 (]: 3 of 3 START seed file main.raw_payments ....................................... [RUN]
[0m13:26:26.788081 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_orders'
[0m13:26:26.788081 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m13:26:26.790073 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_payments'
[0m13:26:26.791388 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m13:26:26.791800 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m13:26:26.791800 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m13:26:26.792846 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m13:26:26.826732 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m13:26:26.850985 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m13:26:26.852897 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: BEGIN
[0m13:26:26.853986 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:26:26.854897 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:26:26.858945 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m13:26:26.859949 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m13:26:26.860950 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: BEGIN
[0m13:26:26.864943 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_payments"
[0m13:26:26.865870 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
truncate table "jaffle_shop"."main"."raw_customers"
[0m13:26:26.866581 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:26:26.867016 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: BEGIN
[0m13:26:26.868455 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:26:26.869455 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:26:26.869455 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:26:26.884069 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m13:26:26.885071 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m13:26:26.886067 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m13:26:26.886067 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: 
          COPY "jaffle_shop"."main"."raw_customers" FROM 'C:\Users\KBHATIA\jaffle_shop\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:26:26.887070 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_payments"
[0m13:26:26.888082 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
truncate table "jaffle_shop"."main"."raw_orders"
[0m13:26:26.889070 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
truncate table "jaffle_shop"."main"."raw_payments"
[0m13:26:26.891067 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:26:26.892177 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m13:26:26.893072 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:26:26.893072 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: 
          COPY "jaffle_shop"."main"."raw_orders" FROM 'C:\Users\KBHATIA\jaffle_shop\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:26:26.895151 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_payments"
[0m13:26:26.896150 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: 
          COPY "jaffle_shop"."main"."raw_payments" FROM 'C:\Users\KBHATIA\jaffle_shop\seeds\raw_payments.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:26:26.898066 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m13:26:26.904147 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m13:26:26.906068 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m13:26:26.906068 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m13:26:26.907148 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m13:26:26.908066 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m13:26:26.920074 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m13:26:26.921075 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m13:26:26.921075 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m13:26:26.923077 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: COMMIT
[0m13:26:26.924085 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_payments"
[0m13:26:26.925097 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: COMMIT
[0m13:26:26.928685 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m13:26:26.928685 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m13:26:26.929613 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m13:26:26.930612 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m13:26:26.931616 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m13:26:26.933914 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m13:26:26.934943 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m13:26:26.936856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c7e5963-038f-497f-991a-63b426e85a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AADA6B7FE0>]}
[0m13:26:26.936856 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c7e5963-038f-497f-991a-63b426e85a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AADA6B6AB0>]}
[0m13:26:26.938825 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:26:26.937956 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file main.raw_customers .................................. [[32mINSERT 7[0m in 0.15s]
[0m13:26:26.940821 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m13:26:26.939821 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file main.raw_payments ................................... [[32mINSERT 7[0m in 0.15s]
[0m13:26:26.941868 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m13:26:26.942880 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c7e5963-038f-497f-991a-63b426e85a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AADA6AB470>]}
[0m13:26:26.943801 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m13:26:26.944840 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file main.raw_orders ..................................... [[32mINSERT 7[0m in 0.15s]
[0m13:26:26.945808 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m13:26:26.946810 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:26.948317 [debug] [MainThread]: On master: BEGIN
[0m13:26:26.948317 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:26:26.949324 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:26:26.949324 [debug] [MainThread]: On master: COMMIT
[0m13:26:26.949324 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:26.950325 [debug] [MainThread]: On master: COMMIT
[0m13:26:26.951324 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:26:26.951324 [debug] [MainThread]: On master: Close
[0m13:26:26.953352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:26.953352 [debug] [MainThread]: Connection 'create_jaffle_shop_main' was properly closed.
[0m13:26:26.954334 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m13:26:26.954334 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m13:26:26.954334 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m13:26:26.954334 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m13:26:26.955378 [info ] [MainThread]: 
[0m13:26:26.956325 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m13:26:26.957388 [debug] [MainThread]: Command end result
[0m13:26:26.981859 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:26:26.987841 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:26:26.997057 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:26:26.998066 [info ] [MainThread]: 
[0m13:26:26.998410 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:26:26.999429 [info ] [MainThread]: 
[0m13:26:26.999429 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:26:27.001519 [debug] [MainThread]: Command `python -m dbt.cli.main seed` succeeded at 13:26:27.001519 after 2.23 seconds
[0m13:26:27.002511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD57FFD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAD56AA180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AADA4D71A0>]}
[0m13:26:27.002511 [debug] [MainThread]: Flushing usage events
[0m13:26:28.159530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:35.827853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002563FA50DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002563CD7C230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002563B722EA0>]}


============================== 13:26:35.827853 | 8f8b21c0-894d-4b11-8864-ea64e778d7eb ==============================
[0m13:26:35.827853 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:26:35.837862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:26:36.123621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f8b21c0-894d-4b11-8864-ea64e778d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256412CE690>]}
[0m13:26:36.186088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f8b21c0-894d-4b11-8864-ea64e778d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025641840F80>]}
[0m13:26:36.186088 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:26:36.607478 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:26:36.815860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:36.815860 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:36.849259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f8b21c0-894d-4b11-8864-ea64e778d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025641EC57F0>]}
[0m13:26:36.926869 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:26:36.932396 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:26:36.965634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f8b21c0-894d-4b11-8864-ea64e778d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564186AD80>]}
[0m13:26:36.965634 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:26:36.965634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f8b21c0-894d-4b11-8864-ea64e778d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564194F680>]}
[0m13:26:36.965634 [info ] [MainThread]: 
[0m13:26:36.965634 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:26:36.965634 [info ] [MainThread]: 
[0m13:26:36.974688 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:26:36.974688 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m13:26:37.159225 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m13:26:37.174859 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_shop"'
    
  
  
[0m13:26:37.174859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:37.191075 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m13:26:37.191075 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m13:26:37.191075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m13:26:37.191075 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m13:26:37.206811 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:26:37.206811 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_shop'
        and type='sqlite'
    
  
[0m13:26:37.206811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:26:37.206811 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:26:37.206811 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:26:37.206811 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m13:26:37.206811 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:26:37.206811 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:26:37.206811 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m13:26:37.206811 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:26:37.206811 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:26:37.206811 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:26:37.206811 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:26:37.206811 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:26:37.206811 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m13:26:37.206811 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m13:26:37.223526 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:26:37.223526 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m13:26:37.223526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:37.223526 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:26:37.223526 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:26:37.223526 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m13:26:37.239628 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:26:37.239628 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m13:26:37.239628 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m13:26:37.239628 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m13:26:37.239628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f8b21c0-894d-4b11-8864-ea64e778d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256423EB6B0>]}
[0m13:26:37.239628 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:37.239628 [debug] [MainThread]: On master: BEGIN
[0m13:26:37.239628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:37.239628 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:26:37.239628 [debug] [MainThread]: On master: COMMIT
[0m13:26:37.239628 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:37.239628 [debug] [MainThread]: On master: COMMIT
[0m13:26:37.239628 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:26:37.249727 [debug] [MainThread]: On master: Close
[0m13:26:37.254754 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m13:26:37.254754 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m13:26:37.254754 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m13:26:37.254754 [info ] [Thread-1 (]: 1 of 6 START sql view model main.stg_customers ................................. [RUN]
[0m13:26:37.254754 [info ] [Thread-2 (]: 2 of 6 START sql view model main.stg_orders .................................... [RUN]
[0m13:26:37.254754 [info ] [Thread-3 (]: 3 of 6 START sql view model main.stg_payments .................................. [RUN]
[0m13:26:37.254754 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_customers'
[0m13:26:37.254754 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m13:26:37.254754 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_payments'
[0m13:26:37.254754 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m13:26:37.254754 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m13:26:37.254754 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m13:26:37.254754 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:26:37.273089 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:26:37.276630 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m13:26:37.281416 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m13:26:37.297275 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m13:26:37.305585 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:26:37.315064 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m13:26:37.315064 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m13:26:37.322158 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m13:26:37.323240 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:26:37.323240 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:26:37.323240 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m13:26:37.323240 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m13:26:37.323240 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:26:37.323240 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:26:37.323240 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:26:37.323240 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m13:26:37.323240 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:26:37.330469 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:26:37.323240 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:26:37.330469 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:26:37.330469 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:26:37.330469 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:26:37.330469 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    

with customers as (
    select
        id as customer_id,
        first_name,
        last_name,
        email,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_customers"
)

select * from customers
  );

[0m13:26:37.330469 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:26:37.330469 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  
  create view "jaffle_shop"."main"."stg_payments__dbt_tmp" as (
    

with payments as (
    select
        id as payment_id,
        order_id,
        payment_method,
        amount / 100.0 as amount_usd,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_payments"
    where status = 'success'
)

select * from payments
  );

[0m13:26:37.330469 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    

with orders as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status as order_status,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_orders"
)

select * from orders
  );

[0m13:26:37.330469 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:26:37.330469 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:26:37.340702 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:26:37.340702 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:26:37.340702 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:26:37.340702 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:26:37.340702 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:26:37.340702 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter view "jaffle_shop"."main"."stg_payments" rename to "stg_payments__dbt_backup"
[0m13:26:37.340702 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:26:37.340702 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:26:37.340702 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:26:37.354212 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:26:37.354212 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:26:37.354212 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:26:37.354212 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:26:37.354212 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:26:37.354212 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter view "jaffle_shop"."main"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m13:26:37.354212 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:26:37.354212 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:26:37.354212 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:26:37.370709 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m13:26:37.354212 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:26:37.370709 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m13:26:37.370709 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:26:37.385787 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m13:26:37.385787 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:26:37.385787 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m13:26:37.388386 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:26:37.388386 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m13:26:37.388386 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m13:26:37.388386 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:26:37.388386 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:26:37.388386 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."main"."stg_customers__dbt_backup" cascade
[0m13:26:37.401987 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m13:26:37.388386 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m13:26:37.401987 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:26:37.401987 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:26:37.401987 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "jaffle_shop"."main"."stg_payments__dbt_backup" cascade
[0m13:26:37.401987 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:26:37.401987 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m13:26:37.401987 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m13:26:37.401987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f8b21c0-894d-4b11-8864-ea64e778d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256424E5B50>]}
[0m13:26:37.401987 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:26:37.401987 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m13:26:37.401987 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.15s]
[0m13:26:37.401987 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m13:26:37.417701 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f8b21c0-894d-4b11-8864-ea64e778d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564208A2A0>]}
[0m13:26:37.417701 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m13:26:37.417701 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m13:26:37.417701 [info ] [Thread-3 (]: 3 of 6 OK created sql view model main.stg_payments ............................. [[32mOK[0m in 0.16s]
[0m13:26:37.425103 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m13:26:37.423296 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f8b21c0-894d-4b11-8864-ea64e778d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564237AE70>]}
[0m13:26:37.426573 [info ] [Thread-2 (]: 2 of 6 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.17s]
[0m13:26:37.427308 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m13:26:37.429683 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m13:26:37.429683 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m13:26:37.431229 [info ] [Thread-4 (]: 4 of 6 START sql table model main.dim_customers ................................ [RUN]
[0m13:26:37.434366 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.dim_customers'
[0m13:26:37.434366 [info ] [Thread-1 (]: 5 of 6 START sql table model main.fct_orders ................................... [RUN]
[0m13:26:37.434366 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m13:26:37.437486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.fct_orders)
[0m13:26:37.437486 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m13:26:37.437486 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m13:26:37.437486 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m13:26:37.447803 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m13:26:37.447803 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m13:26:37.468850 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m13:26:37.481251 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m13:26:37.482751 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:26:37.482751 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:26:37.482751 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m13:26:37.482751 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m13:26:37.482751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:37.488353 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:26:37.488353 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:26:37.488353 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:26:37.488353 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:26:37.488353 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    
    

    create  table
      "jaffle_shop"."main"."fct_orders__dbt_tmp"
  
    as (
      

with orders as (
    select * from "jaffle_shop"."main"."stg_orders"
),

payments as (
    select
        order_id,
        sum(amount_usd) as total_amount
    from "jaffle_shop"."main"."stg_payments"
    group by order_id
),

final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.order_status,
        coalesce(payments.total_amount, 0) as amount,
        orders.created_at,
        orders.updated_at
    from orders
    left join payments on orders.order_id = payments.order_id
)

select * from final
    );
  
  
[0m13:26:37.488353 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:26:37.488353 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_customers__dbt_tmp"
  
    as (
      

with customers as (
    select * from "jaffle_shop"."main"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders
    from "jaffle_shop"."main"."stg_orders"
    group by customer_id
),

customer_payments as (
    select
        orders.customer_id,
        sum(payments.amount_usd) as lifetime_value
    from "jaffle_shop"."main"."stg_orders" orders
    left join "jaffle_shop"."main"."stg_payments" payments
        on orders.order_id = payments.order_id
    group by orders.customer_id
),

final as (
    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customers.email,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_payments.lifetime_value, 0) as lifetime_value,
        customers.created_at,
        customers.updated_at
    from customers
    left join customer_orders on customers.customer_id = customer_orders.customer_id
    left join customer_payments on customers.customer_id = customer_payments.customer_id
)

select * from final
    );
  
  
[0m13:26:37.497388 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:26:37.497840 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:26:37.497840 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "jaffle_shop"."main"."fct_orders" rename to "fct_orders__dbt_backup"
[0m13:26:37.497840 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m13:26:37.505025 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:26:37.505025 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:26:37.505025 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m13:26:37.505025 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:26:37.505025 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "jaffle_shop"."main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:26:37.505025 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:26:37.512538 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:26:37.512538 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:26:37.520653 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m13:26:37.520653 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:26:37.520653 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:26:37.520653 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m13:26:37.523428 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:26:37.523428 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m13:26:37.523428 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:26:37.523428 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m13:26:37.523428 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:26:37.531155 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:26:37.531155 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m13:26:37.531155 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "jaffle_shop"."main"."fct_orders__dbt_backup" cascade
[0m13:26:37.531155 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:26:37.531155 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."main"."dim_customers__dbt_backup" cascade
[0m13:26:37.539277 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:26:37.539277 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m13:26:37.539277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f8b21c0-894d-4b11-8864-ea64e778d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025642C533B0>]}
[0m13:26:37.539277 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m13:26:37.539277 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.fct_orders .............................. [[32mOK[0m in 0.10s]
[0m13:26:37.539277 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m13:26:37.544797 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m13:26:37.544797 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f8b21c0-894d-4b11-8864-ea64e778d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564194F410>]}
[0m13:26:37.544797 [debug] [Thread-2 (]: Began running node model.jaffle_shop.revenue_by_month
[0m13:26:37.544797 [info ] [Thread-4 (]: 4 of 6 OK created sql table model main.dim_customers ........................... [[32mOK[0m in 0.11s]
[0m13:26:37.544797 [info ] [Thread-2 (]: 6 of 6 START sql table model main.revenue_by_month ............................. [RUN]
[0m13:26:37.549255 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m13:26:37.550274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.revenue_by_month)
[0m13:26:37.551510 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.revenue_by_month
[0m13:26:37.551510 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.revenue_by_month"
[0m13:26:37.551510 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.revenue_by_month
[0m13:26:37.560620 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.revenue_by_month"
[0m13:26:37.564540 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:26:37.567789 [debug] [Thread-2 (]: On model.jaffle_shop.revenue_by_month: BEGIN
[0m13:26:37.567789 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:26:37.567789 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:26:37.567789 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:26:37.567789 [debug] [Thread-2 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */

  
    
    

    create  table
      "jaffle_shop"."main"."revenue_by_month__dbt_tmp"
  
    as (
      

with monthly_revenue as (
    select
        date_trunc('month', order_date) as order_month,
        sum(amount) as monthly_revenue,
        count(distinct order_id) as monthly_orders,
        count(distinct customer_id) as monthly_customers,
        avg(amount) as avg_order_value
    from "jaffle_shop"."main"."fct_orders"
    where order_status not in ('returned', 'cancelled')
    group by date_trunc('month', order_date)
)

select 
    order_month,
    monthly_revenue,
    monthly_orders,
    monthly_customers,
    avg_order_value,
    lag(monthly_revenue) over (order by order_month) as prev_month_revenue,
    (monthly_revenue - lag(monthly_revenue) over (order by order_month)) / 
        lag(monthly_revenue) over (order by order_month) * 100 as revenue_growth_pct
from monthly_revenue
order by order_month
    );
  
  
[0m13:26:37.576379 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m13:26:37.581173 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:26:37.581173 [debug] [Thread-2 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
alter table "jaffle_shop"."main"."revenue_by_month" rename to "revenue_by_month__dbt_backup"
[0m13:26:37.581173 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:26:37.588417 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:26:37.588417 [debug] [Thread-2 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
alter table "jaffle_shop"."main"."revenue_by_month__dbt_tmp" rename to "revenue_by_month"
[0m13:26:37.588417 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:26:37.588417 [debug] [Thread-2 (]: On model.jaffle_shop.revenue_by_month: COMMIT
[0m13:26:37.588417 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:26:37.588417 [debug] [Thread-2 (]: On model.jaffle_shop.revenue_by_month: COMMIT
[0m13:26:37.592510 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:26:37.599245 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:26:37.599245 [debug] [Thread-2 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
drop table if exists "jaffle_shop"."main"."revenue_by_month__dbt_backup" cascade
[0m13:26:37.599245 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:26:37.599245 [debug] [Thread-2 (]: On model.jaffle_shop.revenue_by_month: Close
[0m13:26:37.599245 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f8b21c0-894d-4b11-8864-ea64e778d7eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564237B6E0>]}
[0m13:26:37.599245 [info ] [Thread-2 (]: 6 of 6 OK created sql table model main.revenue_by_month ........................ [[32mOK[0m in 0.05s]
[0m13:26:37.608388 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.revenue_by_month
[0m13:26:37.608388 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:37.608388 [debug] [MainThread]: On master: BEGIN
[0m13:26:37.608388 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:26:37.608388 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:26:37.608388 [debug] [MainThread]: On master: COMMIT
[0m13:26:37.608388 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:37.608388 [debug] [MainThread]: On master: COMMIT
[0m13:26:37.614638 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:26:37.614638 [debug] [MainThread]: On master: Close
[0m13:26:37.614638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:37.614638 [debug] [MainThread]: Connection 'create_jaffle_shop_main' was properly closed.
[0m13:26:37.614638 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m13:26:37.614638 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m13:26:37.616754 [debug] [MainThread]: Connection 'model.jaffle_shop.revenue_by_month' was properly closed.
[0m13:26:37.616754 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m13:26:37.616754 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m13:26:37.616754 [info ] [MainThread]: 
[0m13:26:37.616754 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m13:26:37.616754 [debug] [MainThread]: Command end result
[0m13:26:37.641706 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:26:37.647768 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:26:37.651124 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:26:37.651124 [info ] [MainThread]: 
[0m13:26:37.651124 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:26:37.663130 [info ] [MainThread]: 
[0m13:26:37.664261 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:26:37.665906 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 13:26:37.665906 after 2.03 seconds
[0m13:26:37.665906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002563FA50DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025640422DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025640EBBBF0>]}
[0m13:26:37.665906 [debug] [MainThread]: Flushing usage events
[0m13:26:37.800054 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:44.676418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212349B3B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212349B2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212349B3350>]}


============================== 13:26:44.676418 | 85664aa1-0b5d-4679-9fba-499af9f22a6b ==============================
[0m13:26:44.676418 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:26:44.692063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:26:44.970845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85664aa1-0b5d-4679-9fba-499af9f22a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021235597E00>]}
[0m13:26:45.034573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85664aa1-0b5d-4679-9fba-499af9f22a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021233D7E090>]}
[0m13:26:45.050178 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:26:45.448278 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:26:45.622683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:45.622683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:45.654025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85664aa1-0b5d-4679-9fba-499af9f22a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021235B2A7B0>]}
[0m13:26:45.717053 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:26:45.721150 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:26:45.764850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85664aa1-0b5d-4679-9fba-499af9f22a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021236573FB0>]}
[0m13:26:45.764850 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:26:45.764850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85664aa1-0b5d-4679-9fba-499af9f22a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021236487FB0>]}
[0m13:26:45.764850 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:26:45.764850 [debug] [MainThread]: Command end result
[0m13:26:45.805224 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:26:45.810446 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:26:45.810446 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:26:45.810446 [debug] [MainThread]: Command `python -m dbt.cli.main test` succeeded at 13:26:45.810446 after 1.33 seconds
[0m13:26:45.810446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021235056780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021233DA61B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021233DA6540>]}
[0m13:26:45.810446 [debug] [MainThread]: Flushing usage events
[0m13:26:45.972368 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:08.140364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022820028F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022823F6F200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022823F6ED50>]}


============================== 13:27:08.140364 | e76d37fb-a638-405c-a8b4-361ca6391d90 ==============================
[0m13:27:08.140364 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:27:08.140364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m13:27:08.446978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e76d37fb-a638-405c-a8b4-361ca6391d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228248A38F0>]}
[0m13:27:08.511134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e76d37fb-a638-405c-a8b4-361ca6391d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228226C3EC0>]}
[0m13:27:08.523068 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:27:08.922044 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:27:09.105967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:27:09.105967 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:27:09.141249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e76d37fb-a638-405c-a8b4-361ca6391d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022824844AD0>]}
[0m13:27:09.185123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e76d37fb-a638-405c-a8b4-361ca6391d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002282508ECC0>]}
[0m13:27:09.185123 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:27:09.185123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e76d37fb-a638-405c-a8b4-361ca6391d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022824F602F0>]}
[0m13:27:09.185123 [info ] [MainThread]: 
[0m13:27:09.185123 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:27:09.185123 [info ] [MainThread]: 
[0m13:27:09.185123 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:27:09.185123 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m13:27:09.368219 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:27:09.368219 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m13:27:09.368219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:09.401752 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m13:27:09.402308 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:27:09.402308 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m13:27:09.418829 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:27:09.418829 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m13:27:09.418829 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m13:27:09.418829 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m13:27:09.418829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e76d37fb-a638-405c-a8b4-361ca6391d90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228249021E0>]}
[0m13:27:09.431337 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m13:27:09.431337 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m13:27:09.431337 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m13:27:09.431337 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_customers'
[0m13:27:09.431337 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_orders'
[0m13:27:09.431337 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_payments'
[0m13:27:09.431337 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m13:27:09.431337 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m13:27:09.431337 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m13:27:09.441860 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m13:27:09.441860 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m13:27:09.447367 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m13:27:09.447367 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m13:27:09.447367 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m13:27:09.447367 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m13:27:09.447367 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_payments
[0m13:27:09.447367 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_customers
[0m13:27:09.447367 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_payments'
[0m13:27:09.447367 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_orders
[0m13:27:09.447367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_orders, now model.jaffle_shop.stg_customers)
[0m13:27:09.447367 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_payments
[0m13:27:09.447367 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_payments, now model.jaffle_shop.stg_orders)
[0m13:27:09.447367 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_customers
[0m13:27:09.447367 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m13:27:09.447367 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_orders
[0m13:27:09.447367 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:27:09.463003 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:27:09.464308 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_payments
[0m13:27:09.464308 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_customers
[0m13:27:09.464308 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_orders
[0m13:27:09.464308 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_payments
[0m13:27:09.464308 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_customers
[0m13:27:09.464308 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_orders
[0m13:27:09.464308 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m13:27:09.464308 [debug] [Thread-4 (]: Began running node model.jaffle_shop.fct_orders
[0m13:27:09.464308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_customers, now model.jaffle_shop.dim_customers)
[0m13:27:09.464308 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.fct_orders)
[0m13:27:09.471606 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m13:27:09.471606 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.fct_orders
[0m13:27:09.471606 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m13:27:09.471606 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m13:27:09.479113 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m13:27:09.479113 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m13:27:09.479113 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.fct_orders
[0m13:27:09.479113 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.fct_orders
[0m13:27:09.479113 [debug] [Thread-3 (]: Began running node model.jaffle_shop.revenue_by_month
[0m13:27:09.479113 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.revenue_by_month)
[0m13:27:09.479113 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.revenue_by_month
[0m13:27:09.479113 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.revenue_by_month"
[0m13:27:09.479113 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.revenue_by_month
[0m13:27:09.479113 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.revenue_by_month
[0m13:27:09.479113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:09.479113 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m13:27:09.479113 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m13:27:09.479113 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m13:27:09.479113 [debug] [MainThread]: Connection 'model.jaffle_shop.revenue_by_month' was properly closed.
[0m13:27:09.479113 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m13:27:09.479113 [debug] [MainThread]: Command end result
[0m13:27:09.542248 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:27:09.558317 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:27:09.567144 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:27:09.567144 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m13:27:09.567144 [info ] [MainThread]: Building catalog
[0m13:27:09.584779 [debug] [ThreadPool]: Acquiring new duckdb connection 'jaffle_shop.information_schema'
[0m13:27:09.585696 [debug] [ThreadPool]: Using duckdb connection "jaffle_shop.information_schema"
[0m13:27:09.585696 [debug] [ThreadPool]: On jaffle_shop.information_schema: BEGIN
[0m13:27:09.585696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:09.585696 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:27:09.585696 [debug] [ThreadPool]: Using duckdb connection "jaffle_shop.information_schema"
[0m13:27:09.585696 [debug] [ThreadPool]: On jaffle_shop.information_schema: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "jaffle_shop.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'jaffle_shop'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'jaffle_shop'
    )
    select
        'jaffle_shop' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m13:27:09.602096 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m13:27:09.602096 [debug] [ThreadPool]: On jaffle_shop.information_schema: ROLLBACK
[0m13:27:09.602096 [debug] [ThreadPool]: Failed to rollback 'jaffle_shop.information_schema'
[0m13:27:09.602096 [debug] [ThreadPool]: On jaffle_shop.information_schema: Close
[0m13:27:09.619372 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\KBHATIA\jaffle_shop\target\catalog.json
[0m13:27:09.646684 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:27:09.650472 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:27:09.650472 [info ] [MainThread]: Catalog written to C:\Users\KBHATIA\jaffle_shop\target\catalog.json
[0m13:27:09.655076 [debug] [MainThread]: Command `python -m dbt.cli.main docs generate` succeeded at 13:27:09.655076 after 1.69 seconds
[0m13:27:09.655076 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:27:09.655076 [debug] [MainThread]: Connection 'jaffle_shop.information_schema' was properly closed.
[0m13:27:09.655076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022823EED250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228239B7E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022823E532C0>]}
[0m13:27:09.655076 [debug] [MainThread]: Flushing usage events
[0m13:27:09.781992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:32.197542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021430FB3B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214314BFD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214315B0320>]}


============================== 13:27:32.203628 | a3221cd6-65f7-4db4-8c23-becdff056568 ==============================
[0m13:27:32.203628 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:27:32.204635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:27:32.517008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3221cd6-65f7-4db4-8c23-becdff056568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002143196AE10>]}
[0m13:27:32.575774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3221cd6-65f7-4db4-8c23-becdff056568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214318F9250>]}
[0m13:27:32.581876 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:27:33.009176 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:27:33.180643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:27:33.181564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:27:33.214655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3221cd6-65f7-4db4-8c23-becdff056568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021431950E90>]}
[0m13:27:33.293378 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:27:33.297378 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:27:33.333431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3221cd6-65f7-4db4-8c23-becdff056568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002143196B320>]}
[0m13:27:33.333431 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:27:33.334433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3221cd6-65f7-4db4-8c23-becdff056568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021432564410>]}
[0m13:27:33.336516 [info ] [MainThread]: 
[0m13:27:33.337931 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:27:33.337931 [info ] [MainThread]: 
[0m13:27:33.339107 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:27:33.346118 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m13:27:33.533737 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m13:27:33.533737 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_shop"'
    
  
  
[0m13:27:33.533737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:33.555201 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m13:27:33.557202 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m13:27:33.558146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m13:27:33.558146 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m13:27:33.564249 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:27:33.564249 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_shop'
        and type='sqlite'
    
  
[0m13:27:33.564249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:33.565331 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:27:33.566283 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:27:33.567330 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m13:27:33.567330 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:27:33.568300 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:27:33.568300 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m13:27:33.568300 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:27:33.569284 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:27:33.570249 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:27:33.570249 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:27:33.571249 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:27:33.571249 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m13:27:33.573282 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m13:27:33.577938 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:27:33.579041 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m13:27:33.579041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:33.579041 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:27:33.579951 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:27:33.579951 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m13:27:33.594978 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:27:33.596032 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m13:27:33.597948 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m13:27:33.597948 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m13:27:33.599950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3221cd6-65f7-4db4-8c23-becdff056568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214324C8110>]}
[0m13:27:33.600949 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:33.601955 [debug] [MainThread]: On master: BEGIN
[0m13:27:33.601955 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:33.603954 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:27:33.603954 [debug] [MainThread]: On master: COMMIT
[0m13:27:33.604963 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:33.604963 [debug] [MainThread]: On master: COMMIT
[0m13:27:33.605962 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:27:33.605962 [debug] [MainThread]: On master: Close
[0m13:27:33.613963 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m13:27:33.614967 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m13:27:33.614967 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m13:27:33.615963 [info ] [Thread-1 (]: 1 of 6 START sql view model main.stg_customers ................................. [RUN]
[0m13:27:33.616962 [info ] [Thread-2 (]: 2 of 6 START sql view model main.stg_orders .................................... [RUN]
[0m13:27:33.618962 [info ] [Thread-3 (]: 3 of 6 START sql view model main.stg_payments .................................. [RUN]
[0m13:27:33.620204 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_customers'
[0m13:27:33.620204 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m13:27:33.621064 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_payments'
[0m13:27:33.621607 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m13:27:33.622020 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m13:27:33.622422 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m13:27:33.628524 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:27:33.632533 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:27:33.636434 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m13:27:33.639430 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m13:27:33.640433 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m13:27:33.641544 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m13:27:33.674171 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:27:33.677584 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m13:27:33.682591 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m13:27:33.686590 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:27:33.687589 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:27:33.687589 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:27:33.688418 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m13:27:33.688812 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m13:27:33.689444 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m13:27:33.689989 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:27:33.689989 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:27:33.691010 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:27:33.692006 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:27:33.692006 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:27:33.693033 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:27:33.693033 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:27:33.694007 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:27:33.694007 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    

with orders as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status as order_status,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_orders"
)

select * from orders
  );

[0m13:27:33.695008 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:27:33.695008 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    

with customers as (
    select
        id as customer_id,
        first_name,
        last_name,
        email,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_customers"
)

select * from customers
  );

[0m13:27:33.696008 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  
  create view "jaffle_shop"."main"."stg_payments__dbt_tmp" as (
    

with payments as (
    select
        id as payment_id,
        order_id,
        payment_method,
        amount / 100.0 as amount_usd,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_payments"
    where status = 'success'
)

select * from payments
  );

[0m13:27:33.697007 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:27:33.697007 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:27:33.703026 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:27:33.704007 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m13:27:33.706012 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:27:33.707080 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:27:33.710803 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:27:33.710803 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:27:33.711890 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter view "jaffle_shop"."main"."stg_payments" rename to "stg_payments__dbt_backup"
[0m13:27:33.712858 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:27:33.715890 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:27:33.716895 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:27:33.716895 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:27:33.717853 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:27:33.720609 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:27:33.722600 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:27:33.723582 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter view "jaffle_shop"."main"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m13:27:33.724595 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:27:33.724807 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:27:33.736290 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m13:27:33.736290 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m13:27:33.737287 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:27:33.737287 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:27:33.739572 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m13:27:33.739572 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m13:27:33.741572 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m13:27:33.741943 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:27:33.742587 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:27:33.742587 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m13:27:33.743594 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m13:27:33.747592 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:27:33.752599 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:27:33.753600 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m13:27:33.753600 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m13:27:33.754723 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m13:27:33.755817 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:27:33.759343 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:27:33.760343 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."main"."stg_customers__dbt_backup" cascade
[0m13:27:33.760343 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "jaffle_shop"."main"."stg_payments__dbt_backup" cascade
[0m13:27:33.763388 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:27:33.766385 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m13:27:33.766385 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:27:33.770372 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m13:27:33.770372 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m13:27:33.772374 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m13:27:33.773861 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3221cd6-65f7-4db4-8c23-becdff056568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021432CBE900>]}
[0m13:27:33.773861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3221cd6-65f7-4db4-8c23-becdff056568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021432CD9D60>]}
[0m13:27:33.774907 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3221cd6-65f7-4db4-8c23-becdff056568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021432CBFA10>]}
[0m13:27:33.775338 [info ] [Thread-2 (]: 2 of 6 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.15s]
[0m13:27:33.775955 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.15s]
[0m13:27:33.777962 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m13:27:33.776966 [info ] [Thread-3 (]: 3 of 6 OK created sql view model main.stg_payments ............................. [[32mOK[0m in 0.15s]
[0m13:27:33.777962 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m13:27:33.779438 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m13:27:33.780436 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m13:27:33.780436 [debug] [Thread-2 (]: Began running node model.jaffle_shop.fct_orders
[0m13:27:33.781442 [info ] [Thread-4 (]: 4 of 6 START sql table model main.dim_customers ................................ [RUN]
[0m13:27:33.782440 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.dim_customers'
[0m13:27:33.781442 [info ] [Thread-2 (]: 5 of 6 START sql table model main.fct_orders ................................... [RUN]
[0m13:27:33.783442 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m13:27:33.783442 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.fct_orders)
[0m13:27:33.789447 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m13:27:33.790438 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.fct_orders
[0m13:27:33.793528 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m13:27:33.795438 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m13:27:33.795438 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.fct_orders
[0m13:27:33.825472 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m13:27:33.828458 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m13:27:33.832521 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:27:33.834538 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:27:33.834538 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m13:27:33.835560 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m13:27:33.836517 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:27:33.836517 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:27:33.838518 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:27:33.838518 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:27:33.839281 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:27:33.839281 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:27:33.840290 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_customers__dbt_tmp"
  
    as (
      

with customers as (
    select * from "jaffle_shop"."main"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders
    from "jaffle_shop"."main"."stg_orders"
    group by customer_id
),

customer_payments as (
    select
        orders.customer_id,
        sum(payments.amount_usd) as lifetime_value
    from "jaffle_shop"."main"."stg_orders" orders
    left join "jaffle_shop"."main"."stg_payments" payments
        on orders.order_id = payments.order_id
    group by orders.customer_id
),

final as (
    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customers.email,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_payments.lifetime_value, 0) as lifetime_value,
        customers.created_at,
        customers.updated_at
    from customers
    left join customer_orders on customers.customer_id = customer_orders.customer_id
    left join customer_payments on customers.customer_id = customer_payments.customer_id
)

select * from final
    );
  
  
[0m13:27:33.840290 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    
    

    create  table
      "jaffle_shop"."main"."fct_orders__dbt_tmp"
  
    as (
      

with orders as (
    select * from "jaffle_shop"."main"."stg_orders"
),

payments as (
    select
        order_id,
        sum(amount_usd) as total_amount
    from "jaffle_shop"."main"."stg_payments"
    group by order_id
),

final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.order_status,
        coalesce(payments.total_amount, 0) as amount,
        orders.created_at,
        orders.updated_at
    from orders
    left join payments on orders.order_id = payments.order_id
)

select * from final
    );
  
  
[0m13:27:33.846292 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:27:33.850345 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:27:33.851296 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "jaffle_shop"."main"."fct_orders" rename to "fct_orders__dbt_backup"
[0m13:27:33.851296 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m13:27:33.852291 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:27:33.855294 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:27:33.858310 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:27:33.859388 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m13:27:33.859920 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "jaffle_shop"."main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:27:33.860933 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:27:33.860933 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:27:33.865951 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:27:33.872196 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m13:27:33.873187 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:27:33.873673 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:27:33.874232 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m13:27:33.874232 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:27:33.876240 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m13:27:33.877268 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:27:33.877268 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m13:27:33.879364 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:27:33.883367 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:27:33.883367 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m13:27:33.884416 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "jaffle_shop"."main"."fct_orders__dbt_backup" cascade
[0m13:27:33.887369 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:27:33.887369 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."main"."dim_customers__dbt_backup" cascade
[0m13:27:33.891242 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:27:33.893301 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: Close
[0m13:27:33.894294 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3221cd6-65f7-4db4-8c23-becdff056568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021432D7EBA0>]}
[0m13:27:33.894294 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m13:27:33.895262 [info ] [Thread-2 (]: 5 of 6 OK created sql table model main.fct_orders .............................. [[32mOK[0m in 0.11s]
[0m13:27:33.897267 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m13:27:33.898264 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.fct_orders
[0m13:27:33.899041 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3221cd6-65f7-4db4-8c23-becdff056568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021432B79EB0>]}
[0m13:27:33.901049 [debug] [Thread-3 (]: Began running node model.jaffle_shop.revenue_by_month
[0m13:27:33.900131 [info ] [Thread-4 (]: 4 of 6 OK created sql table model main.dim_customers ........................... [[32mOK[0m in 0.12s]
[0m13:27:33.901049 [info ] [Thread-3 (]: 6 of 6 START sql table model main.revenue_by_month ............................. [RUN]
[0m13:27:33.902050 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m13:27:33.903120 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.revenue_by_month)
[0m13:27:33.904052 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.revenue_by_month
[0m13:27:33.909057 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.revenue_by_month"
[0m13:27:33.912059 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.revenue_by_month
[0m13:27:33.917069 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.revenue_by_month"
[0m13:27:33.921341 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:27:33.921341 [debug] [Thread-3 (]: On model.jaffle_shop.revenue_by_month: BEGIN
[0m13:27:33.922433 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:27:33.922433 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:27:33.923385 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:27:33.923385 [debug] [Thread-3 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */

  
    
    

    create  table
      "jaffle_shop"."main"."revenue_by_month__dbt_tmp"
  
    as (
      

with monthly_revenue as (
    select
        date_trunc('month', order_date) as order_month,
        sum(amount) as monthly_revenue,
        count(distinct order_id) as monthly_orders,
        count(distinct customer_id) as monthly_customers,
        avg(amount) as avg_order_value
    from "jaffle_shop"."main"."fct_orders"
    where order_status not in ('returned', 'cancelled')
    group by date_trunc('month', order_date)
)

select 
    order_month,
    monthly_revenue,
    monthly_orders,
    monthly_customers,
    avg_order_value,
    lag(monthly_revenue) over (order by order_month) as prev_month_revenue,
    (monthly_revenue - lag(monthly_revenue) over (order by order_month)) / 
        lag(monthly_revenue) over (order by order_month) * 100 as revenue_growth_pct
from monthly_revenue
order by order_month
    );
  
  
[0m13:27:33.934074 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m13:27:33.938587 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:27:33.939587 [debug] [Thread-3 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
alter table "jaffle_shop"."main"."revenue_by_month" rename to "revenue_by_month__dbt_backup"
[0m13:27:33.939587 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:27:33.942587 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:27:33.943593 [debug] [Thread-3 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
alter table "jaffle_shop"."main"."revenue_by_month__dbt_tmp" rename to "revenue_by_month"
[0m13:27:33.943593 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:27:33.945592 [debug] [Thread-3 (]: On model.jaffle_shop.revenue_by_month: COMMIT
[0m13:27:33.946592 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:27:33.946592 [debug] [Thread-3 (]: On model.jaffle_shop.revenue_by_month: COMMIT
[0m13:27:33.950675 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:27:33.953594 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:27:33.954600 [debug] [Thread-3 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
drop table if exists "jaffle_shop"."main"."revenue_by_month__dbt_backup" cascade
[0m13:27:33.957897 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:27:33.959941 [debug] [Thread-3 (]: On model.jaffle_shop.revenue_by_month: Close
[0m13:27:33.959941 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3221cd6-65f7-4db4-8c23-becdff056568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021432B7AEA0>]}
[0m13:27:33.960935 [info ] [Thread-3 (]: 6 of 6 OK created sql table model main.revenue_by_month ........................ [[32mOK[0m in 0.06s]
[0m13:27:33.962959 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.revenue_by_month
[0m13:27:33.964965 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:33.964965 [debug] [MainThread]: On master: BEGIN
[0m13:27:33.965965 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:27:33.965965 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:27:33.966983 [debug] [MainThread]: On master: COMMIT
[0m13:27:33.966983 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:33.966983 [debug] [MainThread]: On master: COMMIT
[0m13:27:33.967964 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:27:33.967964 [debug] [MainThread]: On master: Close
[0m13:27:33.968964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:33.968964 [debug] [MainThread]: Connection 'create_jaffle_shop_main' was properly closed.
[0m13:27:33.968964 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m13:27:33.968964 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m13:27:33.969964 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m13:27:33.969964 [debug] [MainThread]: Connection 'model.jaffle_shop.revenue_by_month' was properly closed.
[0m13:27:33.969964 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m13:27:33.969964 [info ] [MainThread]: 
[0m13:27:33.970964 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m13:27:33.972966 [debug] [MainThread]: Command end result
[0m13:27:34.003518 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:27:34.012527 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:27:34.021744 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:27:34.022780 [info ] [MainThread]: 
[0m13:27:34.022780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:27:34.023775 [info ] [MainThread]: 
[0m13:27:34.023775 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:27:34.025774 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 13:27:34.025774 after 2.01 seconds
[0m13:27:34.026772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021431E69E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021430F60FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214324C8110>]}
[0m13:27:34.026772 [debug] [MainThread]: Flushing usage events
[0m13:27:35.115355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:30:35.135557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509AD4ECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250970257F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025099C19670>]}


============================== 13:30:35.140895 | b936b777-e059-423e-8a89-1648b2e438d3 ==============================
[0m13:30:35.140895 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:30:35.140895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:30:35.461189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b936b777-e059-423e-8a89-1648b2e438d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509B76A6C0>]}
[0m13:30:35.565353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b936b777-e059-423e-8a89-1648b2e438d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509B620DA0>]}
[0m13:30:35.580512 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:30:36.055593 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:30:36.250310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:30:36.255408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:30:36.294528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b936b777-e059-423e-8a89-1648b2e438d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509BA4EF30>]}
[0m13:30:36.360110 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:30:36.360110 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:30:36.400029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b936b777-e059-423e-8a89-1648b2e438d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509BE642F0>]}
[0m13:30:36.400029 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:30:36.400029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b936b777-e059-423e-8a89-1648b2e438d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509B651430>]}
[0m13:30:36.406055 [info ] [MainThread]: 
[0m13:30:36.406055 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:30:36.406055 [info ] [MainThread]: 
[0m13:30:36.406055 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:30:36.420588 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m13:30:36.660642 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m13:30:36.660642 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_shop"'
    
  
  
[0m13:30:36.660642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:36.680687 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m13:30:36.680687 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m13:30:36.680687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m13:30:36.680687 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m13:30:36.690348 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:30:36.690348 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_shop'
        and type='sqlite'
    
  
[0m13:30:36.690348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:36.690348 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:30:36.690348 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:30:36.690348 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m13:30:36.690348 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:30:36.690348 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:30:36.690348 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m13:30:36.690348 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:30:36.690348 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:30:36.690348 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:30:36.690348 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:30:36.690348 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:30:36.690348 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m13:30:36.700335 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m13:30:36.710502 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:30:36.710502 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m13:30:36.710502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:36.710502 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:30:36.710502 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:30:36.710502 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m13:30:36.725062 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:30:36.730183 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m13:30:36.730183 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m13:30:36.730183 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m13:30:36.735190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b936b777-e059-423e-8a89-1648b2e438d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025097321FA0>]}
[0m13:30:36.735190 [debug] [MainThread]: Using duckdb connection "master"
[0m13:30:36.735190 [debug] [MainThread]: On master: BEGIN
[0m13:30:36.735190 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:30:36.735190 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:30:36.735190 [debug] [MainThread]: On master: COMMIT
[0m13:30:36.735190 [debug] [MainThread]: Using duckdb connection "master"
[0m13:30:36.735190 [debug] [MainThread]: On master: COMMIT
[0m13:30:36.735190 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:30:36.735190 [debug] [MainThread]: On master: Close
[0m13:30:36.740276 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m13:30:36.740276 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m13:30:36.750254 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m13:30:36.750254 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m13:30:36.751262 [info ] [Thread-2 (]: 2 of 3 START sql view model main.stg_orders .................................... [RUN]
[0m13:30:36.751262 [info ] [Thread-3 (]: 3 of 3 START sql view model main.stg_payments .................................. [RUN]
[0m13:30:36.751262 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_customers'
[0m13:30:36.751262 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m13:30:36.751262 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_payments'
[0m13:30:36.751262 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m13:30:36.751262 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m13:30:36.751262 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m13:30:36.760414 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:30:36.770160 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:30:36.775069 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m13:30:36.775069 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m13:30:36.775069 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m13:30:36.775069 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m13:30:36.820113 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m13:30:36.820113 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:30:36.820113 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m13:30:36.827996 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:30:36.830067 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:30:36.830067 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:30:36.830067 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m13:30:36.830067 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m13:30:36.830067 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m13:30:36.833133 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:30:36.833669 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:30:36.834110 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:30:36.834733 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:30:36.834733 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:30:36.836343 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:30:36.836343 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:30:36.836343 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:30:36.836343 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    

with customers as (
    select
        id as customer_id,
        first_name,
        last_name,
        email,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_customers"
)

select * from customers
  );

[0m13:30:36.838476 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:30:36.838476 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    

with orders as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status as order_status,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_orders"
)

select * from orders
  );

[0m13:30:36.840247 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  
  create view "jaffle_shop"."main"."stg_payments__dbt_tmp" as (
    

with payments as (
    select
        id as payment_id,
        order_id,
        payment_method,
        amount / 100.0 as amount_usd,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_payments"
    where status = 'success'
)

select * from payments
  );

[0m13:30:36.840247 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:30:36.840247 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:30:36.840247 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:30:36.847083 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:30:36.850228 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:30:36.853315 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:30:36.853315 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:30:36.853315 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:30:36.853315 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter view "jaffle_shop"."main"."stg_payments" rename to "stg_payments__dbt_backup"
[0m13:30:36.853315 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:30:36.853315 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:30:36.860642 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:30:36.861652 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:30:36.861652 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:30:36.870502 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:30:36.870502 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:30:36.870502 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:30:36.870502 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter view "jaffle_shop"."main"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m13:30:36.870502 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:30:36.875008 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:30:36.886363 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m13:30:36.886363 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m13:30:36.886363 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m13:30:36.890388 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:30:36.890388 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m13:30:36.890388 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:30:36.890388 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m13:30:36.890388 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:30:36.890388 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m13:30:36.897127 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m13:30:36.902358 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:30:36.902358 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:30:36.902358 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."main"."stg_customers__dbt_backup" cascade
[0m13:30:36.910498 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m13:30:36.910498 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m13:30:36.910498 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:30:36.910498 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:30:36.910498 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "jaffle_shop"."main"."stg_payments__dbt_backup" cascade
[0m13:30:36.910498 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:30:36.910498 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m13:30:36.920265 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m13:30:36.920486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b936b777-e059-423e-8a89-1648b2e438d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509B6A2570>]}
[0m13:30:36.920486 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m13:30:36.920486 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.17s]
[0m13:30:36.920486 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m13:30:36.920486 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m13:30:36.920486 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m13:30:36.920486 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b936b777-e059-423e-8a89-1648b2e438d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509C476FF0>]}
[0m13:30:36.930400 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m13:30:36.930400 [info ] [Thread-3 (]: 3 of 3 OK created sql view model main.stg_payments ............................. [[32mOK[0m in 0.17s]
[0m13:30:36.930400 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b936b777-e059-423e-8a89-1648b2e438d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509C476F90>]}
[0m13:30:36.933909 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m13:30:36.935770 [info ] [Thread-2 (]: 2 of 3 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.18s]
[0m13:30:36.936598 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m13:30:36.936598 [debug] [MainThread]: Using duckdb connection "master"
[0m13:30:36.940005 [debug] [MainThread]: On master: BEGIN
[0m13:30:36.940005 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:30:36.940005 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:30:36.940005 [debug] [MainThread]: On master: COMMIT
[0m13:30:36.940005 [debug] [MainThread]: Using duckdb connection "master"
[0m13:30:36.944621 [debug] [MainThread]: On master: COMMIT
[0m13:30:36.944621 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:30:36.944621 [debug] [MainThread]: On master: Close
[0m13:30:36.944621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:36.944621 [debug] [MainThread]: Connection 'create_jaffle_shop_main' was properly closed.
[0m13:30:36.944621 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m13:30:36.944621 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m13:30:36.944621 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m13:30:36.944621 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m13:30:36.947838 [info ] [MainThread]: 
[0m13:30:36.948999 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m13:30:36.950010 [debug] [MainThread]: Command end result
[0m13:30:36.975293 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:30:36.980134 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:30:36.990273 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:30:36.990273 [info ] [MainThread]: 
[0m13:30:36.990273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:36.990273 [info ] [MainThread]: 
[0m13:30:36.995303 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:30:36.997771 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 13:30:36.997771 after 2.06 seconds
[0m13:30:36.997771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509A56D580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509AC57CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509AFD25A0>]}
[0m13:30:36.999549 [debug] [MainThread]: Flushing usage events
[0m13:30:38.206860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:10.940496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200AF1CB5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200ACA311C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200AF19D3A0>]}


============================== 13:31:10.940496 | 9dc31a9a-a095-4a34-aae6-c16fa0d8c7bb ==============================
[0m13:31:10.940496 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:31:10.950261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:core', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:31:11.280287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dc31a9a-a095-4a34-aae6-c16fa0d8c7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200AE92C770>]}
[0m13:31:11.345367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dc31a9a-a095-4a34-aae6-c16fa0d8c7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200AE9D05C0>]}
[0m13:31:11.350547 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:31:11.800040 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:31:11.994919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:31:11.994919 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:31:12.035104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dc31a9a-a095-4a34-aae6-c16fa0d8c7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B016F1D0>]}
[0m13:31:12.100236 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:31:12.100236 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:31:12.140275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dc31a9a-a095-4a34-aae6-c16fa0d8c7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B01C1DF0>]}
[0m13:31:12.140275 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:31:12.140275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dc31a9a-a095-4a34-aae6-c16fa0d8c7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B0B5F920>]}
[0m13:31:12.140275 [info ] [MainThread]: 
[0m13:31:12.140275 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:31:12.140275 [info ] [MainThread]: 
[0m13:31:12.140275 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:31:12.150555 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m13:31:12.351266 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m13:31:12.351266 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_shop"'
    
  
  
[0m13:31:12.351266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:12.370316 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m13:31:12.370316 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m13:31:12.376906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m13:31:12.376906 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m13:31:12.380037 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:31:12.380037 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_shop'
        and type='sqlite'
    
  
[0m13:31:12.380037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:12.380037 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:31:12.385044 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:31:12.385044 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m13:31:12.385044 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:31:12.385044 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:31:12.385044 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m13:31:12.385044 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:31:12.385044 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:31:12.385044 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:31:12.385044 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:31:12.385044 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:31:12.385044 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m13:31:12.392652 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m13:31:12.398215 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:31:12.400229 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m13:31:12.400337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:12.400337 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:31:12.400337 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:31:12.400337 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m13:31:12.416160 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:31:12.416160 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m13:31:12.420285 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m13:31:12.420285 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m13:31:12.420285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dc31a9a-a095-4a34-aae6-c16fa0d8c7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B0652270>]}
[0m13:31:12.420285 [debug] [MainThread]: Using duckdb connection "master"
[0m13:31:12.420285 [debug] [MainThread]: On master: BEGIN
[0m13:31:12.420285 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:12.420285 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:31:12.420285 [debug] [MainThread]: On master: COMMIT
[0m13:31:12.420285 [debug] [MainThread]: Using duckdb connection "master"
[0m13:31:12.420285 [debug] [MainThread]: On master: COMMIT
[0m13:31:12.420285 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:31:12.420285 [debug] [MainThread]: On master: Close
[0m13:31:12.432125 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m13:31:12.432125 [debug] [Thread-2 (]: Began running node model.jaffle_shop.fct_orders
[0m13:31:12.432125 [info ] [Thread-1 (]: 1 of 2 START sql table model main.dim_customers ................................ [RUN]
[0m13:31:12.432125 [info ] [Thread-2 (]: 2 of 2 START sql table model main.fct_orders ................................... [RUN]
[0m13:31:12.436539 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_shop.dim_customers'
[0m13:31:12.437699 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.fct_orders'
[0m13:31:12.437699 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m13:31:12.437699 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.fct_orders
[0m13:31:12.442723 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m13:31:12.450114 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m13:31:12.450114 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m13:31:12.450114 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.fct_orders
[0m13:31:12.490193 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m13:31:12.495516 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m13:31:12.502314 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:31:12.502314 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:31:12.502314 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m13:31:12.502314 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m13:31:12.502314 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:31:12.502314 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:31:12.507323 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:31:12.507323 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:31:12.507323 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:31:12.507323 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:31:12.507323 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_customers__dbt_tmp"
  
    as (
      

with customers as (
    select * from "jaffle_shop"."main"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders
    from "jaffle_shop"."main"."stg_orders"
    group by customer_id
),

customer_payments as (
    select
        orders.customer_id,
        sum(payments.amount_usd) as lifetime_value
    from "jaffle_shop"."main"."stg_orders" orders
    left join "jaffle_shop"."main"."stg_payments" payments
        on orders.order_id = payments.order_id
    group by orders.customer_id
),

final as (
    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customers.email,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_payments.lifetime_value, 0) as lifetime_value,
        customers.created_at,
        customers.updated_at
    from customers
    left join customer_orders on customers.customer_id = customer_orders.customer_id
    left join customer_payments on customers.customer_id = customer_payments.customer_id
)

select * from final
    );
  
  
[0m13:31:12.507323 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    
    

    create  table
      "jaffle_shop"."main"."fct_orders__dbt_tmp"
  
    as (
      

with orders as (
    select * from "jaffle_shop"."main"."stg_orders"
),

payments as (
    select
        order_id,
        sum(amount_usd) as total_amount
    from "jaffle_shop"."main"."stg_payments"
    group by order_id
),

final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.order_status,
        coalesce(payments.total_amount, 0) as amount,
        orders.created_at,
        orders.updated_at
    from orders
    left join payments on orders.order_id = payments.order_id
)

select * from final
    );
  
  
[0m13:31:12.510473 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:31:12.520114 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:31:12.524635 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m13:31:12.524635 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "jaffle_shop"."main"."fct_orders" rename to "fct_orders__dbt_backup"
[0m13:31:12.524635 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:31:12.524635 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m13:31:12.524635 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:31:12.530141 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:31:12.532157 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:31:12.532157 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "jaffle_shop"."main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:31:12.534727 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:31:12.534727 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:31:12.534727 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:31:12.550500 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m13:31:12.550500 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m13:31:12.550500 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m13:31:12.556529 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:31:12.556656 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:31:12.556656 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m13:31:12.556656 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m13:31:12.560162 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:31:12.570137 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:31:12.570644 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m13:31:12.571095 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "jaffle_shop"."main"."fct_orders__dbt_backup" cascade
[0m13:31:12.571095 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:31:12.571095 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."main"."dim_customers__dbt_backup" cascade
[0m13:31:12.571095 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:31:12.571095 [debug] [Thread-2 (]: On model.jaffle_shop.fct_orders: Close
[0m13:31:12.580441 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m13:31:12.584244 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m13:31:12.584244 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dc31a9a-a095-4a34-aae6-c16fa0d8c7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B0FE5910>]}
[0m13:31:12.584244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dc31a9a-a095-4a34-aae6-c16fa0d8c7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B0F34E30>]}
[0m13:31:12.584244 [info ] [Thread-2 (]: 2 of 2 OK created sql table model main.fct_orders .............................. [[32mOK[0m in 0.14s]
[0m13:31:12.584244 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.fct_orders
[0m13:31:12.584244 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.dim_customers ........................... [[32mOK[0m in 0.15s]
[0m13:31:12.584244 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m13:31:12.590350 [debug] [MainThread]: Using duckdb connection "master"
[0m13:31:12.590350 [debug] [MainThread]: On master: BEGIN
[0m13:31:12.590350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:31:12.590350 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:31:12.590350 [debug] [MainThread]: On master: COMMIT
[0m13:31:12.592409 [debug] [MainThread]: Using duckdb connection "master"
[0m13:31:12.592409 [debug] [MainThread]: On master: COMMIT
[0m13:31:12.592409 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:31:12.592409 [debug] [MainThread]: On master: Close
[0m13:31:12.592409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:12.592409 [debug] [MainThread]: Connection 'create_jaffle_shop_main' was properly closed.
[0m13:31:12.592409 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m13:31:12.592409 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m13:31:12.592409 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m13:31:12.592409 [info ] [MainThread]: 
[0m13:31:12.592409 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m13:31:12.592409 [debug] [MainThread]: Command end result
[0m13:31:12.620406 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:31:12.620406 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:31:12.633980 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:31:12.633980 [info ] [MainThread]: 
[0m13:31:12.633980 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:31:12.633980 [info ] [MainThread]: 
[0m13:31:12.633980 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:31:12.640476 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 13:31:12.640476 after 1.90 seconds
[0m13:31:12.642508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200AFA44D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200ABC53830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200AE5EFD10>]}
[0m13:31:12.642508 [debug] [MainThread]: Flushing usage events
[0m13:31:13.884052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:21.820122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239CD74EDE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239D14BFB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239D144D910>]}


============================== 13:31:21.825299 | 647bfb2d-6915-42da-9549-7cfb930c326e ==============================
[0m13:31:21.825299 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:31:21.826304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:finance', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:31:22.162196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '647bfb2d-6915-42da-9549-7cfb930c326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239CD847E60>]}
[0m13:31:22.228031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '647bfb2d-6915-42da-9549-7cfb930c326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239CFBD68D0>]}
[0m13:31:22.238188 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:31:22.719118 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:31:22.913400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:31:22.913400 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:31:22.947630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '647bfb2d-6915-42da-9549-7cfb930c326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239D1F29370>]}
[0m13:31:23.014098 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:31:23.018091 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:31:23.054362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '647bfb2d-6915-42da-9549-7cfb930c326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239D2669280>]}
[0m13:31:23.054362 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:31:23.055365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '647bfb2d-6915-42da-9549-7cfb930c326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239D1F4F020>]}
[0m13:31:23.056310 [info ] [MainThread]: 
[0m13:31:23.057358 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:31:23.058276 [info ] [MainThread]: 
[0m13:31:23.059287 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:31:23.060584 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m13:31:23.268919 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m13:31:23.270551 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_shop"'
    
  
  
[0m13:31:23.270551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:23.292260 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m13:31:23.294286 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m13:31:23.295260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m13:31:23.296283 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m13:31:23.303855 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:31:23.303855 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_shop'
        and type='sqlite'
    
  
[0m13:31:23.304858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:23.305857 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:31:23.306859 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:31:23.306859 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m13:31:23.307862 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:31:23.307862 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:31:23.308832 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m13:31:23.308832 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:31:23.310453 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:31:23.311361 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:31:23.311361 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:31:23.312366 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:31:23.312366 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m13:31:23.317960 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m13:31:23.325168 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:31:23.326178 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m13:31:23.327287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:23.328265 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:31:23.328265 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:31:23.329260 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m13:31:23.349060 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m13:31:23.351187 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m13:31:23.353092 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m13:31:23.354097 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m13:31:23.356090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '647bfb2d-6915-42da-9549-7cfb930c326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239D1EC2A50>]}
[0m13:31:23.357090 [debug] [MainThread]: Using duckdb connection "master"
[0m13:31:23.357090 [debug] [MainThread]: On master: BEGIN
[0m13:31:23.357090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:23.358090 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:31:23.358090 [debug] [MainThread]: On master: COMMIT
[0m13:31:23.359095 [debug] [MainThread]: Using duckdb connection "master"
[0m13:31:23.359095 [debug] [MainThread]: On master: COMMIT
[0m13:31:23.359095 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:31:23.360092 [debug] [MainThread]: On master: Close
[0m13:31:23.368192 [debug] [Thread-1 (]: Began running node model.jaffle_shop.revenue_by_month
[0m13:31:23.369201 [info ] [Thread-1 (]: 1 of 1 START sql table model main.revenue_by_month ............................. [RUN]
[0m13:31:23.370741 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_shop.revenue_by_month'
[0m13:31:23.370741 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.revenue_by_month
[0m13:31:23.383388 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.revenue_by_month"
[0m13:31:23.386139 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.revenue_by_month
[0m13:31:23.434540 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.revenue_by_month"
[0m13:31:23.436665 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:31:23.437664 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: BEGIN
[0m13:31:23.437664 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:31:23.439013 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:31:23.439013 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:31:23.440108 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */

  
    
    

    create  table
      "jaffle_shop"."main"."revenue_by_month__dbt_tmp"
  
    as (
      

with monthly_revenue as (
    select
        date_trunc('month', order_date) as order_month,
        sum(amount) as monthly_revenue,
        count(distinct order_id) as monthly_orders,
        count(distinct customer_id) as monthly_customers,
        avg(amount) as avg_order_value
    from "jaffle_shop"."main"."fct_orders"
    where order_status not in ('returned', 'cancelled')
    group by date_trunc('month', order_date)
)

select 
    order_month,
    monthly_revenue,
    monthly_orders,
    monthly_customers,
    avg_order_value,
    lag(monthly_revenue) over (order by order_month) as prev_month_revenue,
    (monthly_revenue - lag(monthly_revenue) over (order by order_month)) / 
        lag(monthly_revenue) over (order by order_month) * 100 as revenue_growth_pct
from monthly_revenue
order by order_month
    );
  
  
[0m13:31:23.448371 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m13:31:23.454829 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:31:23.455832 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
alter table "jaffle_shop"."main"."revenue_by_month" rename to "revenue_by_month__dbt_backup"
[0m13:31:23.456843 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:31:23.460347 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:31:23.460474 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
alter table "jaffle_shop"."main"."revenue_by_month__dbt_tmp" rename to "revenue_by_month"
[0m13:31:23.461357 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:31:23.476832 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: COMMIT
[0m13:31:23.477834 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:31:23.477834 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: COMMIT
[0m13:31:23.484228 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:31:23.489241 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:31:23.489241 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
drop table if exists "jaffle_shop"."main"."revenue_by_month__dbt_backup" cascade
[0m13:31:23.493749 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:31:23.495785 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: Close
[0m13:31:23.497800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647bfb2d-6915-42da-9549-7cfb930c326e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239CD847140>]}
[0m13:31:23.498785 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.revenue_by_month ........................ [[32mOK[0m in 0.13s]
[0m13:31:23.498785 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.revenue_by_month
[0m13:31:23.501301 [debug] [MainThread]: Using duckdb connection "master"
[0m13:31:23.502302 [debug] [MainThread]: On master: BEGIN
[0m13:31:23.502302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:31:23.503309 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:31:23.503309 [debug] [MainThread]: On master: COMMIT
[0m13:31:23.504309 [debug] [MainThread]: Using duckdb connection "master"
[0m13:31:23.504309 [debug] [MainThread]: On master: COMMIT
[0m13:31:23.505309 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:31:23.505309 [debug] [MainThread]: On master: Close
[0m13:31:23.506309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:23.506309 [debug] [MainThread]: Connection 'create_jaffle_shop_main' was properly closed.
[0m13:31:23.507309 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m13:31:23.507309 [debug] [MainThread]: Connection 'model.jaffle_shop.revenue_by_month' was properly closed.
[0m13:31:23.507309 [info ] [MainThread]: 
[0m13:31:23.508309 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m13:31:23.510315 [debug] [MainThread]: Command end result
[0m13:31:23.537297 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:31:23.540296 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:31:23.553007 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:31:23.554017 [info ] [MainThread]: 
[0m13:31:23.554826 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:31:23.555837 [info ] [MainThread]: 
[0m13:31:23.555837 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:31:23.558835 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 13:31:23.558835 after 1.93 seconds
[0m13:31:23.558835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239D144D910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239D156CF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239CFC640B0>]}
[0m13:31:23.560348 [debug] [MainThread]: Flushing usage events
[0m13:31:23.761973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:49.064843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023913EFADB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239148020C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239148023F0>]}


============================== 13:31:49.070489 | ac97dfb8-703c-4c30-b095-e60f84db31a3 ==============================
[0m13:31:49.070489 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:31:49.072721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:31:49.372441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac97dfb8-703c-4c30-b095-e60f84db31a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023915BA28D0>]}
[0m13:31:49.432892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac97dfb8-703c-4c30-b095-e60f84db31a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023914E1C620>]}
[0m13:31:49.438893 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:31:49.892860 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:31:50.119180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:31:50.120193 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:31:50.160566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac97dfb8-703c-4c30-b095-e60f84db31a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002391612A6F0>]}
[0m13:31:50.236536 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:31:50.240234 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:31:50.292778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac97dfb8-703c-4c30-b095-e60f84db31a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023916973C50>]}
[0m13:31:50.293783 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:31:50.293783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac97dfb8-703c-4c30-b095-e60f84db31a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023915AFFAA0>]}
[0m13:31:50.295784 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:31:50.297778 [debug] [MainThread]: Command end result
[0m13:31:50.331723 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:31:50.335470 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:31:50.342818 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:31:50.344825 [debug] [MainThread]: Command `python -m dbt.cli.main test` succeeded at 13:31:50.344825 after 1.48 seconds
[0m13:31:50.344825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023913EFADB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239160BE810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239142ED9D0>]}
[0m13:31:50.345826 [debug] [MainThread]: Flushing usage events
[0m13:31:50.667860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:14.144217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C241C04D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23E04F3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C241222DE0>]}


============================== 13:32:14.149248 | 1209eaf1-641c-457a-b2c9-7bc163000d79 ==============================
[0m13:32:14.149248 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:32:14.150168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:32:14.482239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1209eaf1-641c-457a-b2c9-7bc163000d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24256F200>]}
[0m13:32:14.532490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1209eaf1-641c-457a-b2c9-7bc163000d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2424B2510>]}
[0m13:32:14.539471 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:32:14.982017 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:32:15.166622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:32:15.166622 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:32:15.207472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1209eaf1-641c-457a-b2c9-7bc163000d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C242A257C0>]}
[0m13:32:15.271225 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:32:15.275296 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:32:15.306726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1209eaf1-641c-457a-b2c9-7bc163000d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C242F870E0>]}
[0m13:32:15.307727 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:32:15.308145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1209eaf1-641c-457a-b2c9-7bc163000d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C242A4FFE0>]}
[0m13:32:15.309235 [info ] [MainThread]: 
[0m13:32:15.310158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:32:15.311397 [info ] [MainThread]: 
[0m13:32:15.312300 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:32:15.318884 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m13:32:15.540833 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m13:32:15.540833 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_shop"'
    
  
  
[0m13:32:15.541879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:15.564255 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m13:32:15.565243 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m13:32:15.566208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m13:32:15.567234 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m13:32:15.572798 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:32:15.572798 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_shop'
        and type='sqlite'
    
  
[0m13:32:15.573801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:15.574720 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:32:15.575801 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:32:15.575801 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m13:32:15.575801 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:32:15.576756 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:32:15.576756 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m13:32:15.576756 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:32:15.577759 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:32:15.577759 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:32:15.578794 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:32:15.578794 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:32:15.578794 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m13:32:15.582319 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m13:32:15.588845 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:32:15.588845 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m13:32:15.590419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:15.591366 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:32:15.591366 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:32:15.591366 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m13:32:15.606121 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:32:15.608126 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m13:32:15.610124 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m13:32:15.610712 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m13:32:15.612724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1209eaf1-641c-457a-b2c9-7bc163000d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2424DF2C0>]}
[0m13:32:15.612724 [debug] [MainThread]: Using duckdb connection "master"
[0m13:32:15.613799 [debug] [MainThread]: On master: BEGIN
[0m13:32:15.613799 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:15.613799 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:32:15.614720 [debug] [MainThread]: On master: COMMIT
[0m13:32:15.614720 [debug] [MainThread]: Using duckdb connection "master"
[0m13:32:15.614720 [debug] [MainThread]: On master: COMMIT
[0m13:32:15.615720 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:32:15.615720 [debug] [MainThread]: On master: Close
[0m13:32:15.624542 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m13:32:15.625048 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_customers ................................. [RUN]
[0m13:32:15.626055 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_customers'
[0m13:32:15.627055 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m13:32:15.634566 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:32:15.636569 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m13:32:15.673589 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:32:15.676544 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:32:15.676544 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m13:32:15.676544 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:32:15.677621 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:32:15.678618 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:32:15.678618 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    

with customers as (
    select
        id as customer_id,
        first_name,
        last_name,
        email,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_customers"
)

select * from customers
  );

[0m13:32:15.678618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:32:15.687829 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:32:15.688822 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:32:15.688822 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:32:15.692435 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:32:15.692435 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:32:15.693503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:32:15.708571 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m13:32:15.708571 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:32:15.710242 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m13:32:15.716527 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:32:15.720922 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:32:15.722056 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."main"."stg_customers__dbt_backup" cascade
[0m13:32:15.725178 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:32:15.728189 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m13:32:15.730695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1209eaf1-641c-457a-b2c9-7bc163000d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C242A4FA70>]}
[0m13:32:15.731702 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.10s]
[0m13:32:15.732810 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m13:32:15.733314 [debug] [Thread-3 (]: Began running node model.jaffle_shop.dim_customers
[0m13:32:15.734379 [info ] [Thread-3 (]: 2 of 2 START sql table model main.dim_customers ................................ [RUN]
[0m13:32:15.735320 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.dim_customers'
[0m13:32:15.735320 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.dim_customers
[0m13:32:15.739407 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m13:32:15.741907 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.dim_customers
[0m13:32:15.762866 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m13:32:15.766861 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:32:15.766861 [debug] [Thread-3 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m13:32:15.767867 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:32:15.768861 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:32:15.768861 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:32:15.773426 [debug] [Thread-3 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_customers__dbt_tmp"
  
    as (
      

with customers as (
    select * from "jaffle_shop"."main"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders
    from "jaffle_shop"."main"."stg_orders"
    group by customer_id
),

customer_payments as (
    select
        orders.customer_id,
        sum(payments.amount_usd) as lifetime_value
    from "jaffle_shop"."main"."stg_orders" orders
    left join "jaffle_shop"."main"."stg_payments" payments
        on orders.order_id = payments.order_id
    group by orders.customer_id
),

final as (
    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customers.email,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_payments.lifetime_value, 0) as lifetime_value,
        customers.created_at,
        customers.updated_at
    from customers
    left join customer_orders on customers.customer_id = customer_orders.customer_id
    left join customer_payments on customers.customer_id = customer_payments.customer_id
)

select * from final
    );
  
  
[0m13:32:15.796070 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m13:32:15.803592 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:32:15.806589 [debug] [Thread-3 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m13:32:15.807590 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:32:15.813122 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:32:15.814191 [debug] [Thread-3 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:32:15.815114 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:32:15.823138 [debug] [Thread-3 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m13:32:15.824142 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:32:15.825140 [debug] [Thread-3 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m13:32:15.829443 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:32:15.832087 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:32:15.832087 [debug] [Thread-3 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."main"."dim_customers__dbt_backup" cascade
[0m13:32:15.835887 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:32:15.836916 [debug] [Thread-3 (]: On model.jaffle_shop.dim_customers: Close
[0m13:32:15.836916 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1209eaf1-641c-457a-b2c9-7bc163000d79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C242A4FB00>]}
[0m13:32:15.837916 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.dim_customers ........................... [[32mOK[0m in 0.10s]
[0m13:32:15.838693 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.dim_customers
[0m13:32:15.839973 [debug] [MainThread]: Using duckdb connection "master"
[0m13:32:15.841014 [debug] [MainThread]: On master: BEGIN
[0m13:32:15.841014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:32:15.842093 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:32:15.842093 [debug] [MainThread]: On master: COMMIT
[0m13:32:15.842093 [debug] [MainThread]: Using duckdb connection "master"
[0m13:32:15.843071 [debug] [MainThread]: On master: COMMIT
[0m13:32:15.843071 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:32:15.843071 [debug] [MainThread]: On master: Close
[0m13:32:15.844067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:15.844067 [debug] [MainThread]: Connection 'create_jaffle_shop_main' was properly closed.
[0m13:32:15.844067 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m13:32:15.845077 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m13:32:15.845077 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m13:32:15.845077 [info ] [MainThread]: 
[0m13:32:15.846017 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m13:32:15.846982 [debug] [MainThread]: Command end result
[0m13:32:15.872682 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:32:15.877780 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:32:15.887909 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:32:15.887909 [info ] [MainThread]: 
[0m13:32:15.888908 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:32:15.888908 [info ] [MainThread]: 
[0m13:32:15.890414 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:32:15.892434 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 13:32:15.892434 after 1.95 seconds
[0m13:32:15.892434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2413F5EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24097E330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C24097F6B0>]}
[0m13:32:15.893507 [debug] [MainThread]: Flushing usage events
[0m13:32:16.032647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:59.604298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123CE226630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123CE225520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123CE2261E0>]}


============================== 13:32:59.618886 | 668883ae-7de1-4f47-92dd-74ba7c273e19 ==============================
[0m13:32:59.618886 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:32:59.618886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_customers+', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:33:00.043203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '668883ae-7de1-4f47-92dd-74ba7c273e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123CD82C740>]}
[0m13:33:00.090769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '668883ae-7de1-4f47-92dd-74ba7c273e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123CDD59430>]}
[0m13:33:00.106395 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:33:00.556337 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:33:00.762288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:33:00.762541 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:33:00.795049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '668883ae-7de1-4f47-92dd-74ba7c273e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123CF125850>]}
[0m13:33:00.857996 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:33:00.863404 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:33:00.890636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '668883ae-7de1-4f47-92dd-74ba7c273e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123CF14AE70>]}
[0m13:33:00.890636 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:33:00.906555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '668883ae-7de1-4f47-92dd-74ba7c273e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123CF125D90>]}
[0m13:33:00.906555 [info ] [MainThread]: 
[0m13:33:00.906555 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:33:00.906555 [info ] [MainThread]: 
[0m13:33:00.906555 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:33:00.911430 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m13:33:01.145075 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m13:33:01.145075 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_shop"'
    
  
  
[0m13:33:01.145075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:01.161164 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m13:33:01.161164 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m13:33:01.161164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m13:33:01.161164 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m13:33:01.176898 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:33:01.176898 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_shop'
        and type='sqlite'
    
  
[0m13:33:01.176898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:01.176898 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:33:01.176898 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:33:01.176898 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m13:33:01.176898 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:33:01.176898 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:33:01.176898 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m13:33:01.176898 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:33:01.176898 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:33:01.176898 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:33:01.176898 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:33:01.176898 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:33:01.176898 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m13:33:01.193141 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m13:33:01.193141 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:33:01.193141 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m13:33:01.193141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:01.193141 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:33:01.193141 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:33:01.193141 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m13:33:01.219337 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:33:01.224570 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m13:33:01.224570 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m13:33:01.224570 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m13:33:01.224570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '668883ae-7de1-4f47-92dd-74ba7c273e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123CDFB3EF0>]}
[0m13:33:01.224570 [debug] [MainThread]: Using duckdb connection "master"
[0m13:33:01.224570 [debug] [MainThread]: On master: BEGIN
[0m13:33:01.224570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:33:01.224570 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:33:01.224570 [debug] [MainThread]: On master: COMMIT
[0m13:33:01.224570 [debug] [MainThread]: Using duckdb connection "master"
[0m13:33:01.224570 [debug] [MainThread]: On master: COMMIT
[0m13:33:01.224570 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:33:01.224570 [debug] [MainThread]: On master: Close
[0m13:33:01.241272 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m13:33:01.241272 [info ] [Thread-1 (]: 1 of 1 START sql table model main.dim_customers ................................ [RUN]
[0m13:33:01.241272 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_shop.dim_customers'
[0m13:33:01.241272 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m13:33:01.250870 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m13:33:01.250870 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m13:33:01.296869 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m13:33:01.296869 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:33:01.296869 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m13:33:01.296869 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:33:01.296869 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:33:01.296869 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:33:01.296869 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_customers__dbt_tmp"
  
    as (
      

with customers as (
    select * from "jaffle_shop"."main"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders
    from "jaffle_shop"."main"."stg_orders"
    group by customer_id
),

customer_payments as (
    select
        orders.customer_id,
        sum(payments.amount_usd) as lifetime_value
    from "jaffle_shop"."main"."stg_orders" orders
    left join "jaffle_shop"."main"."stg_payments" payments
        on orders.order_id = payments.order_id
    group by orders.customer_id
),

final as (
    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customers.email,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_payments.lifetime_value, 0) as lifetime_value,
        customers.created_at,
        customers.updated_at
    from customers
    left join customer_orders on customers.customer_id = customer_orders.customer_id
    left join customer_payments on customers.customer_id = customer_payments.customer_id
)

select * from final
    );
  
  
[0m13:33:01.311385 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:33:01.311385 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:33:01.318427 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m13:33:01.319021 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:33:01.319948 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:33:01.319948 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:33:01.319948 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:33:01.334949 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m13:33:01.334949 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:33:01.334949 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m13:33:01.343145 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:33:01.343145 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:33:01.351353 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."main"."dim_customers__dbt_backup" cascade
[0m13:33:01.351353 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:33:01.351353 [debug] [Thread-1 (]: On model.jaffle_shop.dim_customers: Close
[0m13:33:01.351353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '668883ae-7de1-4f47-92dd-74ba7c273e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123CF14A6C0>]}
[0m13:33:01.351353 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.dim_customers ........................... [[32mOK[0m in 0.11s]
[0m13:33:01.351353 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m13:33:01.351353 [debug] [MainThread]: Using duckdb connection "master"
[0m13:33:01.351353 [debug] [MainThread]: On master: BEGIN
[0m13:33:01.351353 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:33:01.351353 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:33:01.351353 [debug] [MainThread]: On master: COMMIT
[0m13:33:01.351353 [debug] [MainThread]: Using duckdb connection "master"
[0m13:33:01.351353 [debug] [MainThread]: On master: COMMIT
[0m13:33:01.367827 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:33:01.368301 [debug] [MainThread]: On master: Close
[0m13:33:01.369637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:01.369790 [debug] [MainThread]: Connection 'create_jaffle_shop_main' was properly closed.
[0m13:33:01.369790 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m13:33:01.369790 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m13:33:01.369790 [info ] [MainThread]: 
[0m13:33:01.369790 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m13:33:01.369790 [debug] [MainThread]: Command end result
[0m13:33:01.404915 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:33:01.409857 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:33:01.420284 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:33:01.420284 [info ] [MainThread]: 
[0m13:33:01.421389 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:33:01.422001 [info ] [MainThread]: 
[0m13:33:01.422522 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:33:01.424988 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 13:33:01.424988 after 2.05 seconds
[0m13:33:01.425757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123CD2EFAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123CE6BF680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123CE6BFB90>]}
[0m13:33:01.425985 [debug] [MainThread]: Flushing usage events
[0m13:33:02.481818 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:03.104744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248B9426270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248B5953C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248B6379D60>]}


============================== 13:59:03.113882 | a2d22f4f-9811-4bd4-939b-e575369a79a9 ==============================
[0m13:59:03.113882 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:59:03.115779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:59:03.511047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2d22f4f-9811-4bd4-939b-e575369a79a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248BA230F50>]}
[0m13:59:03.576217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2d22f4f-9811-4bd4-939b-e575369a79a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248B9CFC770>]}
[0m13:59:03.585282 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:59:04.180951 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:59:04.446669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:04.447254 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:04.509979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2d22f4f-9811-4bd4-939b-e575369a79a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248BA28E870>]}
[0m13:59:04.591469 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:59:04.599486 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:59:04.663260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2d22f4f-9811-4bd4-939b-e575369a79a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248BA28F470>]}
[0m13:59:04.664270 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:59:04.665267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2d22f4f-9811-4bd4-939b-e575369a79a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248BA230F80>]}
[0m13:59:04.667355 [info ] [MainThread]: 
[0m13:59:04.668277 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:59:04.669281 [info ] [MainThread]: 
[0m13:59:04.670276 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:59:04.680278 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m13:59:04.995122 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m13:59:04.996124 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_shop"'
    
  
  
[0m13:59:04.997125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:05.038670 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m13:59:05.040661 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m13:59:05.041662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m13:59:05.041662 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m13:59:05.050171 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:59:05.050171 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_shop'
        and type='sqlite'
    
  
[0m13:59:05.051172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:05.052173 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:59:05.054172 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:59:05.054172 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m13:59:05.055171 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:59:05.055171 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:59:05.055171 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m13:59:05.056172 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:59:05.057172 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:59:05.057172 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m13:59:05.058172 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m13:59:05.058172 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:59:05.059171 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m13:59:05.061906 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m13:59:05.067876 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:59:05.067876 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m13:59:05.068876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:05.068876 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:59:05.069876 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m13:59:05.069876 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m13:59:05.087399 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m13:59:05.089402 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m13:59:05.091402 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m13:59:05.091402 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m13:59:05.094397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2d22f4f-9811-4bd4-939b-e575369a79a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248BAA0B8C0>]}
[0m13:59:05.094397 [debug] [MainThread]: Using duckdb connection "master"
[0m13:59:05.095499 [debug] [MainThread]: On master: BEGIN
[0m13:59:05.095499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:05.096475 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:59:05.096475 [debug] [MainThread]: On master: COMMIT
[0m13:59:05.097512 [debug] [MainThread]: Using duckdb connection "master"
[0m13:59:05.097512 [debug] [MainThread]: On master: COMMIT
[0m13:59:05.098506 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:59:05.098506 [debug] [MainThread]: On master: Close
[0m13:59:05.109781 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m13:59:05.110748 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m13:59:05.111702 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m13:59:05.111702 [info ] [Thread-1 (]: 1 of 6 START sql view model main.stg_customers ................................. [RUN]
[0m13:59:05.112994 [info ] [Thread-2 (]: 2 of 6 START sql view model main.stg_orders .................................... [RUN]
[0m13:59:05.114003 [info ] [Thread-3 (]: 3 of 6 START sql view model main.stg_payments .................................. [RUN]
[0m13:59:05.115005 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_customers'
[0m13:59:05.116005 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m13:59:05.117005 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_payments'
[0m13:59:05.117005 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m13:59:05.118007 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m13:59:05.119028 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m13:59:05.131623 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:59:05.138630 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:59:05.144892 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m13:59:05.148187 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m13:59:05.148187 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m13:59:05.149270 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m13:59:05.189870 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m13:59:05.193956 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:59:05.197870 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m13:59:05.200431 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:59:05.201431 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:59:05.202431 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:59:05.203432 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m13:59:05.203432 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m13:59:05.204437 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m13:59:05.205483 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:59:05.205483 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:59:05.206465 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:59:05.207449 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:59:05.208464 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:59:05.209430 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:59:05.209430 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:59:05.210511 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:59:05.211434 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:59:05.211434 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    

with customers as (
    select
        id as customer_id,
        first_name,
        last_name,
        email,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_customers"
)

select * from customers
  );

[0m13:59:05.212668 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    

with orders as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status as order_status,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_orders"
)

select * from orders
  );

[0m13:59:05.213403 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  
  create view "jaffle_shop"."main"."stg_payments__dbt_tmp" as (
    

with payments as (
    select
        id as payment_id,
        order_id,
        payment_method,
        amount / 100.0 as amount_usd,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_payments"
    where status = 'success'
)

select * from payments
  );

[0m13:59:05.214411 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:59:05.215417 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:59:05.224411 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:59:05.224411 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m13:59:05.228936 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:59:05.228936 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:59:05.231937 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:59:05.233426 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:59:05.233426 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter view "jaffle_shop"."main"."stg_payments" rename to "stg_payments__dbt_backup"
[0m13:59:05.234900 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:59:05.235908 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:59:05.240987 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:59:05.241998 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m13:59:05.245944 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:59:05.246916 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:59:05.249768 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:59:05.250771 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:59:05.251767 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter view "jaffle_shop"."main"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m13:59:05.252768 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:59:05.253769 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:59:05.253769 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:59:05.270527 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m13:59:05.271413 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m13:59:05.273650 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m13:59:05.274797 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:59:05.275457 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:59:05.276470 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:59:05.276470 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m13:59:05.277469 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m13:59:05.278470 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m13:59:05.285470 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:59:05.291548 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m13:59:05.292561 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m13:59:05.293472 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."main"."stg_customers__dbt_backup" cascade
[0m13:59:05.293472 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m13:59:05.296469 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m13:59:05.300472 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m13:59:05.301468 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m13:59:05.301468 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "jaffle_shop"."main"."stg_payments__dbt_backup" cascade
[0m13:59:05.304034 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:59:05.308055 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m13:59:05.308055 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m13:59:05.311127 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m13:59:05.313240 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m13:59:05.315149 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m13:59:05.317134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2d22f4f-9811-4bd4-939b-e575369a79a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248BA266660>]}
[0m13:59:05.317134 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2d22f4f-9811-4bd4-939b-e575369a79a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248BAEEDD30>]}
[0m13:59:05.318158 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2d22f4f-9811-4bd4-939b-e575369a79a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248BA28F020>]}
[0m13:59:05.319150 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.19s]
[0m13:59:05.319150 [info ] [Thread-3 (]: 3 of 6 OK created sql view model main.stg_payments ............................. [[32mOK[0m in 0.20s]
[0m13:59:05.322135 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m13:59:05.320140 [info ] [Thread-2 (]: 2 of 6 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.20s]
[0m13:59:05.323167 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m13:59:05.324134 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m13:59:05.325134 [debug] [Thread-4 (]: Began running node model.jaffle_shop.dim_customers
[0m13:59:05.326137 [debug] [Thread-1 (]: Began running node model.jaffle_shop.fct_orders
[0m13:59:05.327140 [info ] [Thread-4 (]: 4 of 6 START sql table model main.dim_customers ................................ [RUN]
[0m13:59:05.328527 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.dim_customers'
[0m13:59:05.327140 [info ] [Thread-1 (]: 5 of 6 START sql table model main.fct_orders ................................... [RUN]
[0m13:59:05.330542 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.dim_customers
[0m13:59:05.331522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.fct_orders)
[0m13:59:05.337530 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m13:59:05.339586 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.fct_orders
[0m13:59:05.345612 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m13:59:05.348134 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.dim_customers
[0m13:59:05.348134 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.fct_orders
[0m13:59:05.376671 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m13:59:05.380592 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m13:59:05.383793 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:59:05.384788 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:59:05.384788 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m13:59:05.385832 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m13:59:05.385832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:05.386832 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:59:05.388948 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:59:05.389952 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:59:05.389952 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:59:05.390953 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    
    

    create  table
      "jaffle_shop"."main"."fct_orders__dbt_tmp"
  
    as (
      

with orders as (
    select * from "jaffle_shop"."main"."stg_orders"
),

payments as (
    select
        order_id,
        sum(amount_usd) as total_amount
    from "jaffle_shop"."main"."stg_payments"
    group by order_id
),

final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.order_status,
        coalesce(payments.total_amount, 0) as amount,
        orders.created_at,
        orders.updated_at
    from orders
    left join payments on orders.order_id = payments.order_id
)

select * from final
    );
  
  
[0m13:59:05.391948 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:59:05.392453 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_customers__dbt_tmp"
  
    as (
      

with customers as (
    select * from "jaffle_shop"."main"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders
    from "jaffle_shop"."main"."stg_orders"
    group by customer_id
),

customer_payments as (
    select
        orders.customer_id,
        sum(payments.amount_usd) as lifetime_value
    from "jaffle_shop"."main"."stg_orders" orders
    left join "jaffle_shop"."main"."stg_payments" payments
        on orders.order_id = payments.order_id
    group by orders.customer_id
),

final as (
    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customers.email,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_payments.lifetime_value, 0) as lifetime_value,
        customers.created_at,
        customers.updated_at
    from customers
    left join customer_orders on customers.customer_id = customer_orders.customer_id
    left join customer_payments on customers.customer_id = customer_payments.customer_id
)

select * from final
    );
  
  
[0m13:59:05.396473 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:59:05.400559 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:59:05.401559 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "jaffle_shop"."main"."fct_orders" rename to "fct_orders__dbt_backup"
[0m13:59:05.401559 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m13:59:05.406588 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:59:05.406588 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m13:59:05.407590 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:59:05.410671 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:59:05.410671 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "jaffle_shop"."main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:59:05.411619 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:59:05.415289 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:59:05.416321 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:59:05.416321 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:59:05.424303 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m13:59:05.425296 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:59:05.426210 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:59:05.426210 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m13:59:05.428777 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m13:59:05.429778 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:59:05.429778 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m13:59:05.433780 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:59:05.436782 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m13:59:05.437783 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "jaffle_shop"."main"."fct_orders__dbt_backup" cascade
[0m13:59:05.437783 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m13:59:05.440784 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m13:59:05.440784 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."main"."dim_customers__dbt_backup" cascade
[0m13:59:05.443812 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:59:05.445835 [debug] [Thread-1 (]: On model.jaffle_shop.fct_orders: Close
[0m13:59:05.447001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2d22f4f-9811-4bd4-939b-e575369a79a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248BB84EF00>]}
[0m13:59:05.447996 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m13:59:05.447996 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.fct_orders .............................. [[32mOK[0m in 0.12s]
[0m13:59:05.450998 [debug] [Thread-4 (]: On model.jaffle_shop.dim_customers: Close
[0m13:59:05.450998 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.fct_orders
[0m13:59:05.452564 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2d22f4f-9811-4bd4-939b-e575369a79a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248BAE79A30>]}
[0m13:59:05.453528 [debug] [Thread-2 (]: Began running node model.jaffle_shop.revenue_by_month
[0m13:59:05.454514 [info ] [Thread-4 (]: 4 of 6 OK created sql table model main.dim_customers ........................... [[32mOK[0m in 0.12s]
[0m13:59:05.456517 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.dim_customers
[0m13:59:05.455514 [info ] [Thread-2 (]: 6 of 6 START sql table model main.revenue_by_month ............................. [RUN]
[0m13:59:05.457516 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.revenue_by_month)
[0m13:59:05.457516 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.revenue_by_month
[0m13:59:05.465041 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.revenue_by_month"
[0m13:59:05.467050 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.revenue_by_month
[0m13:59:05.472086 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.revenue_by_month"
[0m13:59:05.477089 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:59:05.478089 [debug] [Thread-2 (]: On model.jaffle_shop.revenue_by_month: BEGIN
[0m13:59:05.478089 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:59:05.480085 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:59:05.480085 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:59:05.481093 [debug] [Thread-2 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */

  
    
    

    create  table
      "jaffle_shop"."main"."revenue_by_month__dbt_tmp"
  
    as (
      

with monthly_revenue as (
    select
        date_trunc('month', order_date) as order_month,
        sum(amount) as monthly_revenue,
        count(distinct order_id) as monthly_orders,
        count(distinct customer_id) as monthly_customers,
        avg(amount) as avg_order_value
    from "jaffle_shop"."main"."fct_orders"
    where order_status not in ('returned', 'cancelled')
    group by date_trunc('month', order_date)
)

select 
    order_month,
    monthly_revenue,
    monthly_orders,
    monthly_customers,
    avg_order_value,
    lag(monthly_revenue) over (order by order_month) as prev_month_revenue,
    (monthly_revenue - lag(monthly_revenue) over (order by order_month)) / 
        lag(monthly_revenue) over (order by order_month) * 100 as revenue_growth_pct
from monthly_revenue
order by order_month
    );
  
  
[0m13:59:05.490132 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m13:59:05.496376 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:59:05.496376 [debug] [Thread-2 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
alter table "jaffle_shop"."main"."revenue_by_month" rename to "revenue_by_month__dbt_backup"
[0m13:59:05.497460 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:59:05.501469 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:59:05.501469 [debug] [Thread-2 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
alter table "jaffle_shop"."main"."revenue_by_month__dbt_tmp" rename to "revenue_by_month"
[0m13:59:05.502478 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:59:05.505398 [debug] [Thread-2 (]: On model.jaffle_shop.revenue_by_month: COMMIT
[0m13:59:05.506392 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:59:05.507392 [debug] [Thread-2 (]: On model.jaffle_shop.revenue_by_month: COMMIT
[0m13:59:05.513109 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:59:05.516146 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m13:59:05.516146 [debug] [Thread-2 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
drop table if exists "jaffle_shop"."main"."revenue_by_month__dbt_backup" cascade
[0m13:59:05.520484 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:59:05.521484 [debug] [Thread-2 (]: On model.jaffle_shop.revenue_by_month: Close
[0m13:59:05.522484 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2d22f4f-9811-4bd4-939b-e575369a79a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248BAFDB3B0>]}
[0m13:59:05.523484 [info ] [Thread-2 (]: 6 of 6 OK created sql table model main.revenue_by_month ........................ [[32mOK[0m in 0.07s]
[0m13:59:05.523837 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.revenue_by_month
[0m13:59:05.525854 [debug] [MainThread]: Using duckdb connection "master"
[0m13:59:05.525854 [debug] [MainThread]: On master: BEGIN
[0m13:59:05.525854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:05.527384 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:59:05.527384 [debug] [MainThread]: On master: COMMIT
[0m13:59:05.528414 [debug] [MainThread]: Using duckdb connection "master"
[0m13:59:05.528414 [debug] [MainThread]: On master: COMMIT
[0m13:59:05.529394 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:59:05.529394 [debug] [MainThread]: On master: Close
[0m13:59:05.529394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:05.530410 [debug] [MainThread]: Connection 'create_jaffle_shop_main' was properly closed.
[0m13:59:05.530410 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m13:59:05.530410 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m13:59:05.531410 [debug] [MainThread]: Connection 'model.jaffle_shop.revenue_by_month' was properly closed.
[0m13:59:05.531410 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m13:59:05.531410 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m13:59:05.532426 [info ] [MainThread]: 
[0m13:59:05.532426 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m13:59:05.535417 [debug] [MainThread]: Command end result
[0m13:59:05.568298 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:59:05.577305 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:59:05.585008 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:59:05.586017 [info ] [MainThread]: 
[0m13:59:05.589029 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:59:05.591020 [info ] [MainThread]: 
[0m13:59:05.592016 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:59:05.595023 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 13:59:05.595023 after 2.73 seconds
[0m13:59:05.595023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248B6D6F9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248B8A01580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248B996FB30>]}
[0m13:59:05.596022 [debug] [MainThread]: Flushing usage events
[0m13:59:06.920264 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:12.034761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E2D5C320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E65C9EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E6925160>]}


============================== 13:59:12.046914 | af983f08-1ce6-4d30-8493-85f60b6c43a3 ==============================
[0m13:59:12.046914 [info ] [MainThread]: Running with dbt=1.9.6
[0m13:59:12.046914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m13:59:12.469087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af983f08-1ce6-4d30-8493-85f60b6c43a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E5D2C920>]}
[0m13:59:12.578552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af983f08-1ce6-4d30-8493-85f60b6c43a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E61A07A0>]}
[0m13:59:12.594291 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:59:13.502026 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m13:59:13.834694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:13.835239 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:13.870478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af983f08-1ce6-4d30-8493-85f60b6c43a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E7BC8770>]}
[0m13:59:13.960153 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:59:13.960153 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:59:14.024188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af983f08-1ce6-4d30-8493-85f60b6c43a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E82A49E0>]}
[0m13:59:14.024188 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m13:59:14.024188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af983f08-1ce6-4d30-8493-85f60b6c43a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E76A1D60>]}
[0m13:59:14.024188 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:59:14.037775 [debug] [MainThread]: Command end result
[0m13:59:14.069955 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m13:59:14.075061 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m13:59:14.081029 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m13:59:14.081029 [debug] [MainThread]: Command `python -m dbt.cli.main test` succeeded at 13:59:14.081029 after 2.28 seconds
[0m13:59:14.081029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E6926240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E2D5C320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E61C9D00>]}
[0m13:59:14.081029 [debug] [MainThread]: Flushing usage events
[0m13:59:15.126998 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:01:57.401018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594CAB3E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594BFB3AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594CE71EE0>]}


============================== 14:01:57.419030 | 2361de3c-5293-4293-8321-177258da6de6 ==============================
[0m14:01:57.419030 [info ] [MainThread]: Running with dbt=1.9.6
[0m14:01:57.421035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:01:57.790657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2361de3c-5293-4293-8321-177258da6de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594D7A2660>]}
[0m14:01:57.857920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2361de3c-5293-4293-8321-177258da6de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594CE716A0>]}
[0m14:01:57.870524 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:01:58.387582 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m14:01:58.700289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:01:58.716009 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models\staging\stg_customers.sql
[0m14:01:59.148947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2361de3c-5293-4293-8321-177258da6de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594E2FF7D0>]}
[0m14:01:59.211713 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m14:01:59.226948 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m14:01:59.274610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2361de3c-5293-4293-8321-177258da6de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594E2D9070>]}
[0m14:01:59.274610 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m14:01:59.274610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2361de3c-5293-4293-8321-177258da6de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594E2FF740>]}
[0m14:01:59.274610 [info ] [MainThread]: 
[0m14:01:59.274610 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:01:59.274610 [info ] [MainThread]: 
[0m14:01:59.274610 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:01:59.296059 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m14:01:59.647041 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m14:01:59.647041 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_shop"'
    
  
  
[0m14:01:59.647041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:59.696044 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m14:01:59.696044 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m14:01:59.709078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m14:01:59.709078 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m14:01:59.709078 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m14:01:59.709078 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_shop'
        and type='sqlite'
    
  
[0m14:01:59.709078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:59.709078 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:01:59.724726 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m14:01:59.724726 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m14:01:59.724726 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:01:59.724726 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m14:01:59.724726 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m14:01:59.724726 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:01:59.724726 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m14:01:59.724726 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m14:01:59.724726 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m14:01:59.724726 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:01:59.724726 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m14:01:59.724726 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m14:01:59.740345 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m14:01:59.746860 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m14:01:59.746860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:59.746860 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:01:59.746860 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m14:01:59.746860 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m14:01:59.772087 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m14:01:59.772087 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m14:01:59.772087 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m14:01:59.772087 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m14:01:59.772087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2361de3c-5293-4293-8321-177258da6de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025949421D90>]}
[0m14:01:59.772087 [debug] [MainThread]: Using duckdb connection "master"
[0m14:01:59.772087 [debug] [MainThread]: On master: BEGIN
[0m14:01:59.772087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:01:59.772087 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:01:59.772087 [debug] [MainThread]: On master: COMMIT
[0m14:01:59.772087 [debug] [MainThread]: Using duckdb connection "master"
[0m14:01:59.772087 [debug] [MainThread]: On master: COMMIT
[0m14:01:59.772087 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:01:59.772087 [debug] [MainThread]: On master: Close
[0m14:01:59.803525 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m14:01:59.803525 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m14:01:59.803525 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m14:01:59.803525 [info ] [Thread-1 (]: 1 of 6 START sql view model main.stg_customers ................................. [RUN]
[0m14:01:59.803525 [info ] [Thread-2 (]: 2 of 6 START sql view model main.stg_orders .................................... [RUN]
[0m14:01:59.803525 [info ] [Thread-3 (]: 3 of 6 START sql view model main.stg_payments .................................. [RUN]
[0m14:01:59.803525 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_customers'
[0m14:01:59.803525 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m14:01:59.803525 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_payments'
[0m14:01:59.803525 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:01:59.803525 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m14:01:59.803525 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m14:01:59.829876 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:01:59.846885 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m14:01:59.846885 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m14:01:59.846885 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:01:59.846885 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m14:01:59.846885 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m14:01:59.909739 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m14:01:59.914751 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m14:01:59.914751 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m14:01:59.914751 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:01:59.922762 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m14:01:59.922762 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:01:59.922762 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m14:01:59.922762 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m14:01:59.922762 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m14:01:59.926028 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:01:59.926458 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:01:59.926458 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:01:59.926458 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:01:59.926458 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:01:59.926458 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:01:59.926458 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:01:59.926458 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m14:01:59.926458 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    

-- with customers as (
    select
        id as customer_id,
        first_name,
        last_name,
        email,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_customers"
)

select * from customers
  );

[0m14:01:59.926458 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:01:59.926458 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  
  create view "jaffle_shop"."main"."stg_payments__dbt_tmp" as (
    

with payments as (
    select
        id as payment_id,
        order_id,
        payment_method,
        amount / 100.0 as amount_usd,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_payments"
    where status = 'success'
)

select * from payments
  );

[0m14:01:59.939480 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    

-- with customers as (
    select
        id as customer_id,
        first_name,
        last_name,
        email,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_customers"
)

select * from customers
  );

[0m14:01:59.939480 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    

with orders as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status as order_status,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_orders"
)

select * from orders
  );

[0m14:01:59.943486 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:01:59.943486 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:01:59.945654 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: ROLLBACK
[0m14:01:59.945654 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:01:59.954845 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m14:01:59.959344 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:01:59.959344 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter view "jaffle_shop"."main"."stg_payments" rename to "stg_payments__dbt_backup"
[0m14:01:59.964859 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:01:59.964859 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:01:59.964859 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:01:59.970379 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m14:01:59.970379 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:01:59.970379 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter view "jaffle_shop"."main"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m14:01:59.970379 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:01:59.970379 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:01:59.970379 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:01:59.991301 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m14:01:59.991301 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m14:01:59.991301 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m14:02:00.002395 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:02:00.002395 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m14:02:00.003930 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m14:02:00.011241 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:02:00.017753 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m14:02:00.017753 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m14:02:00.017753 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "jaffle_shop"."main"."stg_payments__dbt_backup" cascade
[0m14:02:00.017753 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:02:00.017753 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m14:02:00.033401 [debug] [Thread-1 (]: Failed to rollback 'model.jaffle_shop.stg_customers'
[0m14:02:00.033401 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:02:00.033401 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m14:02:00.033401 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m14:02:00.033401 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m14:02:00.033401 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m14:02:00.033401 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2361de3c-5293-4293-8321-177258da6de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594E9E3A10>]}
[0m14:02:00.033401 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2361de3c-5293-4293-8321-177258da6de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594E83D340>]}
[0m14:02:00.046427 [info ] [Thread-3 (]: 3 of 6 OK created sql view model main.stg_payments ............................. [[32mOK[0m in 0.23s]
[0m14:02:00.046427 [info ] [Thread-2 (]: 2 of 6 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.23s]
[0m14:02:00.049564 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m14:02:00.049564 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m14:02:00.049564 [debug] [Thread-1 (]: Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Parser Error: syntax error at or near "select"
[0m14:02:00.049564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2361de3c-5293-4293-8321-177258da6de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594E177E60>]}
[0m14:02:00.049564 [debug] [Thread-4 (]: Began running node model.jaffle_shop.fct_orders
[0m14:02:00.049564 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model main.stg_customers ........................ [[31mERROR[0m in 0.25s]
[0m14:02:00.056614 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:02:00.049564 [info ] [Thread-4 (]: 4 of 6 START sql table model main.fct_orders ................................... [RUN]
[0m14:02:00.057623 [debug] [Thread-7 (]: Marking all children of 'model.jaffle_shop.stg_customers' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Parser Error: syntax error at or near "select".
[0m14:02:00.057623 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.fct_orders'
[0m14:02:00.060117 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.fct_orders
[0m14:02:00.061109 [debug] [Thread-2 (]: Began running node model.jaffle_shop.dim_customers
[0m14:02:00.061109 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m14:02:00.061109 [info ] [Thread-2 (]: 5 of 6 SKIP relation main.dim_customers ........................................ [[33mSKIP[0m]
[0m14:02:00.061109 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.dim_customers
[0m14:02:00.073621 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.fct_orders
[0m14:02:00.105540 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m14:02:00.109854 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m14:02:00.109854 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m14:02:00.109854 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:02:00.109854 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:02:00.109854 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m14:02:00.109854 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    
    

    create  table
      "jaffle_shop"."main"."fct_orders__dbt_tmp"
  
    as (
      

with orders as (
    select * from "jaffle_shop"."main"."stg_orders"
),

payments as (
    select
        order_id,
        sum(amount_usd) as total_amount
    from "jaffle_shop"."main"."stg_payments"
    group by order_id
),

final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.order_status,
        coalesce(payments.total_amount, 0) as amount,
        orders.created_at,
        orders.updated_at
    from orders
    left join payments on orders.order_id = payments.order_id
)

select * from final
    );
  
  
[0m14:02:00.126467 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m14:02:00.126467 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m14:02:00.126467 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "jaffle_shop"."main"."fct_orders" rename to "fct_orders__dbt_backup"
[0m14:02:00.126467 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:02:00.126467 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m14:02:00.126467 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "jaffle_shop"."main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m14:02:00.126467 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m14:02:00.142657 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m14:02:00.142657 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m14:02:00.142657 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m14:02:00.146782 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:02:00.146782 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m14:02:00.146782 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "jaffle_shop"."main"."fct_orders__dbt_backup" cascade
[0m14:02:00.153834 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:02:00.156850 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: Close
[0m14:02:00.156850 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2361de3c-5293-4293-8321-177258da6de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594F211D60>]}
[0m14:02:00.156850 [info ] [Thread-4 (]: 4 of 6 OK created sql table model main.fct_orders .............................. [[32mOK[0m in 0.10s]
[0m14:02:00.159442 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.fct_orders
[0m14:02:00.159442 [debug] [Thread-1 (]: Began running node model.jaffle_shop.revenue_by_month
[0m14:02:00.159442 [info ] [Thread-1 (]: 6 of 6 START sql table model main.revenue_by_month ............................. [RUN]
[0m14:02:00.161952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.revenue_by_month)
[0m14:02:00.162665 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.revenue_by_month
[0m14:02:00.162665 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.revenue_by_month"
[0m14:02:00.170197 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.revenue_by_month
[0m14:02:00.170197 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.revenue_by_month"
[0m14:02:00.170197 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m14:02:00.178282 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: BEGIN
[0m14:02:00.179173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:00.179847 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:02:00.181019 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m14:02:00.181653 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */

  
    
    

    create  table
      "jaffle_shop"."main"."revenue_by_month__dbt_tmp"
  
    as (
      

with monthly_revenue as (
    select
        date_trunc('month', order_date) as order_month,
        sum(amount) as monthly_revenue,
        count(distinct order_id) as monthly_orders,
        count(distinct customer_id) as monthly_customers,
        avg(amount) as avg_order_value
    from "jaffle_shop"."main"."fct_orders"
    where order_status not in ('returned', 'cancelled')
    group by date_trunc('month', order_date)
)

select 
    order_month,
    monthly_revenue,
    monthly_orders,
    monthly_customers,
    avg_order_value,
    lag(monthly_revenue) over (order by order_month) as prev_month_revenue,
    (monthly_revenue - lag(monthly_revenue) over (order by order_month)) / 
        lag(monthly_revenue) over (order by order_month) * 100 as revenue_growth_pct
from monthly_revenue
order by order_month
    );
  
  
[0m14:02:00.195904 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m14:02:00.195904 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m14:02:00.195904 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
alter table "jaffle_shop"."main"."revenue_by_month" rename to "revenue_by_month__dbt_backup"
[0m14:02:00.208424 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:02:00.210928 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m14:02:00.210928 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
alter table "jaffle_shop"."main"."revenue_by_month__dbt_tmp" rename to "revenue_by_month"
[0m14:02:00.210928 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:02:00.210928 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: COMMIT
[0m14:02:00.210928 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m14:02:00.210928 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: COMMIT
[0m14:02:00.210928 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:02:00.227001 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m14:02:00.227001 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
drop table if exists "jaffle_shop"."main"."revenue_by_month__dbt_backup" cascade
[0m14:02:00.227001 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:02:00.227001 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: Close
[0m14:02:00.227001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2361de3c-5293-4293-8321-177258da6de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594E2D8FE0>]}
[0m14:02:00.227001 [info ] [Thread-1 (]: 6 of 6 OK created sql table model main.revenue_by_month ........................ [[32mOK[0m in 0.07s]
[0m14:02:00.227001 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.revenue_by_month
[0m14:02:00.227001 [debug] [MainThread]: Using duckdb connection "master"
[0m14:02:00.227001 [debug] [MainThread]: On master: BEGIN
[0m14:02:00.227001 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:02:00.227001 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:02:00.240514 [debug] [MainThread]: On master: COMMIT
[0m14:02:00.240514 [debug] [MainThread]: Using duckdb connection "master"
[0m14:02:00.242596 [debug] [MainThread]: On master: COMMIT
[0m14:02:00.242596 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:02:00.242596 [debug] [MainThread]: On master: Close
[0m14:02:00.242596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:00.242596 [debug] [MainThread]: Connection 'create_jaffle_shop_main' was properly closed.
[0m14:02:00.242596 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m14:02:00.242596 [debug] [MainThread]: Connection 'model.jaffle_shop.revenue_by_month' was properly closed.
[0m14:02:00.242596 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m14:02:00.242596 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m14:02:00.242596 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m14:02:00.246637 [info ] [MainThread]: 
[0m14:02:00.246637 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m14:02:00.248646 [debug] [MainThread]: Command end result
[0m14:02:00.277801 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m14:02:00.277801 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m14:02:00.295075 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m14:02:00.295075 [info ] [MainThread]: 
[0m14:02:00.295075 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:02:00.295075 [info ] [MainThread]: 
[0m14:02:00.295075 [error] [MainThread]:   Runtime Error in model stg_customers (models\staging\stg_customers.sql)
  Parser Error: syntax error at or near "select"
[0m14:02:00.295075 [info ] [MainThread]: 
[0m14:02:00.295075 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m14:02:00.295075 [debug] [MainThread]: Command `python -m dbt.cli.main run` failed at 14:02:00.295075 after 3.14 seconds
[0m14:02:00.295075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594D1D2D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594CB25A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594CE05940>]}
[0m14:02:00.295075 [debug] [MainThread]: Flushing usage events
[0m14:02:01.477147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:02:14.966757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196896354F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019689E00CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968D126180>]}


============================== 14:02:14.978775 | e5193eef-9571-476a-ac17-fd748956a7ab ==============================
[0m14:02:14.978775 [info ] [MainThread]: Running with dbt=1.9.6
[0m14:02:14.979774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:02:15.444611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5193eef-9571-476a-ac17-fd748956a7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968C52C6E0>]}
[0m14:02:15.527334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5193eef-9571-476a-ac17-fd748956a7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968CD985C0>]}
[0m14:02:15.539348 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:02:16.173336 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m14:02:16.831934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:02:16.833938 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models\staging\stg_customers.sql
[0m14:02:17.567476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5193eef-9571-476a-ac17-fd748956a7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968EAFF620>]}
[0m14:02:17.778202 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m14:02:17.789104 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m14:02:17.879098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5193eef-9571-476a-ac17-fd748956a7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968E61F8C0>]}
[0m14:02:17.880085 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m14:02:17.881999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5193eef-9571-476a-ac17-fd748956a7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968EAFFEF0>]}
[0m14:02:17.887118 [info ] [MainThread]: 
[0m14:02:17.888113 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:02:17.890498 [info ] [MainThread]: 
[0m14:02:17.891568 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:02:17.911372 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m14:02:18.550613 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m14:02:18.551615 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_shop"'
    
  
  
[0m14:02:18.553323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:18.663638 [debug] [ThreadPool]: SQL status: OK in 0.110 seconds
[0m14:02:18.667606 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m14:02:18.669616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m14:02:18.671574 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m14:02:18.694558 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m14:02:18.695555 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_shop'
        and type='sqlite'
    
  
[0m14:02:18.696556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:02:18.699555 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:02:18.703555 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m14:02:18.705554 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m14:02:18.706560 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:02:18.707554 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m14:02:18.709876 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m14:02:18.712887 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:02:18.715884 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m14:02:18.716885 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m14:02:18.717983 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m14:02:18.718979 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:02:18.720887 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m14:02:18.727791 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m14:02:18.744347 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m14:02:18.745443 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m14:02:18.745443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:18.746444 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:02:18.747627 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m14:02:18.748551 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m14:02:18.802378 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m14:02:18.806346 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m14:02:18.812590 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m14:02:18.813774 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m14:02:18.818787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5193eef-9571-476a-ac17-fd748956a7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968DE25790>]}
[0m14:02:18.821008 [debug] [MainThread]: Using duckdb connection "master"
[0m14:02:18.823006 [debug] [MainThread]: On master: BEGIN
[0m14:02:18.824005 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:02:18.824005 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:02:18.825513 [debug] [MainThread]: On master: COMMIT
[0m14:02:18.825513 [debug] [MainThread]: Using duckdb connection "master"
[0m14:02:18.827522 [debug] [MainThread]: On master: COMMIT
[0m14:02:18.828526 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:02:18.831570 [debug] [MainThread]: On master: Close
[0m14:02:18.857238 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m14:02:18.858226 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m14:02:18.859227 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m14:02:18.860738 [info ] [Thread-1 (]: 1 of 6 START sql view model main.stg_customers ................................. [RUN]
[0m14:02:18.861753 [info ] [Thread-2 (]: 2 of 6 START sql view model main.stg_orders .................................... [RUN]
[0m14:02:18.866021 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_customers'
[0m14:02:18.862749 [info ] [Thread-3 (]: 3 of 6 START sql view model main.stg_payments .................................. [RUN]
[0m14:02:18.868351 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m14:02:18.869354 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:02:18.871356 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_payments'
[0m14:02:18.872354 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m14:02:18.895866 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:02:18.898984 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m14:02:18.908529 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m14:02:18.920892 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m14:02:18.925385 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:02:18.926392 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m14:02:18.927394 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m14:02:19.047878 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m14:02:19.049891 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m14:02:19.059541 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m14:02:19.064969 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:02:19.066074 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:02:19.066988 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m14:02:19.068989 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m14:02:19.069989 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m14:02:19.070989 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m14:02:19.072988 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:02:19.074038 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:02:19.075073 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:02:19.077988 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:02:19.079076 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:02:19.081069 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:02:19.082072 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m14:02:19.083072 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:02:19.085068 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    

with orders as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status as order_status,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_orders"
)

select * from orders
  );

[0m14:02:19.086089 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m14:02:19.087101 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    

with customers as (
    select
        id as customer_id,
        first_name,
        last_name,
        email,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_customers"
)

select * from customers
  );

[0m14:02:19.089088 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  
  create view "jaffle_shop"."main"."stg_payments__dbt_tmp" as (
    

with payments as (
    select
        id as payment_id,
        order_id,
        payment_method,
        amount / 100.0 as amount_usd,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_payments"
    where status = 'success'
)

select * from payments
  );

[0m14:02:19.090990 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:02:19.116473 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m14:02:19.115472 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:02:19.118474 [debug] [Thread-3 (]: SQL status: OK in 0.026 seconds
[0m14:02:19.127887 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:02:19.129887 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:02:19.138999 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m14:02:19.140908 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:02:19.142914 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter view "jaffle_shop"."main"."stg_payments" rename to "stg_payments__dbt_backup"
[0m14:02:19.143915 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:02:19.146915 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:02:19.154063 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:02:19.155049 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m14:02:19.164755 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:02:19.165690 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:02:19.175677 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m14:02:19.176460 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:02:19.178894 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter view "jaffle_shop"."main"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m14:02:19.181463 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:02:19.183478 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:02:19.210475 [debug] [Thread-3 (]: SQL status: OK in 0.027 seconds
[0m14:02:19.223495 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m14:02:19.229047 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m14:02:19.234057 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m14:02:19.236047 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:02:19.237045 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:02:19.239095 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m14:02:19.240168 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m14:02:19.241267 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m14:02:19.243115 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m14:02:19.251795 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m14:02:19.267447 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m14:02:19.270026 [debug] [Thread-3 (]: SQL status: OK in 0.025 seconds
[0m14:02:19.270455 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m14:02:19.272460 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m14:02:19.281685 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m14:02:19.288932 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m14:02:19.292954 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "jaffle_shop"."main"."stg_payments__dbt_backup" cascade
[0m14:02:19.293964 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."main"."stg_customers__dbt_backup" cascade
[0m14:02:19.295195 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:02:19.303766 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m14:02:19.305768 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m14:02:19.315853 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m14:02:19.316817 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m14:02:19.323808 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m14:02:19.325802 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5193eef-9571-476a-ac17-fd748956a7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968EFB5940>]}
[0m14:02:19.327085 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5193eef-9571-476a-ac17-fd748956a7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968EF8BC20>]}
[0m14:02:19.328097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5193eef-9571-476a-ac17-fd748956a7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968DFA1970>]}
[0m14:02:19.329368 [info ] [Thread-2 (]: 2 of 6 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.44s]
[0m14:02:19.331385 [info ] [Thread-3 (]: 3 of 6 OK created sql view model main.stg_payments ............................. [[32mOK[0m in 0.45s]
[0m14:02:19.333401 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.46s]
[0m14:02:19.336399 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m14:02:19.337784 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m14:02:19.338795 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:02:19.342798 [debug] [Thread-4 (]: Began running node model.jaffle_shop.fct_orders
[0m14:02:19.343803 [debug] [Thread-2 (]: Began running node model.jaffle_shop.dim_customers
[0m14:02:19.345803 [info ] [Thread-4 (]: 4 of 6 START sql table model main.fct_orders ................................... [RUN]
[0m14:02:19.348853 [info ] [Thread-2 (]: 5 of 6 START sql table model main.dim_customers ................................ [RUN]
[0m14:02:19.350850 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.fct_orders'
[0m14:02:19.351850 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.dim_customers)
[0m14:02:19.353060 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.fct_orders
[0m14:02:19.354401 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.dim_customers
[0m14:02:19.365350 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m14:02:19.376363 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m14:02:19.381993 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.fct_orders
[0m14:02:19.384029 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.dim_customers
[0m14:02:19.464069 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.dim_customers"
[0m14:02:19.458090 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.fct_orders"
[0m14:02:19.471458 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m14:02:19.473459 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:02:19.475454 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: BEGIN
[0m14:02:19.476454 [debug] [Thread-2 (]: On model.jaffle_shop.dim_customers: BEGIN
[0m14:02:19.478460 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:02:19.479457 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:02:19.481458 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:02:19.483454 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:02:19.484456 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m14:02:19.485472 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:02:19.486472 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */

  
    
    

    create  table
      "jaffle_shop"."main"."fct_orders__dbt_tmp"
  
    as (
      

with orders as (
    select * from "jaffle_shop"."main"."stg_orders"
),

payments as (
    select
        order_id,
        sum(amount_usd) as total_amount
    from "jaffle_shop"."main"."stg_payments"
    group by order_id
),

final as (
    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.order_status,
        coalesce(payments.total_amount, 0) as amount,
        orders.created_at,
        orders.updated_at
    from orders
    left join payments on orders.order_id = payments.order_id
)

select * from final
    );
  
  
[0m14:02:19.487472 [debug] [Thread-2 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */

  
    
    

    create  table
      "jaffle_shop"."main"."dim_customers__dbt_tmp"
  
    as (
      

with customers as (
    select * from "jaffle_shop"."main"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders
    from "jaffle_shop"."main"."stg_orders"
    group by customer_id
),

customer_payments as (
    select
        orders.customer_id,
        sum(payments.amount_usd) as lifetime_value
    from "jaffle_shop"."main"."stg_orders" orders
    left join "jaffle_shop"."main"."stg_payments" payments
        on orders.order_id = payments.order_id
    group by orders.customer_id
),

final as (
    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customers.email,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_payments.lifetime_value, 0) as lifetime_value,
        customers.created_at,
        customers.updated_at
    from customers
    left join customer_orders on customers.customer_id = customer_orders.customer_id
    left join customer_payments on customers.customer_id = customer_payments.customer_id
)

select * from final
    );
  
  
[0m14:02:19.501507 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m14:02:19.511530 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m14:02:19.513529 [debug] [Thread-2 (]: SQL status: OK in 0.023 seconds
[0m14:02:19.514526 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "jaffle_shop"."main"."fct_orders" rename to "fct_orders__dbt_backup"
[0m14:02:19.522539 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:02:19.524523 [debug] [Thread-2 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:02:19.527062 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:02:19.536085 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m14:02:19.537073 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m14:02:19.538067 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "jaffle_shop"."main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m14:02:19.546615 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:02:19.548631 [debug] [Thread-2 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "jaffle_shop"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:02:19.549637 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:02:19.566886 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m14:02:19.568882 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m14:02:19.569866 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m14:02:19.573862 [debug] [Thread-2 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m14:02:19.575866 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: COMMIT
[0m14:02:19.577093 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:02:19.578102 [debug] [Thread-2 (]: On model.jaffle_shop.dim_customers: COMMIT
[0m14:02:19.583464 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m14:02:19.590459 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_shop.fct_orders"
[0m14:02:19.591460 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m14:02:19.593461 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "jaffle_shop"."main"."fct_orders__dbt_backup" cascade
[0m14:02:19.600453 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.dim_customers"
[0m14:02:19.602467 [debug] [Thread-2 (]: On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "jaffle_shop"."main"."dim_customers__dbt_backup" cascade
[0m14:02:19.607375 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:02:19.611413 [debug] [Thread-4 (]: On model.jaffle_shop.fct_orders: Close
[0m14:02:19.612414 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m14:02:19.614799 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5193eef-9571-476a-ac17-fd748956a7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968EF1B890>]}
[0m14:02:19.617794 [debug] [Thread-2 (]: On model.jaffle_shop.dim_customers: Close
[0m14:02:19.619803 [info ] [Thread-4 (]: 4 of 6 OK created sql table model main.fct_orders .............................. [[32mOK[0m in 0.26s]
[0m14:02:19.621791 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5193eef-9571-476a-ac17-fd748956a7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968EE57F50>]}
[0m14:02:19.623800 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.fct_orders
[0m14:02:19.626331 [info ] [Thread-2 (]: 5 of 6 OK created sql table model main.dim_customers ........................... [[32mOK[0m in 0.27s]
[0m14:02:19.629432 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.dim_customers
[0m14:02:19.632464 [debug] [Thread-1 (]: Began running node model.jaffle_shop.revenue_by_month
[0m14:02:19.635450 [info ] [Thread-1 (]: 6 of 6 START sql table model main.revenue_by_month ............................. [RUN]
[0m14:02:19.637552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.revenue_by_month)
[0m14:02:19.638558 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.revenue_by_month
[0m14:02:19.648081 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.revenue_by_month"
[0m14:02:19.654073 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.revenue_by_month
[0m14:02:19.662652 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.revenue_by_month"
[0m14:02:19.668657 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m14:02:19.669652 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: BEGIN
[0m14:02:19.670669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:19.672669 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:02:19.673671 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m14:02:19.675651 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */

  
    
    

    create  table
      "jaffle_shop"."main"."revenue_by_month__dbt_tmp"
  
    as (
      

with monthly_revenue as (
    select
        date_trunc('month', order_date) as order_month,
        sum(amount) as monthly_revenue,
        count(distinct order_id) as monthly_orders,
        count(distinct customer_id) as monthly_customers,
        avg(amount) as avg_order_value
    from "jaffle_shop"."main"."fct_orders"
    where order_status not in ('returned', 'cancelled')
    group by date_trunc('month', order_date)
)

select 
    order_month,
    monthly_revenue,
    monthly_orders,
    monthly_customers,
    avg_order_value,
    lag(monthly_revenue) over (order by order_month) as prev_month_revenue,
    (monthly_revenue - lag(monthly_revenue) over (order by order_month)) / 
        lag(monthly_revenue) over (order by order_month) * 100 as revenue_growth_pct
from monthly_revenue
order by order_month
    );
  
  
[0m14:02:19.703945 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m14:02:19.712222 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m14:02:19.713205 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
alter table "jaffle_shop"."main"."revenue_by_month" rename to "revenue_by_month__dbt_backup"
[0m14:02:19.716211 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:02:19.725268 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m14:02:19.727287 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
alter table "jaffle_shop"."main"."revenue_by_month__dbt_tmp" rename to "revenue_by_month"
[0m14:02:19.729284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:02:19.733293 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: COMMIT
[0m14:02:19.734291 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m14:02:19.735289 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: COMMIT
[0m14:02:19.742740 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:02:19.754283 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.revenue_by_month"
[0m14:02:19.756302 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.revenue_by_month"} */
drop table if exists "jaffle_shop"."main"."revenue_by_month__dbt_backup" cascade
[0m14:02:19.762490 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:02:19.767029 [debug] [Thread-1 (]: On model.jaffle_shop.revenue_by_month: Close
[0m14:02:19.769032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5193eef-9571-476a-ac17-fd748956a7ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968EFA9310>]}
[0m14:02:19.771029 [info ] [Thread-1 (]: 6 of 6 OK created sql table model main.revenue_by_month ........................ [[32mOK[0m in 0.13s]
[0m14:02:19.773053 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.revenue_by_month
[0m14:02:19.776434 [debug] [MainThread]: Using duckdb connection "master"
[0m14:02:19.777450 [debug] [MainThread]: On master: BEGIN
[0m14:02:19.779445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:02:19.781469 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m14:02:19.783468 [debug] [MainThread]: On master: COMMIT
[0m14:02:19.785460 [debug] [MainThread]: Using duckdb connection "master"
[0m14:02:19.786444 [debug] [MainThread]: On master: COMMIT
[0m14:02:19.788445 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:02:19.789453 [debug] [MainThread]: On master: Close
[0m14:02:19.790443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:19.791448 [debug] [MainThread]: Connection 'create_jaffle_shop_main' was properly closed.
[0m14:02:19.792447 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m14:02:19.796853 [debug] [MainThread]: Connection 'model.jaffle_shop.revenue_by_month' was properly closed.
[0m14:02:19.799862 [debug] [MainThread]: Connection 'model.jaffle_shop.dim_customers' was properly closed.
[0m14:02:19.801288 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m14:02:19.802305 [debug] [MainThread]: Connection 'model.jaffle_shop.fct_orders' was properly closed.
[0m14:02:19.803375 [info ] [MainThread]: 
[0m14:02:19.804547 [info ] [MainThread]: Finished running 3 table models, 3 view models in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m14:02:19.808093 [debug] [MainThread]: Command end result
[0m14:02:20.005855 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m14:02:20.018871 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m14:02:20.040429 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m14:02:20.041437 [info ] [MainThread]: 
[0m14:02:20.043429 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:02:20.045434 [info ] [MainThread]: 
[0m14:02:20.046427 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:02:20.054063 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 14:02:20.052659 after 5.34 seconds
[0m14:02:20.055076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968D4F6B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968C47E750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001968C47E840>]}
[0m14:02:20.056451 [debug] [MainThread]: Flushing usage events
[0m14:02:20.334530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:02:28.053453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1AAF5C320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1ADE7F620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1AEC89EE0>]}


============================== 14:02:28.076938 | 653ce15f-9738-43a2-821d-6949d4b1146e ==============================
[0m14:02:28.076938 [info ] [MainThread]: Running with dbt=1.9.6
[0m14:02:28.078946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:02:29.425885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '653ce15f-9738-43a2-821d-6949d4b1146e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1ADF2C740>]}
[0m14:02:29.665029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '653ce15f-9738-43a2-821d-6949d4b1146e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1AFA6B380>]}
[0m14:02:29.685394 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m14:02:31.183929 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m14:02:31.938355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:02:31.943923 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:02:32.057303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '653ce15f-9738-43a2-821d-6949d4b1146e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1AF5A1AC0>]}
[0m14:02:32.250708 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m14:02:32.258293 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m14:02:32.428624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '653ce15f-9738-43a2-821d-6949d4b1146e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B0377C20>]}
[0m14:02:32.428624 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m14:02:32.432611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '653ce15f-9738-43a2-821d-6949d4b1146e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1B034F140>]}
[0m14:02:32.438989 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:02:32.449316 [debug] [MainThread]: Command end result
[0m14:02:32.524251 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m14:02:32.533827 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m14:02:32.546963 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m14:02:32.550881 [debug] [MainThread]: Command `python -m dbt.cli.main test` succeeded at 14:02:32.550881 after 4.95 seconds
[0m14:02:32.553890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1AE3EBB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1AEB35250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1AEB351C0>]}
[0m14:02:32.553890 [debug] [MainThread]: Flushing usage events
[0m14:02:32.654159 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:15:17.099252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E055C9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E0653CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E3DC6870>]}


============================== 22:15:17.109586 | 1bcecc96-0733-4b2a-a8ec-49eb3cb0a9f4 ==============================
[0m22:15:17.109586 [info ] [MainThread]: Running with dbt=1.9.6
[0m22:15:17.111178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:15:17.675880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bcecc96-0733-4b2a-a8ec-49eb3cb0a9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E352C650>]}
[0m22:15:17.751672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bcecc96-0733-4b2a-a8ec-49eb3cb0a9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E4DA27B0>]}
[0m22:15:17.770241 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m22:15:18.413035 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m22:15:18.688955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:15:18.688955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:15:18.721339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bcecc96-0733-4b2a-a8ec-49eb3cb0a9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E524F530>]}
[0m22:15:18.784317 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m22:15:18.803429 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m22:15:18.881452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bcecc96-0733-4b2a-a8ec-49eb3cb0a9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E5787CE0>]}
[0m22:15:18.881452 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m22:15:18.881452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bcecc96-0733-4b2a-a8ec-49eb3cb0a9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E5225820>]}
[0m22:15:18.893463 [info ] [MainThread]: 
[0m22:15:18.893463 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:18.893463 [info ] [MainThread]: 
[0m22:15:18.893463 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:15:18.893463 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m22:15:19.300965 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m22:15:19.302033 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_shop"'
    
  
  
[0m22:15:19.302562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:20.695492 [debug] [ThreadPool]: SQL status: OK in 1.402 seconds
[0m22:15:20.695492 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m22:15:20.695492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m22:15:20.711152 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m22:15:20.721074 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m22:15:20.721074 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_shop'
        and type='sqlite'
    
  
[0m22:15:20.721074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:20.723461 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:15:20.726468 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m22:15:20.726468 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m22:15:20.727555 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:15:20.728569 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m22:15:20.728569 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m22:15:20.732469 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m22:15:20.733000 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m22:15:20.734034 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m22:15:20.734034 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m22:15:20.735035 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:15:20.735035 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m22:15:20.738009 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m22:15:20.739891 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m22:15:20.739891 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m22:15:20.739891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:20.739891 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:15:20.739891 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m22:15:20.739891 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m22:15:20.771285 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m22:15:20.784310 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m22:15:20.787322 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m22:15:20.787322 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m22:15:20.787322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bcecc96-0733-4b2a-a8ec-49eb3cb0a9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E0B21C70>]}
[0m22:15:20.787322 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:20.787322 [debug] [MainThread]: On master: BEGIN
[0m22:15:20.787322 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:20.787322 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:15:20.787322 [debug] [MainThread]: On master: COMMIT
[0m22:15:20.787322 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:20.787322 [debug] [MainThread]: On master: COMMIT
[0m22:15:20.787322 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:15:20.787322 [debug] [MainThread]: On master: Close
[0m22:15:20.802959 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:15:20.802959 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:15:20.802959 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m22:15:20.802959 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m22:15:20.802959 [info ] [Thread-2 (]: 2 of 3 START sql view model main.stg_orders .................................... [RUN]
[0m22:15:20.802959 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_customers'
[0m22:15:20.802959 [info ] [Thread-3 (]: 3 of 3 START sql view model main.stg_payments .................................. [RUN]
[0m22:15:20.802959 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_orders'
[0m22:15:20.802959 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:15:20.802959 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_payments'
[0m22:15:20.802959 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:15:20.829663 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:15:20.833194 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m22:15:20.833194 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:15:20.840277 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m22:15:20.840277 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:15:20.859113 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:15:20.872998 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m22:15:20.892531 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:15:20.896975 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:15:20.902614 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m22:15:20.906689 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m22:15:20.907211 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m22:15:20.907734 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m22:15:20.908258 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: BEGIN
[0m22:15:20.908774 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: BEGIN
[0m22:15:20.909290 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: BEGIN
[0m22:15:20.909833 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:15:20.910345 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:15:20.910885 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:15:20.911913 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:15:20.912920 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m22:15:20.913918 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m22:15:20.914423 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m22:15:20.914423 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m22:15:20.915429 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m22:15:20.916430 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  
  create view "jaffle_shop"."main"."stg_customers__dbt_tmp" as (
    

with customers as (
    select
        id as customer_id,
        first_name,
        last_name,
        email,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_customers"
)

select * from customers
  );

[0m22:15:20.917433 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  
  create view "jaffle_shop"."main"."stg_orders__dbt_tmp" as (
    

with orders as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status as order_status,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_orders"
)

select * from orders
  );

[0m22:15:20.917949 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  
  create view "jaffle_shop"."main"."stg_payments__dbt_tmp" as (
    

with payments as (
    select
        id as payment_id,
        order_id,
        payment_method,
        amount / 100.0 as amount_usd,
        created_at,
        updated_at
    from "jaffle_shop"."main"."raw_payments"
    where status = 'success'
)

select * from payments
  );

[0m22:15:20.920025 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m22:15:20.920025 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m22:15:20.921127 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m22:15:20.924387 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m22:15:20.931395 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m22:15:20.931395 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m22:15:20.931395 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m22:15:20.931395 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m22:15:20.931395 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter view "jaffle_shop"."main"."stg_payments" rename to "stg_payments__dbt_backup"
[0m22:15:20.971713 [debug] [Thread-2 (]: SQL status: OK in 0.041 seconds
[0m22:15:20.971713 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m22:15:20.971713 [debug] [Thread-3 (]: SQL status: OK in 0.022 seconds
[0m22:15:20.984748 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m22:15:20.987762 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m22:15:20.987762 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m22:15:20.987762 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter view "jaffle_shop"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m22:15:20.987762 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter view "jaffle_shop"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m22:15:20.987762 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter view "jaffle_shop"."main"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m22:15:20.987762 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m22:15:20.987762 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m22:15:21.003417 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:15:21.021077 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m22:15:21.021077 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m22:15:21.021077 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m22:15:21.021077 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m22:15:21.021077 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m22:15:21.029978 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m22:15:21.030518 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: COMMIT
[0m22:15:21.031235 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: COMMIT
[0m22:15:21.031748 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: COMMIT
[0m22:15:21.038318 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m22:15:21.045744 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_shop.stg_orders"
[0m22:15:21.046811 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "jaffle_shop"."main"."stg_orders__dbt_backup" cascade
[0m22:15:21.047319 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m22:15:21.051170 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_shop.stg_payments"
[0m22:15:21.052209 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m22:15:21.052209 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "jaffle_shop"."main"."stg_payments__dbt_backup" cascade
[0m22:15:21.053845 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_shop.stg_customers"
[0m22:15:21.053845 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m22:15:21.057826 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "jaffle_shop"."main"."stg_customers__dbt_backup" cascade
[0m22:15:21.060736 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:15:21.063157 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m22:15:21.064875 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m22:15:21.066705 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bcecc96-0733-4b2a-a8ec-49eb3cb0a9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E576B980>]}
[0m22:15:21.067220 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bcecc96-0733-4b2a-a8ec-49eb3cb0a9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E5BE6870>]}
[0m22:15:21.067733 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m22:15:21.070926 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:15:21.068251 [info ] [Thread-2 (]: 2 of 3 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.26s]
[0m22:15:21.071987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bcecc96-0733-4b2a-a8ec-49eb3cb0a9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E561D970>]}
[0m22:15:21.069294 [info ] [Thread-3 (]: 3 of 3 OK created sql view model main.stg_payments ............................. [[32mOK[0m in 0.26s]
[0m22:15:21.072508 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:15:21.074102 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m22:15:21.073044 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.27s]
[0m22:15:21.075693 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:15:21.078015 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:21.079277 [debug] [MainThread]: On master: BEGIN
[0m22:15:21.079815 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:15:21.080826 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:15:21.081887 [debug] [MainThread]: On master: COMMIT
[0m22:15:21.081997 [debug] [MainThread]: Using duckdb connection "master"
[0m22:15:21.081997 [debug] [MainThread]: On master: COMMIT
[0m22:15:21.085103 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:15:21.085103 [debug] [MainThread]: On master: Close
[0m22:15:21.085103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:21.085103 [debug] [MainThread]: Connection 'create_jaffle_shop_main' was properly closed.
[0m22:15:21.089505 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m22:15:21.089505 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:15:21.089505 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m22:15:21.090520 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m22:15:21.092534 [info ] [MainThread]: 
[0m22:15:21.094515 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m22:15:21.094784 [debug] [MainThread]: Command end result
[0m22:15:21.127566 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m22:15:21.134675 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m22:15:21.143387 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m22:15:21.143387 [info ] [MainThread]: 
[0m22:15:21.148662 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:21.148662 [info ] [MainThread]: 
[0m22:15:21.148662 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:15:21.148662 [debug] [MainThread]: Command `python -m dbt.cli.main run` succeeded at 22:15:21.148662 after 4.25 seconds
[0m22:15:21.148662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E055C9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E3501460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E35011C0>]}
[0m22:15:21.148662 [debug] [MainThread]: Flushing usage events
[0m22:15:22.089289 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:18:01.690234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347F425DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347F857020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347F424F50>]}


============================== 22:18:01.697243 | e9502d9c-1684-48cf-85f0-c95825985316 ==============================
[0m22:18:01.697243 [info ] [MainThread]: Running with dbt=1.9.6
[0m22:18:01.698241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:18:02.037088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9502d9c-1684-48cf-85f0-c95825985316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347FD557C0>]}
[0m22:18:02.094235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9502d9c-1684-48cf-85f0-c95825985316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347EEA2A50>]}
[0m22:18:02.102233 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m22:18:02.665962 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m22:18:03.050590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:18:03.051592 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:18:03.123419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9502d9c-1684-48cf-85f0-c95825985316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023480329010>]}
[0m22:18:03.242089 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m22:18:03.248091 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m22:18:03.312104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9502d9c-1684-48cf-85f0-c95825985316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023480966A50>]}
[0m22:18:03.313102 [info ] [MainThread]: Found 6 models, 3 seeds, 428 macros
[0m22:18:03.314440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9502d9c-1684-48cf-85f0-c95825985316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347EE4DB80>]}
[0m22:18:03.317453 [info ] [MainThread]: 
[0m22:18:03.318452 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:18:03.319454 [info ] [MainThread]: 
[0m22:18:03.320456 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:18:03.332962 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop'
[0m22:18:03.815736 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop"
[0m22:18:03.815736 [debug] [ThreadPool]: On list_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_shop"'
    
  
  
[0m22:18:03.816738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:03.864606 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m22:18:03.866648 [debug] [ThreadPool]: On list_jaffle_shop: Close
[0m22:18:03.868656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_shop, now create_jaffle_shop_main)
[0m22:18:03.869661 [debug] [ThreadPool]: Creating schema "database: "jaffle_shop"
schema: "main"
"
[0m22:18:03.881232 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m22:18:03.882237 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_shop'
        and type='sqlite'
    
  
[0m22:18:03.883241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:03.884247 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m22:18:03.887627 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m22:18:03.888630 [debug] [ThreadPool]: On create_jaffle_shop_main: BEGIN
[0m22:18:03.889635 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:18:03.889635 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m22:18:03.890639 [debug] [ThreadPool]: On create_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_jaffle_shop_main"} */

    
    
        create schema if not exists "jaffle_shop"."main"
    
[0m22:18:03.891646 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:18:03.893654 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m22:18:03.894657 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_shop_main"
[0m22:18:03.894657 [debug] [ThreadPool]: On create_jaffle_shop_main: COMMIT
[0m22:18:03.895662 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:18:03.896664 [debug] [ThreadPool]: On create_jaffle_shop_main: Close
[0m22:18:03.900681 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m22:18:03.910737 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m22:18:03.911739 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m22:18:03.911739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:03.912744 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:18:03.913749 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m22:18:03.914754 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m22:18:03.944259 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m22:18:03.947275 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m22:18:03.950282 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m22:18:03.951291 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m22:18:03.955305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9502d9c-1684-48cf-85f0-c95825985316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023480268350>]}
[0m22:18:03.956312 [debug] [MainThread]: Using duckdb connection "master"
[0m22:18:03.956312 [debug] [MainThread]: On master: BEGIN
[0m22:18:03.957315 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:03.958319 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:18:03.959337 [debug] [MainThread]: On master: COMMIT
[0m22:18:03.959337 [debug] [MainThread]: Using duckdb connection "master"
[0m22:18:03.960350 [debug] [MainThread]: On master: COMMIT
[0m22:18:03.961355 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:18:03.961355 [debug] [MainThread]: On master: Close
[0m22:18:03.973471 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m22:18:03.974726 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m22:18:03.974726 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m22:18:03.975740 [info ] [Thread-1 (]: 1 of 3 START seed file main.raw_customers ...................................... [RUN]
[0m22:18:03.976745 [info ] [Thread-2 (]: 2 of 3 START seed file main.raw_orders ......................................... [RUN]
[0m22:18:03.978753 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_customers'
[0m22:18:03.977758 [info ] [Thread-3 (]: 3 of 3 START seed file main.raw_payments ....................................... [RUN]
[0m22:18:03.979971 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_orders'
[0m22:18:03.980987 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m22:18:03.981991 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_payments'
[0m22:18:03.982996 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m22:18:03.982996 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m22:18:03.984002 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m22:18:03.984002 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m22:18:04.016780 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m22:18:04.062150 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m22:18:04.065223 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: BEGIN
[0m22:18:04.070249 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_payments"
[0m22:18:04.073769 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m22:18:04.075165 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:18:04.076178 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: BEGIN
[0m22:18:04.077183 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: BEGIN
[0m22:18:04.078187 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:18:04.079191 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:18:04.079191 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:18:04.081540 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m22:18:04.081540 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m22:18:04.082543 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
truncate table "jaffle_shop"."main"."raw_customers"
[0m22:18:04.083546 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m22:18:04.083546 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_payments"
[0m22:18:04.085556 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m22:18:04.086559 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
truncate table "jaffle_shop"."main"."raw_payments"
[0m22:18:04.087564 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
truncate table "jaffle_shop"."main"."raw_orders"
[0m22:18:04.088569 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m22:18:04.089572 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m22:18:04.110485 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m22:18:04.111491 [debug] [Thread-2 (]: SQL status: OK in 0.022 seconds
[0m22:18:04.113500 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_payments"
[0m22:18:04.114503 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: 
          COPY "jaffle_shop"."main"."raw_customers" FROM 'C:\Users\KBHATIA\jaffle_shop\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:18:04.116513 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m22:18:04.117515 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: 
          COPY "jaffle_shop"."main"."raw_payments" FROM 'C:\Users\KBHATIA\jaffle_shop\seeds\raw_payments.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:18:04.119527 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: 
          COPY "jaffle_shop"."main"."raw_orders" FROM 'C:\Users\KBHATIA\jaffle_shop\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m22:18:04.149251 [debug] [Thread-2 (]: SQL status: OK in 0.029 seconds
[0m22:18:04.149251 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m22:18:04.158199 [debug] [Thread-3 (]: SQL status: OK in 0.038 seconds
[0m22:18:04.161220 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m22:18:04.162274 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m22:18:04.163292 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m22:18:04.186193 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m22:18:04.189206 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: COMMIT
[0m22:18:04.193383 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m22:18:04.194386 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_shop.raw_customers"
[0m22:18:04.195391 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_shop.raw_payments"
[0m22:18:04.196402 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_shop.raw_orders"
[0m22:18:04.196402 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: COMMIT
[0m22:18:04.197403 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: COMMIT
[0m22:18:04.198406 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: COMMIT
[0m22:18:04.209455 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m22:18:04.214180 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m22:18:04.218195 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m22:18:04.220203 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m22:18:04.220203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9502d9c-1684-48cf-85f0-c95825985316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347BC67500>]}
[0m22:18:04.221617 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9502d9c-1684-48cf-85f0-c95825985316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023480FEBAA0>]}
[0m22:18:04.223299 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file main.raw_customers .................................. [[32mINSERT 7[0m in 0.24s]
[0m22:18:04.224828 [debug] [Thread-2 (]: SQL status: OK in 0.026 seconds
[0m22:18:04.225841 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m22:18:04.224316 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file main.raw_payments ................................... [[32mINSERT 7[0m in 0.24s]
[0m22:18:04.228003 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m22:18:04.229019 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m22:18:04.230021 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9502d9c-1684-48cf-85f0-c95825985316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234810BB560>]}
[0m22:18:04.231026 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file main.raw_orders ..................................... [[32mINSERT 7[0m in 0.25s]
[0m22:18:04.233035 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m22:18:04.235045 [debug] [MainThread]: Using duckdb connection "master"
[0m22:18:04.236480 [debug] [MainThread]: On master: BEGIN
[0m22:18:04.236990 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:18:04.238006 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:18:04.239011 [debug] [MainThread]: On master: COMMIT
[0m22:18:04.239011 [debug] [MainThread]: Using duckdb connection "master"
[0m22:18:04.240016 [debug] [MainThread]: On master: COMMIT
[0m22:18:04.241019 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:18:04.241019 [debug] [MainThread]: On master: Close
[0m22:18:04.242462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:04.243478 [debug] [MainThread]: Connection 'create_jaffle_shop_main' was properly closed.
[0m22:18:04.243478 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m22:18:04.245517 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m22:18:04.246508 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m22:18:04.246508 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m22:18:04.247495 [info ] [MainThread]: 
[0m22:18:04.247495 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m22:18:04.249605 [debug] [MainThread]: Command end result
[0m22:18:04.301051 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m22:18:04.309284 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m22:18:04.326007 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m22:18:04.327020 [info ] [MainThread]: 
[0m22:18:04.328027 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:18:04.329028 [info ] [MainThread]: 
[0m22:18:04.330033 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:18:04.333610 [debug] [MainThread]: Command `python -m dbt.cli.main seed` succeeded at 22:18:04.333610 after 2.83 seconds
[0m22:18:04.335853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347EA2CA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347F8ECEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002347BA53CB0>]}
[0m22:18:04.335853 [debug] [MainThread]: Flushing usage events
[0m22:18:05.328883 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:47:24.615498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A53557440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5055C230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A54510C20>]}


============================== 22:47:24.615498 | c07f3475-e681-4a69-ace6-9476a151221d ==============================
[0m22:47:24.615498 [info ] [MainThread]: Running with dbt=1.9.6
[0m22:47:24.615498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:47:24.929414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c07f3475-e681-4a69-ace6-9476a151221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A54EE31A0>]}
[0m22:47:24.977240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c07f3475-e681-4a69-ace6-9476a151221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A53CF66F0>]}
[0m22:47:24.994949 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m22:47:25.416573 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m22:47:25.606721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m22:47:25.606721 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://analyses\simple_revenue_analysis.sql
[0m22:47:25.606721 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://analyses\simple_customer_analysis.sql
[0m22:47:25.606721 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://analyses\simple_order_analysis.sql
[0m22:47:25.812274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c07f3475-e681-4a69-ace6-9476a151221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A55913E60>]}
[0m22:47:25.877167 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m22:47:25.877167 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m22:47:25.916988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c07f3475-e681-4a69-ace6-9476a151221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5571D340>]}
[0m22:47:25.916988 [info ] [MainThread]: Found 6 models, 3 seeds, 3 analyses, 428 macros
[0m22:47:25.916988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c07f3475-e681-4a69-ace6-9476a151221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A55045940>]}
[0m22:47:25.916988 [info ] [MainThread]: 
[0m22:47:25.916988 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:47:25.916988 [info ] [MainThread]: 
[0m22:47:25.916988 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:47:25.930641 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m22:47:26.166144 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m22:47:26.166144 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m22:47:26.167144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:26.190236 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m22:47:26.190236 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m22:47:26.191234 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m22:47:26.207808 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m22:47:26.209793 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m22:47:26.211793 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m22:47:26.211793 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m22:47:26.213793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c07f3475-e681-4a69-ace6-9476a151221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5587C650>]}
[0m22:47:26.222824 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m22:47:26.223824 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m22:47:26.223824 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m22:47:26.224823 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_customers'
[0m22:47:26.225824 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_orders'
[0m22:47:26.225824 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_payments'
[0m22:47:26.226825 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m22:47:26.226825 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m22:47:26.226825 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m22:47:26.232825 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m22:47:26.234843 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m22:47:26.236357 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m22:47:26.237366 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m22:47:26.238367 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m22:47:26.238367 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m22:47:26.239391 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_customers
[0m22:47:26.240469 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:47:26.241368 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_customers'
[0m22:47:26.241368 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m22:47:26.242397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_orders, now model.jaffle_shop.stg_orders)
[0m22:47:26.242397 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:47:26.243484 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_payments, now model.jaffle_shop.stg_payments)
[0m22:47:26.243484 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:47:26.246368 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:47:26.247368 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m22:47:26.249998 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:47:26.253006 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m22:47:26.254920 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:47:26.255916 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m22:47:26.255916 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:47:26.256943 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:47:26.257919 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m22:47:26.259009 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:47:26.259965 [debug] [Thread-1 (]: Began running node model.jaffle_shop.dim_customers
[0m22:47:26.260919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_customers, now model.jaffle_shop.dim_customers)
[0m22:47:26.260919 [debug] [Thread-4 (]: Began running node model.jaffle_shop.fct_orders
[0m22:47:26.260919 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.dim_customers
[0m22:47:26.261914 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.fct_orders)
[0m22:47:26.265913 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m22:47:26.266487 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.fct_orders
[0m22:47:26.269496 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m22:47:26.271495 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.dim_customers
[0m22:47:26.272499 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.fct_orders
[0m22:47:26.273495 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.dim_customers
[0m22:47:26.274500 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.fct_orders
[0m22:47:26.274500 [debug] [Thread-2 (]: Began running node analysis.jaffle_shop.simple_customer_analysis
[0m22:47:26.275495 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now analysis.jaffle_shop.simple_customer_analysis)
[0m22:47:26.275495 [debug] [Thread-2 (]: Began compiling node analysis.jaffle_shop.simple_customer_analysis
[0m22:47:26.278575 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.jaffle_shop.simple_customer_analysis"
[0m22:47:26.278575 [debug] [Thread-1 (]: Began running node analysis.jaffle_shop.simple_order_analysis
[0m22:47:26.279495 [debug] [Thread-4 (]: Began running node analysis.jaffle_shop.simple_revenue_analysis
[0m22:47:26.279495 [debug] [Thread-3 (]: Began running node model.jaffle_shop.revenue_by_month
[0m22:47:26.280536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_customers, now analysis.jaffle_shop.simple_order_analysis)
[0m22:47:26.280536 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now analysis.jaffle_shop.simple_revenue_analysis)
[0m22:47:26.281549 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now model.jaffle_shop.revenue_by_month)
[0m22:47:26.281549 [debug] [Thread-1 (]: Began compiling node analysis.jaffle_shop.simple_order_analysis
[0m22:47:26.282656 [debug] [Thread-4 (]: Began compiling node analysis.jaffle_shop.simple_revenue_analysis
[0m22:47:26.282656 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.revenue_by_month
[0m22:47:26.285664 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.jaffle_shop.simple_order_analysis"
[0m22:47:26.286535 [debug] [Thread-2 (]: Began executing node analysis.jaffle_shop.simple_customer_analysis
[0m22:47:26.290013 [debug] [Thread-4 (]: Writing injected SQL for node "analysis.jaffle_shop.simple_revenue_analysis"
[0m22:47:26.293012 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.revenue_by_month"
[0m22:47:26.294011 [debug] [Thread-2 (]: Finished running node analysis.jaffle_shop.simple_customer_analysis
[0m22:47:26.296015 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.revenue_by_month
[0m22:47:26.296619 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.revenue_by_month
[0m22:47:26.297713 [debug] [Thread-1 (]: Began executing node analysis.jaffle_shop.simple_order_analysis
[0m22:47:26.298635 [debug] [Thread-1 (]: Finished running node analysis.jaffle_shop.simple_order_analysis
[0m22:47:26.299628 [debug] [Thread-4 (]: Began executing node analysis.jaffle_shop.simple_revenue_analysis
[0m22:47:26.300625 [debug] [Thread-4 (]: Finished running node analysis.jaffle_shop.simple_revenue_analysis
[0m22:47:26.301624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:26.302624 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m22:47:26.302624 [debug] [MainThread]: Connection 'analysis.jaffle_shop.simple_order_analysis' was properly closed.
[0m22:47:26.302624 [debug] [MainThread]: Connection 'analysis.jaffle_shop.simple_customer_analysis' was properly closed.
[0m22:47:26.303624 [debug] [MainThread]: Connection 'model.jaffle_shop.revenue_by_month' was properly closed.
[0m22:47:26.303624 [debug] [MainThread]: Connection 'analysis.jaffle_shop.simple_revenue_analysis' was properly closed.
[0m22:47:26.305624 [debug] [MainThread]: Command end result
[0m22:47:26.327693 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m22:47:26.331626 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m22:47:26.339224 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m22:47:26.341318 [debug] [MainThread]: Command `python -m dbt.cli.main compile` succeeded at 22:47:26.341318 after 1.89 seconds
[0m22:47:26.341318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5466D190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5466CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5466D160>]}
[0m22:47:26.342224 [debug] [MainThread]: Flushing usage events
[0m22:47:27.601658 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:47.552972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB847DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB90B2F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB90B2BD0>]}


============================== 22:49:47.552972 | 2139379f-6e3b-4d17-88d4-a82c146c9b66 ==============================
[0m22:49:47.552972 [info ] [MainThread]: Running with dbt=1.9.6
[0m22:49:47.552972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile --select simple_customer_analysis', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:49:47.850934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2139379f-6e3b-4d17-88d4-a82c146c9b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB9C51220>]}
[0m22:49:47.898250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2139379f-6e3b-4d17-88d4-a82c146c9b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB8C82540>]}
[0m22:49:47.898250 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m22:49:48.317789 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m22:49:48.494661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:49:48.494661 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:49:48.541988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2139379f-6e3b-4d17-88d4-a82c146c9b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ABA229BB0>]}
[0m22:49:48.604955 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m22:49:48.620489 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m22:49:48.652476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2139379f-6e3b-4d17-88d4-a82c146c9b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ABA787BC0>]}
[0m22:49:48.652476 [info ] [MainThread]: Found 6 models, 3 seeds, 3 analyses, 428 macros
[0m22:49:48.652476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2139379f-6e3b-4d17-88d4-a82c146c9b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ABA2284A0>]}
[0m22:49:48.652476 [info ] [MainThread]: 
[0m22:49:48.652476 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:49:48.652476 [info ] [MainThread]: 
[0m22:49:48.652476 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:49:48.668102 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m22:49:48.884852 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m22:49:48.884852 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m22:49:48.884852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:48.916113 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m22:49:48.916113 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m22:49:48.916113 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m22:49:48.932240 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m22:49:48.932240 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m22:49:48.932240 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m22:49:48.932240 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m22:49:48.942252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2139379f-6e3b-4d17-88d4-a82c146c9b66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB9D3DA60>]}
[0m22:49:48.947772 [debug] [Thread-1 (]: Began running node analysis.jaffle_shop.simple_customer_analysis
[0m22:49:48.947772 [debug] [Thread-1 (]: Acquiring new duckdb connection 'analysis.jaffle_shop.simple_customer_analysis'
[0m22:49:48.947772 [debug] [Thread-1 (]: Began compiling node analysis.jaffle_shop.simple_customer_analysis
[0m22:49:48.947772 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.jaffle_shop.simple_customer_analysis"
[0m22:49:48.947772 [debug] [Thread-1 (]: Began executing node analysis.jaffle_shop.simple_customer_analysis
[0m22:49:48.963491 [debug] [Thread-1 (]: Finished running node analysis.jaffle_shop.simple_customer_analysis
[0m22:49:48.963491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:48.963491 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m22:49:48.963491 [debug] [MainThread]: Connection 'analysis.jaffle_shop.simple_customer_analysis' was properly closed.
[0m22:49:48.963491 [debug] [MainThread]: Command end result
[0m22:49:48.979505 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m22:49:48.979505 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m22:49:48.995240 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m22:49:48.995240 [info ] [MainThread]: Compiled node 'simple_customer_analysis' is:
-- Simple Customer Analysis
-- Shows customer behavior in easy-to-understand format

select 
    customer_id,
    first_name,
    last_name,
    number_of_orders,
    lifetime_value,
    
    -- Simple customer categories
    case 
        when number_of_orders = 1 then 'One-time Customer'
        when number_of_orders <= 3 then 'Regular Customer'
        else 'Loyal Customer'
    end as customer_type,
    
    -- Simple value categories
    case 
        when lifetime_value < 100 then 'Low Spender'
        when lifetime_value < 300 then 'Medium Spender'
        else 'High Spender'
    end as spending_level
    
from "jaffle_shop"."main"."dim_customers"
where number_of_orders > 0
order by lifetime_value desc
limit 20
[0m22:49:48.995240 [debug] [MainThread]: Command `python -m dbt.cli.main compile` succeeded at 22:49:48.995240 after 1.61 seconds
[0m22:49:48.995240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB8D4AF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ABAAF4A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ABAA88230>]}
[0m22:49:48.995240 [debug] [MainThread]: Flushing usage events
[0m22:49:50.180444 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:51:41.565105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEA3A261E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEA00BC230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEA3E84500>]}


============================== 22:51:41.565105 | 0049030b-76b5-47b4-b100-a5505d1fa347 ==============================
[0m22:51:41.565105 [info ] [MainThread]: Running with dbt=1.9.6
[0m22:51:41.565105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\KBHATIA\\jaffle_shop\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\KBHATIA\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m22:51:41.861029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0049030b-76b5-47b4-b100-a5505d1fa347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEA3F44EF0>]}
[0m22:51:41.924517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0049030b-76b5-47b4-b100-a5505d1fa347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEA37B3E60>]}
[0m22:51:41.924517 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m22:51:42.329087 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m22:51:42.521375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:51:42.521375 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:51:42.564939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0049030b-76b5-47b4-b100-a5505d1fa347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEA494BD70>]}
[0m22:51:42.628700 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m22:51:42.628700 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m22:51:42.660052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0049030b-76b5-47b4-b100-a5505d1fa347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEA4F634A0>]}
[0m22:51:42.660052 [info ] [MainThread]: Found 6 models, 3 seeds, 3 analyses, 428 macros
[0m22:51:42.660052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0049030b-76b5-47b4-b100-a5505d1fa347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEA48C1DC0>]}
[0m22:51:42.660052 [info ] [MainThread]: 
[0m22:51:42.660052 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:51:42.675628 [info ] [MainThread]: 
[0m22:51:42.675628 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:51:42.675628 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_shop_main'
[0m22:51:42.877808 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m22:51:42.877808 [debug] [ThreadPool]: On list_jaffle_shop_main: BEGIN
[0m22:51:42.893430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:51:42.912563 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m22:51:42.912563 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_shop_main"
[0m22:51:42.912563 [debug] [ThreadPool]: On list_jaffle_shop_main: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_jaffle_shop_main"} */
select
      'jaffle_shop' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_shop'
  
[0m22:51:42.925791 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m22:51:42.925791 [debug] [ThreadPool]: On list_jaffle_shop_main: ROLLBACK
[0m22:51:42.925791 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_shop_main'
[0m22:51:42.925791 [debug] [ThreadPool]: On list_jaffle_shop_main: Close
[0m22:51:42.925791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0049030b-76b5-47b4-b100-a5505d1fa347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEA43A0770>]}
[0m22:51:42.941115 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m22:51:42.941115 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m22:51:42.941115 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_customers'
[0m22:51:42.941115 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m22:51:42.941115 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_orders'
[0m22:51:42.941115 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m22:51:42.941115 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.jaffle_shop.raw_payments'
[0m22:51:42.941115 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m22:51:42.956753 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m22:51:42.956753 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m22:51:42.956753 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m22:51:42.956753 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m22:51:42.956753 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m22:51:42.956753 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m22:51:42.956753 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m22:51:42.956753 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_customers
[0m22:51:42.956753 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:51:42.956753 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m22:51:42.956753 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_shop.stg_customers'
[0m22:51:42.956753 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_orders, now model.jaffle_shop.stg_orders)
[0m22:51:42.956753 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_payments, now model.jaffle_shop.stg_payments)
[0m22:51:42.956753 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:51:42.956753 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:51:42.972844 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m22:51:42.972844 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:51:42.972844 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:51:42.972844 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m22:51:42.988530 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:51:42.988530 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m22:51:42.972844 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:51:42.988530 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:51:42.988530 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m22:51:42.988530 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:51:42.988530 [debug] [Thread-4 (]: Began running node model.jaffle_shop.fct_orders
[0m22:51:42.988530 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.fct_orders)
[0m22:51:42.988530 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.fct_orders
[0m22:51:42.988530 [debug] [Thread-2 (]: Began running node model.jaffle_shop.dim_customers
[0m22:51:42.988530 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.fct_orders"
[0m22:51:42.988530 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.dim_customers)
[0m22:51:42.988530 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.dim_customers
[0m22:51:43.004192 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.dim_customers"
[0m22:51:43.004192 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.fct_orders
[0m22:51:43.004192 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.dim_customers
[0m22:51:43.004192 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.fct_orders
[0m22:51:43.004192 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.dim_customers
[0m22:51:43.004192 [debug] [Thread-1 (]: Began running node analysis.jaffle_shop.simple_order_analysis
[0m22:51:43.004192 [debug] [Thread-3 (]: Began running node analysis.jaffle_shop.simple_revenue_analysis
[0m22:51:43.004192 [debug] [Thread-4 (]: Began running node model.jaffle_shop.revenue_by_month
[0m22:51:43.004192 [debug] [Thread-2 (]: Began running node analysis.jaffle_shop.simple_customer_analysis
[0m22:51:43.004192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_customers, now analysis.jaffle_shop.simple_order_analysis)
[0m22:51:43.004192 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now analysis.jaffle_shop.simple_revenue_analysis)
[0m22:51:43.012702 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.fct_orders, now model.jaffle_shop.revenue_by_month)
[0m22:51:43.012702 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.dim_customers, now analysis.jaffle_shop.simple_customer_analysis)
[0m22:51:43.012702 [debug] [Thread-1 (]: Began compiling node analysis.jaffle_shop.simple_order_analysis
[0m22:51:43.012702 [debug] [Thread-3 (]: Began compiling node analysis.jaffle_shop.simple_revenue_analysis
[0m22:51:43.012702 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.revenue_by_month
[0m22:51:43.012702 [debug] [Thread-2 (]: Began compiling node analysis.jaffle_shop.simple_customer_analysis
[0m22:51:43.012702 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.jaffle_shop.simple_order_analysis"
[0m22:51:43.020932 [debug] [Thread-3 (]: Writing injected SQL for node "analysis.jaffle_shop.simple_revenue_analysis"
[0m22:51:43.022469 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.revenue_by_month"
[0m22:51:43.022469 [debug] [Thread-2 (]: Writing injected SQL for node "analysis.jaffle_shop.simple_customer_analysis"
[0m22:51:43.022469 [debug] [Thread-1 (]: Began executing node analysis.jaffle_shop.simple_order_analysis
[0m22:51:43.022469 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.revenue_by_month
[0m22:51:43.022469 [debug] [Thread-2 (]: Began executing node analysis.jaffle_shop.simple_customer_analysis
[0m22:51:43.022469 [debug] [Thread-3 (]: Began executing node analysis.jaffle_shop.simple_revenue_analysis
[0m22:51:43.022469 [debug] [Thread-1 (]: Finished running node analysis.jaffle_shop.simple_order_analysis
[0m22:51:43.022469 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.revenue_by_month
[0m22:51:43.022469 [debug] [Thread-2 (]: Finished running node analysis.jaffle_shop.simple_customer_analysis
[0m22:51:43.022469 [debug] [Thread-3 (]: Finished running node analysis.jaffle_shop.simple_revenue_analysis
[0m22:51:43.035975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:51:43.035975 [debug] [MainThread]: Connection 'list_jaffle_shop_main' was properly closed.
[0m22:51:43.035975 [debug] [MainThread]: Connection 'analysis.jaffle_shop.simple_order_analysis' was properly closed.
[0m22:51:43.035975 [debug] [MainThread]: Connection 'analysis.jaffle_shop.simple_customer_analysis' was properly closed.
[0m22:51:43.035975 [debug] [MainThread]: Connection 'analysis.jaffle_shop.simple_revenue_analysis' was properly closed.
[0m22:51:43.035975 [debug] [MainThread]: Connection 'model.jaffle_shop.revenue_by_month' was properly closed.
[0m22:51:43.035975 [debug] [MainThread]: Command end result
[0m22:51:43.051697 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\KBHATIA\jaffle_shop\target\manifest.json
[0m22:51:43.067314 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\KBHATIA\jaffle_shop\target\semantic_manifest.json
[0m22:51:43.072801 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\KBHATIA\jaffle_shop\target\run_results.json
[0m22:51:43.072801 [debug] [MainThread]: Command `python -m dbt.cli.main compile` succeeded at 22:51:43.072801 after 1.67 seconds
[0m22:51:43.072801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEA52F4BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEA3B05580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEA3BF7FE0>]}
[0m22:51:43.083307 [debug] [MainThread]: Flushing usage events
[0m22:51:44.396606 [debug] [MainThread]: An error was encountered while trying to flush usage events
